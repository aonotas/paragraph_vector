<!DOCTYPE html>
<!-- Generated by Cython 0.21.1 -->
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <style type="text/css">
    
body.cython { font-family: courier; font-size: 12; }

.cython.tag  {  }
.cython.line { margin: 0em }
.cython.code  { font-size: 9; color: #444444; display: none; margin: 0px 0px 0px 20px;  }

.cython.code .py_c_api  { color: red; }
.cython.code .py_macro_api  { color: #FF7000; }
.cython.code .pyx_c_api  { color: #FF3000; }
.cython.code .pyx_macro_api  { color: #FF7000; }
.cython.code .refnanny  { color: #FFA000; }
.cython.code .error_goto  { color: #FFA000; }

.cython.code .coerce  { color: #008000; border: 1px dotted #008000 }
.cython.code .py_attr { color: #FF0000; font-weight: bold; }
.cython.code .c_attr  { color: #0000FF; }
.cython.code .py_call { color: #FF0000; font-weight: bold; }
.cython.code .c_call  { color: #0000FF; }

.cython.score-0 {background-color: #FFFFff;}
.cython.score-1 {background-color: #FFFFe7;}
.cython.score-2 {background-color: #FFFFd4;}
.cython.score-3 {background-color: #FFFFc4;}
.cython.score-4 {background-color: #FFFFb6;}
.cython.score-5 {background-color: #FFFFaa;}
.cython.score-6 {background-color: #FFFF9f;}
.cython.score-7 {background-color: #FFFF96;}
.cython.score-8 {background-color: #FFFF8d;}
.cython.score-9 {background-color: #FFFF86;}
.cython.score-10 {background-color: #FFFF7f;}
.cython.score-11 {background-color: #FFFF79;}
.cython.score-12 {background-color: #FFFF73;}
.cython.score-13 {background-color: #FFFF6e;}
.cython.score-14 {background-color: #FFFF6a;}
.cython.score-15 {background-color: #FFFF66;}
.cython.score-16 {background-color: #FFFF62;}
.cython.score-17 {background-color: #FFFF5e;}
.cython.score-18 {background-color: #FFFF5b;}
.cython.score-19 {background-color: #FFFF57;}
.cython.score-20 {background-color: #FFFF55;}
.cython.score-21 {background-color: #FFFF52;}
.cython.score-22 {background-color: #FFFF4f;}
.cython.score-23 {background-color: #FFFF4d;}
.cython.score-24 {background-color: #FFFF4b;}
.cython.score-25 {background-color: #FFFF48;}
.cython.score-26 {background-color: #FFFF46;}
.cython.score-27 {background-color: #FFFF44;}
.cython.score-28 {background-color: #FFFF43;}
.cython.score-29 {background-color: #FFFF41;}
.cython.score-30 {background-color: #FFFF3f;}
.cython.score-31 {background-color: #FFFF3e;}
.cython.score-32 {background-color: #FFFF3c;}
.cython.score-33 {background-color: #FFFF3b;}
.cython.score-34 {background-color: #FFFF39;}
.cython.score-35 {background-color: #FFFF38;}
.cython.score-36 {background-color: #FFFF37;}
.cython.score-37 {background-color: #FFFF36;}
.cython.score-38 {background-color: #FFFF35;}
.cython.score-39 {background-color: #FFFF34;}
.cython.score-40 {background-color: #FFFF33;}
.cython.score-41 {background-color: #FFFF32;}
.cython.score-42 {background-color: #FFFF31;}
.cython.score-43 {background-color: #FFFF30;}
.cython.score-44 {background-color: #FFFF2f;}
.cython.score-45 {background-color: #FFFF2e;}
.cython.score-46 {background-color: #FFFF2d;}
.cython.score-47 {background-color: #FFFF2c;}
.cython.score-48 {background-color: #FFFF2b;}
.cython.score-49 {background-color: #FFFF2b;}
.cython.score-50 {background-color: #FFFF2a;}
.cython.score-51 {background-color: #FFFF29;}
.cython.score-52 {background-color: #FFFF29;}
.cython.score-53 {background-color: #FFFF28;}
.cython.score-54 {background-color: #FFFF27;}
.cython.score-55 {background-color: #FFFF27;}
.cython.score-56 {background-color: #FFFF26;}
.cython.score-57 {background-color: #FFFF26;}
.cython.score-58 {background-color: #FFFF25;}
.cython.score-59 {background-color: #FFFF24;}
.cython.score-60 {background-color: #FFFF24;}
.cython.score-61 {background-color: #FFFF23;}
.cython.score-62 {background-color: #FFFF23;}
.cython.score-63 {background-color: #FFFF22;}
.cython.score-64 {background-color: #FFFF22;}
.cython.score-65 {background-color: #FFFF22;}
.cython.score-66 {background-color: #FFFF21;}
.cython.score-67 {background-color: #FFFF21;}
.cython.score-68 {background-color: #FFFF20;}
.cython.score-69 {background-color: #FFFF20;}
.cython.score-70 {background-color: #FFFF1f;}
.cython.score-71 {background-color: #FFFF1f;}
.cython.score-72 {background-color: #FFFF1f;}
.cython.score-73 {background-color: #FFFF1e;}
.cython.score-74 {background-color: #FFFF1e;}
.cython.score-75 {background-color: #FFFF1e;}
.cython.score-76 {background-color: #FFFF1d;}
.cython.score-77 {background-color: #FFFF1d;}
.cython.score-78 {background-color: #FFFF1c;}
.cython.score-79 {background-color: #FFFF1c;}
.cython.score-80 {background-color: #FFFF1c;}
.cython.score-81 {background-color: #FFFF1c;}
.cython.score-82 {background-color: #FFFF1b;}
.cython.score-83 {background-color: #FFFF1b;}
.cython.score-84 {background-color: #FFFF1b;}
.cython.score-85 {background-color: #FFFF1a;}
.cython.score-86 {background-color: #FFFF1a;}
.cython.score-87 {background-color: #FFFF1a;}
.cython.score-88 {background-color: #FFFF1a;}
.cython.score-89 {background-color: #FFFF19;}
.cython.score-90 {background-color: #FFFF19;}
.cython.score-91 {background-color: #FFFF19;}
.cython.score-92 {background-color: #FFFF19;}
.cython.score-93 {background-color: #FFFF18;}
.cython.score-94 {background-color: #FFFF18;}
.cython.score-95 {background-color: #FFFF18;}
.cython.score-96 {background-color: #FFFF18;}
.cython.score-97 {background-color: #FFFF17;}
.cython.score-98 {background-color: #FFFF17;}
.cython.score-99 {background-color: #FFFF17;}
.cython.score-100 {background-color: #FFFF17;}
.cython.score-101 {background-color: #FFFF16;}
.cython.score-102 {background-color: #FFFF16;}
.cython.score-103 {background-color: #FFFF16;}
.cython.score-104 {background-color: #FFFF16;}
.cython.score-105 {background-color: #FFFF16;}
.cython.score-106 {background-color: #FFFF15;}
.cython.score-107 {background-color: #FFFF15;}
.cython.score-108 {background-color: #FFFF15;}
.cython.score-109 {background-color: #FFFF15;}
.cython.score-110 {background-color: #FFFF15;}
.cython.score-111 {background-color: #FFFF15;}
.cython.score-112 {background-color: #FFFF14;}
.cython.score-113 {background-color: #FFFF14;}
.cython.score-114 {background-color: #FFFF14;}
.cython.score-115 {background-color: #FFFF14;}
.cython.score-116 {background-color: #FFFF14;}
.cython.score-117 {background-color: #FFFF14;}
.cython.score-118 {background-color: #FFFF13;}
.cython.score-119 {background-color: #FFFF13;}
.cython.score-120 {background-color: #FFFF13;}
.cython.score-121 {background-color: #FFFF13;}
.cython.score-122 {background-color: #FFFF13;}
.cython.score-123 {background-color: #FFFF13;}
.cython.score-124 {background-color: #FFFF13;}
.cython.score-125 {background-color: #FFFF12;}
.cython.score-126 {background-color: #FFFF12;}
.cython.score-127 {background-color: #FFFF12;}
.cython.score-128 {background-color: #FFFF12;}
.cython.score-129 {background-color: #FFFF12;}
.cython.score-130 {background-color: #FFFF12;}
.cython.score-131 {background-color: #FFFF12;}
.cython.score-132 {background-color: #FFFF11;}
.cython.score-133 {background-color: #FFFF11;}
.cython.score-134 {background-color: #FFFF11;}
.cython.score-135 {background-color: #FFFF11;}
.cython.score-136 {background-color: #FFFF11;}
.cython.score-137 {background-color: #FFFF11;}
.cython.score-138 {background-color: #FFFF11;}
.cython.score-139 {background-color: #FFFF11;}
.cython.score-140 {background-color: #FFFF11;}
.cython.score-141 {background-color: #FFFF10;}
.cython.score-142 {background-color: #FFFF10;}
.cython.score-143 {background-color: #FFFF10;}
.cython.score-144 {background-color: #FFFF10;}
.cython.score-145 {background-color: #FFFF10;}
.cython.score-146 {background-color: #FFFF10;}
.cython.score-147 {background-color: #FFFF10;}
.cython.score-148 {background-color: #FFFF10;}
.cython.score-149 {background-color: #FFFF10;}
.cython.score-150 {background-color: #FFFF0f;}
.cython.score-151 {background-color: #FFFF0f;}
.cython.score-152 {background-color: #FFFF0f;}
.cython.score-153 {background-color: #FFFF0f;}
.cython.score-154 {background-color: #FFFF0f;}
.cython.score-155 {background-color: #FFFF0f;}
.cython.score-156 {background-color: #FFFF0f;}
.cython.score-157 {background-color: #FFFF0f;}
.cython.score-158 {background-color: #FFFF0f;}
.cython.score-159 {background-color: #FFFF0f;}
.cython.score-160 {background-color: #FFFF0f;}
.cython.score-161 {background-color: #FFFF0e;}
.cython.score-162 {background-color: #FFFF0e;}
.cython.score-163 {background-color: #FFFF0e;}
.cython.score-164 {background-color: #FFFF0e;}
.cython.score-165 {background-color: #FFFF0e;}
.cython.score-166 {background-color: #FFFF0e;}
.cython.score-167 {background-color: #FFFF0e;}
.cython.score-168 {background-color: #FFFF0e;}
.cython.score-169 {background-color: #FFFF0e;}
.cython.score-170 {background-color: #FFFF0e;}
.cython.score-171 {background-color: #FFFF0e;}
.cython.score-172 {background-color: #FFFF0e;}
.cython.score-173 {background-color: #FFFF0d;}
.cython.score-174 {background-color: #FFFF0d;}
.cython.score-175 {background-color: #FFFF0d;}
.cython.score-176 {background-color: #FFFF0d;}
.cython.score-177 {background-color: #FFFF0d;}
.cython.score-178 {background-color: #FFFF0d;}
.cython.score-179 {background-color: #FFFF0d;}
.cython.score-180 {background-color: #FFFF0d;}
.cython.score-181 {background-color: #FFFF0d;}
.cython.score-182 {background-color: #FFFF0d;}
.cython.score-183 {background-color: #FFFF0d;}
.cython.score-184 {background-color: #FFFF0d;}
.cython.score-185 {background-color: #FFFF0d;}
.cython.score-186 {background-color: #FFFF0d;}
.cython.score-187 {background-color: #FFFF0c;}
.cython.score-188 {background-color: #FFFF0c;}
.cython.score-189 {background-color: #FFFF0c;}
.cython.score-190 {background-color: #FFFF0c;}
.cython.score-191 {background-color: #FFFF0c;}
.cython.score-192 {background-color: #FFFF0c;}
.cython.score-193 {background-color: #FFFF0c;}
.cython.score-194 {background-color: #FFFF0c;}
.cython.score-195 {background-color: #FFFF0c;}
.cython.score-196 {background-color: #FFFF0c;}
.cython.score-197 {background-color: #FFFF0c;}
.cython.score-198 {background-color: #FFFF0c;}
.cython.score-199 {background-color: #FFFF0c;}
.cython.score-200 {background-color: #FFFF0c;}
.cython.score-201 {background-color: #FFFF0c;}
.cython.score-202 {background-color: #FFFF0c;}
.cython.score-203 {background-color: #FFFF0b;}
.cython.score-204 {background-color: #FFFF0b;}
.cython.score-205 {background-color: #FFFF0b;}
.cython.score-206 {background-color: #FFFF0b;}
.cython.score-207 {background-color: #FFFF0b;}
.cython.score-208 {background-color: #FFFF0b;}
.cython.score-209 {background-color: #FFFF0b;}
.cython.score-210 {background-color: #FFFF0b;}
.cython.score-211 {background-color: #FFFF0b;}
.cython.score-212 {background-color: #FFFF0b;}
.cython.score-213 {background-color: #FFFF0b;}
.cython.score-214 {background-color: #FFFF0b;}
.cython.score-215 {background-color: #FFFF0b;}
.cython.score-216 {background-color: #FFFF0b;}
.cython.score-217 {background-color: #FFFF0b;}
.cython.score-218 {background-color: #FFFF0b;}
.cython.score-219 {background-color: #FFFF0b;}
.cython.score-220 {background-color: #FFFF0b;}
.cython.score-221 {background-color: #FFFF0b;}
.cython.score-222 {background-color: #FFFF0a;}
.cython.score-223 {background-color: #FFFF0a;}
.cython.score-224 {background-color: #FFFF0a;}
.cython.score-225 {background-color: #FFFF0a;}
.cython.score-226 {background-color: #FFFF0a;}
.cython.score-227 {background-color: #FFFF0a;}
.cython.score-228 {background-color: #FFFF0a;}
.cython.score-229 {background-color: #FFFF0a;}
.cython.score-230 {background-color: #FFFF0a;}
.cython.score-231 {background-color: #FFFF0a;}
.cython.score-232 {background-color: #FFFF0a;}
.cython.score-233 {background-color: #FFFF0a;}
.cython.score-234 {background-color: #FFFF0a;}
.cython.score-235 {background-color: #FFFF0a;}
.cython.score-236 {background-color: #FFFF0a;}
.cython.score-237 {background-color: #FFFF0a;}
.cython.score-238 {background-color: #FFFF0a;}
.cython.score-239 {background-color: #FFFF0a;}
.cython.score-240 {background-color: #FFFF0a;}
.cython.score-241 {background-color: #FFFF0a;}
.cython.score-242 {background-color: #FFFF0a;}
.cython.score-243 {background-color: #FFFF0a;}
.cython.score-244 {background-color: #FFFF0a;}
.cython.score-245 {background-color: #FFFF0a;}
.cython.score-246 {background-color: #FFFF09;}
.cython.score-247 {background-color: #FFFF09;}
.cython.score-248 {background-color: #FFFF09;}
.cython.score-249 {background-color: #FFFF09;}
.cython.score-250 {background-color: #FFFF09;}
.cython.score-251 {background-color: #FFFF09;}
.cython.score-252 {background-color: #FFFF09;}
.cython.score-253 {background-color: #FFFF09;}
.cython.score-254 {background-color: #FFFF09;}.cython .hll { background-color: #ffffcc }
.cython  { background: #f8f8f8; }
.cython .c { color: #408080; font-style: italic } /* Comment */
.cython .err { border: 1px solid #FF0000 } /* Error */
.cython .k { color: #008000; font-weight: bold } /* Keyword */
.cython .o { color: #666666 } /* Operator */
.cython .cm { color: #408080; font-style: italic } /* Comment.Multiline */
.cython .cp { color: #BC7A00 } /* Comment.Preproc */
.cython .c1 { color: #408080; font-style: italic } /* Comment.Single */
.cython .cs { color: #408080; font-style: italic } /* Comment.Special */
.cython .gd { color: #A00000 } /* Generic.Deleted */
.cython .ge { font-style: italic } /* Generic.Emph */
.cython .gr { color: #FF0000 } /* Generic.Error */
.cython .gh { color: #000080; font-weight: bold } /* Generic.Heading */
.cython .gi { color: #00A000 } /* Generic.Inserted */
.cython .go { color: #888888 } /* Generic.Output */
.cython .gp { color: #000080; font-weight: bold } /* Generic.Prompt */
.cython .gs { font-weight: bold } /* Generic.Strong */
.cython .gu { color: #800080; font-weight: bold } /* Generic.Subheading */
.cython .gt { color: #0044DD } /* Generic.Traceback */
.cython .kc { color: #008000; font-weight: bold } /* Keyword.Constant */
.cython .kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
.cython .kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
.cython .kp { color: #008000 } /* Keyword.Pseudo */
.cython .kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
.cython .kt { color: #B00040 } /* Keyword.Type */
.cython .m { color: #666666 } /* Literal.Number */
.cython .s { color: #BA2121 } /* Literal.String */
.cython .na { color: #7D9029 } /* Name.Attribute */
.cython .nb { color: #008000 } /* Name.Builtin */
.cython .nc { color: #0000FF; font-weight: bold } /* Name.Class */
.cython .no { color: #880000 } /* Name.Constant */
.cython .nd { color: #AA22FF } /* Name.Decorator */
.cython .ni { color: #999999; font-weight: bold } /* Name.Entity */
.cython .ne { color: #D2413A; font-weight: bold } /* Name.Exception */
.cython .nf { color: #0000FF } /* Name.Function */
.cython .nl { color: #A0A000 } /* Name.Label */
.cython .nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
.cython .nt { color: #008000; font-weight: bold } /* Name.Tag */
.cython .nv { color: #19177C } /* Name.Variable */
.cython .ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
.cython .w { color: #bbbbbb } /* Text.Whitespace */
.cython .mb { color: #666666 } /* Literal.Number.Bin */
.cython .mf { color: #666666 } /* Literal.Number.Float */
.cython .mh { color: #666666 } /* Literal.Number.Hex */
.cython .mi { color: #666666 } /* Literal.Number.Integer */
.cython .mo { color: #666666 } /* Literal.Number.Oct */
.cython .sb { color: #BA2121 } /* Literal.String.Backtick */
.cython .sc { color: #BA2121 } /* Literal.String.Char */
.cython .sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
.cython .s2 { color: #BA2121 } /* Literal.String.Double */
.cython .se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
.cython .sh { color: #BA2121 } /* Literal.String.Heredoc */
.cython .si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
.cython .sx { color: #008000 } /* Literal.String.Other */
.cython .sr { color: #BB6688 } /* Literal.String.Regex */
.cython .s1 { color: #BA2121 } /* Literal.String.Single */
.cython .ss { color: #19177C } /* Literal.String.Symbol */
.cython .bp { color: #008000 } /* Name.Builtin.Pseudo */
.cython .vc { color: #19177C } /* Name.Variable.Class */
.cython .vg { color: #19177C } /* Name.Variable.Global */
.cython .vi { color: #19177C } /* Name.Variable.Instance */
.cython .il { color: #666666 } /* Literal.Number.Integer.Long */
    </style>
    <script>
    function toggleDiv(id) {
        theDiv = id.nextElementSibling
        if (theDiv.style.display != 'block') theDiv.style.display = 'block';
        else theDiv.style.display = 'none';
    }
    </script>
</head>
<body class="cython">
<p>Generated by Cython 0.21.1</p>
<p>Raw output: <a href="inner_paragraph_vector.c">inner_paragraph_vector.c</a></p>
<div class="cython"><pre class='cython line score-11' onclick='toggleDiv(this)'>+0001: <span class="c">#!/usr/bin/env python</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='py_c_api'>PyDict_New</span>();<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test, __pyx_t_2) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;0002: <span class="c"># -*- coding: utf-8 -*-</span></pre>
<pre class='cython line score-0'>&#xA0;0003: </pre>
<pre class='cython line score-0'>&#xA0;0004: <span class="c">#!/usr/bin/env cython</span></pre>
<pre class='cython line score-0'>&#xA0;0005: <span class="c"># cython: boundscheck=False</span></pre>
<pre class='cython line score-0'>&#xA0;0006: <span class="c"># cython: wraparound=False</span></pre>
<pre class='cython line score-0'>&#xA0;0007: <span class="c"># cython: cdivision=True</span></pre>
<pre class='cython line score-0'>&#xA0;0008: <span class="c"># coding: utf-8</span></pre>
<pre class='cython line score-0'>&#xA0;0009: <span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;0010: <span class="c"># Copyright (C) 2013 Radim Rehurek &lt;me@radimrehurek.com&gt;</span></pre>
<pre class='cython line score-0'>&#xA0;0011: <span class="c"># Licensed under the GNU LGPL v2.1 - http://www.gnu.org/licenses/lgpl.html</span></pre>
<pre class='cython line score-0'>&#xA0;0012: </pre>
<pre class='cython line score-0'>&#xA0;0013: <span class="k">import</span> <span class="nn">cython</span></pre>
<pre class='cython line score-8' onclick='toggleDiv(this)'>+0014: <span class="k">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython code score-8'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_numpy, 0, -1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_np, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 14; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0015: <span class="k">cimport</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span></pre>
<pre class='cython line score-0'>&#xA0;0016: </pre>
<pre class='cython line score-0'>&#xA0;0017: <span class="k">from</span> <span class="nn">libc.math</span> <span class="k">cimport</span> <span class="n">exp</span></pre>
<pre class='cython line score-0'>&#xA0;0018: <span class="k">from</span> <span class="nn">libc.string</span> <span class="k">cimport</span> <span class="n">memset</span></pre>
<pre class='cython line score-0'>&#xA0;0019: </pre>
<pre class='cython line score-0'>&#xA0;0020: <span class="k">cdef</span> <span class="kr">extern</span> <span class="k">from</span> <span class="s">&quot;voidptr.h&quot;</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0021:     <span class="n">void</span><span class="o">*</span> <span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="nb">object</span> <span class="n">obj</span><span class="p">)</span></pre>
<pre class='cython line score-0'>&#xA0;0022: </pre>
<pre class='cython line score-19' onclick='toggleDiv(this)'>+0023: <span class="k">from</span> <span class="nn">scipy.linalg.blas</span> <span class="k">import</span> <span class="n">fblas</span></pre>
<pre class='cython code score-19'>  __pyx_t_1 = <span class='py_c_api'>PyList_New</span>(1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_n_s_fblas);
  <span class='py_macro_api'>PyList_SET_ITEM</span>(__pyx_t_1, 0, __pyx_n_s_fblas);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_n_s_fblas);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_Import</span>(__pyx_n_s_scipy_linalg_blas, __pyx_t_1, -1);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_ImportFrom</span>(__pyx_t_2, __pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_fblas, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 23; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-0'>&#xA0;0024: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+0025: <span class="n">REAL</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span></pre>
<pre class='cython code score-11'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_float32);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_REAL, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 25; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0026: <span class="k">ctypedef</span> <span class="n">np</span><span class="o">.</span><span class="n">float32_t</span> <span class="n">REAL_t</span></pre>
<pre class='cython line score-0'>&#xA0;0027: </pre>
<pre class='cython line score-0'>&#xA0;0028: <span class="cp">DEF</span> <span class="n">MAX_SENTENCE_LEN</span> <span class="o">=</span> <span class="mf">10000</span></pre>
<pre class='cython line score-0'>&#xA0;0029: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0030: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">scopy_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">,</span> <span class="nb">float</span> <span class="o">*</span><span class="n">Y</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incY</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_scopy_ptr)(int const *, float const *, int const *, float *, int const *);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0031: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">saxpy_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">alpha</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">,</span> <span class="nb">float</span> <span class="o">*</span><span class="n">Y</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incY</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_saxpy_ptr)(int const *, float const *, float const *, int const *, float *, int const *);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0032: <span class="k">ctypedef</span> <span class="nb">float</span> <span class="p">(</span><span class="o">*</span><span class="n">sdot_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">Y</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incY</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef float (*__pyx_t_22inner_paragraph_vector_sdot_ptr)(int const *, float const *, int const *, float const *, int const *);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0033: <span class="k">ctypedef</span> <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">dsdot_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">Y</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incY</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef double (*__pyx_t_22inner_paragraph_vector_dsdot_ptr)(int const *, float const *, int const *, float const *, int const *);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0034: <span class="k">ctypedef</span> <span class="n">double</span> <span class="p">(</span><span class="o">*</span><span class="n">snrm2_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef double (*__pyx_t_22inner_paragraph_vector_snrm2_ptr)(int const *, float const *, int const *);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0035: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">sscal_ptr</span><span class="p">)</span> <span class="p">(</span><span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">N</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">alpha</span><span class="p">,</span> <span class="n">const</span> <span class="nb">float</span> <span class="o">*</span><span class="n">X</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="o">*</span><span class="n">incX</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_sscal_ptr)(int const *, float const *, float const *, int const *);
</pre><pre class='cython line score-0'>&#xA0;0036: </pre>
<pre class='cython line score-0'>&#xA0;0037: </pre>
<pre class='cython line score-0'>&#xA0;0038: </pre>
<pre class='cython line score-0'>&#xA0;0039: <span class="sd">&#39;&#39;&#39; sg simple&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0040: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_sg_hs_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_sg_hs_ptr)(__pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int const , __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const , __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *);
</pre><pre class='cython line score-0'>&#xA0;0041:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0042:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0043:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0044: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_sg_neg_simple_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef unsigned PY_LONG_LONG (*__pyx_t_22inner_paragraph_vector_fast_sentence_sg_neg_simple_ptr)(long const , int const , __pyx_t_5numpy_uint32_t *, unsigned PY_LONG_LONG, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const , __pyx_t_5numpy_uint32_t const , __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, unsigned PY_LONG_LONG);
</pre><pre class='cython line score-0'>&#xA0;0045:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0046:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0047:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0048:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0049: </pre>
<pre class='cython line score-0'>&#xA0;0050: </pre>
<pre class='cython line score-0'>&#xA0;0051: <span class="sd">&#39;&#39;&#39; cbow average&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0052: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_average_simple_hs_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_average_simple_hs_ptr)(long const , __pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, int);
</pre><pre class='cython line score-0'>&#xA0;0053:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0054:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0055:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0056:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0057: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_average_simple_neg_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef unsigned PY_LONG_LONG (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_average_simple_neg_ptr)(long const , int const , __pyx_t_5numpy_uint32_t *, unsigned PY_LONG_LONG, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, unsigned PY_LONG_LONG, int);
</pre><pre class='cython line score-0'>&#xA0;0058:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0059:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0060:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0061:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0062: </pre>
<pre class='cython line score-0'>&#xA0;0063: </pre>
<pre class='cython line score-0'>&#xA0;0064: <span class="sd">&#39;&#39;&#39; cbow average plus doc&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0065: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_average_plus_doc_hs_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_hs_ptr)(long const , __pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int);
</pre><pre class='cython line score-0'>&#xA0;0066:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0067:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0068:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0069:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0070: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_average_plus_doc_neg_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef unsigned PY_LONG_LONG (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_neg_ptr)(long const , int const , __pyx_t_5numpy_uint32_t *, unsigned PY_LONG_LONG, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, unsigned PY_LONG_LONG);
</pre><pre class='cython line score-0'>&#xA0;0071:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0072:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0073:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0074:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0075: </pre>
<pre class='cython line score-0'>&#xA0;0076: <span class="sd">&#39;&#39;&#39; cbow concat&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0077: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_hs_concat_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_hs_concat_ptr)(long const , __pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , int const , __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, int);
</pre><pre class='cython line score-0'>&#xA0;0078:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0079:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0080:     <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0081:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span> <span class="c">#change</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0082: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_neg_concat_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef unsigned PY_LONG_LONG (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_neg_concat_ptr)(long const , int const , __pyx_t_5numpy_uint32_t *, unsigned PY_LONG_LONG, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , int const , __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , int const , int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, unsigned PY_LONG_LONG, int);
</pre><pre class='cython line score-0'>&#xA0;0083:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0084:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0085:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0086:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0087:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span><span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span> <span class="c">#change</span></pre>
<pre class='cython line score-0'>&#xA0;0088: </pre>
<pre class='cython line score-0'>&#xA0;0089: </pre>
<pre class='cython line score-0'>&#xA0;0090: </pre>
<pre class='cython line score-0'>&#xA0;0091: <span class="sd">&#39;&#39;&#39; cbow&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0092: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_hs_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_hs_ptr)(__pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int);
</pre><pre class='cython line score-0'>&#xA0;0093:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0094:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0095:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0096:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0097: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_cbow_neg_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef unsigned PY_LONG_LONG (*__pyx_t_22inner_paragraph_vector_fast_sentence_cbow_neg_ptr)(int const , __pyx_t_5numpy_uint32_t *, unsigned PY_LONG_LONG, int *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const *, __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *, int, int, int, int, unsigned PY_LONG_LONG);
</pre><pre class='cython line score-0'>&#xA0;0098:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0099:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0100:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0101:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0102: </pre>
<pre class='cython line score-0'>&#xA0;0103: </pre>
<pre class='cython line score-0'>&#xA0;0104: <span class="sd">&#39;&#39;&#39; sg&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0105: <span class="k">ctypedef</span> <span class="n">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_sg_hs_simple_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython code score-0'>typedef void (*__pyx_t_22inner_paragraph_vector_fast_sentence_sg_hs_simple_ptr)(long const , __pyx_t_5numpy_uint32_t const *, __pyx_t_5numpy_uint8_t const *, int const , __pyx_t_22inner_paragraph_vector_REAL_t *, __pyx_t_22inner_paragraph_vector_REAL_t *, int const , __pyx_t_5numpy_uint32_t const , __pyx_t_22inner_paragraph_vector_REAL_t const , __pyx_t_22inner_paragraph_vector_REAL_t *);
</pre><pre class='cython line score-0'>&#xA0;0106:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0107:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0108:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span> <span class="c">#modify!</span></pre>
<pre class='cython line score-0'>&#xA0;0109: </pre>
<pre class='cython line score-0'>&#xA0;0110: <span class="k">ctypedef</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="p">(</span><span class="o">*</span><span class="n">fast_sentence_sg_neg_ptr</span><span class="p">)</span> <span class="p">(</span></pre>
<pre class='cython line score-0'>&#xA0;0111:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0112:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0113:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0114:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span></pre>
<pre class='cython line score-0'>&#xA0;0115: </pre>
<pre class='cython line score-0'>&#xA0;0116: </pre>
<pre class='cython line score-0'>&#xA0;0117: </pre>
<pre class='cython line score-0'>&#xA0;0118: </pre>
<pre class='cython line score-9' onclick='toggleDiv(this)'>+0119: <span class="k">cdef</span> <span class="kt">scopy_ptr</span> <span class="nf">scopy</span><span class="o">=&lt;</span><span class="n">scopy_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">scopy</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span>  <span class="c"># y = x</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_scopy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 119; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_scopy = ((__pyx_t_22inner_paragraph_vector_scopy_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+0120: <span class="k">cdef</span> <span class="kt">saxpy_ptr</span> <span class="nf">saxpy</span><span class="o">=&lt;</span><span class="n">saxpy_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">saxpy</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span>  <span class="c"># y += alpha * x</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_saxpy);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_saxpy = ((__pyx_t_22inner_paragraph_vector_saxpy_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+0121: <span class="k">cdef</span> <span class="kt">sdot_ptr</span> <span class="nf">sdot</span><span class="o">=&lt;</span><span class="n">sdot_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">sdot</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span>  <span class="c"># float = dot(x, y)</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sdot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_sdot = ((__pyx_t_22inner_paragraph_vector_sdot_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+0122: <span class="k">cdef</span> <span class="kt">dsdot_ptr</span> <span class="nf">dsdot</span><span class="o">=&lt;</span><span class="n">dsdot_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">sdot</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span>  <span class="c"># double = dot(x, y)</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sdot);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_dsdot = ((__pyx_t_22inner_paragraph_vector_dsdot_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+0123: <span class="k">cdef</span> <span class="kt">snrm2_ptr</span> <span class="nf">snrm2</span><span class="o">=&lt;</span><span class="n">snrm2_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">snrm2</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span>  <span class="c"># sqrt(x^2)</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_snrm2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 123; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_snrm2 = ((__pyx_t_22inner_paragraph_vector_snrm2_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-9' onclick='toggleDiv(this)'>+0124: <span class="k">cdef</span> <span class="kt">sscal_ptr</span> <span class="nf">sscal</span><span class="o">=&lt;</span><span class="n">sscal_ptr</span><span class="o">&gt;</span><span class="n">PyCObject_AsVoidPtr</span><span class="p">(</span><span class="n">fblas</span><span class="o">.</span><span class="n">sscal</span><span class="o">.</span><span class="n">_cpointer</span><span class="p">)</span> <span class="c"># x = alpha * x</span></pre>
<pre class='cython code score-9'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_fblas);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_sscal);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_2, __pyx_n_s_cpointer);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  __pyx_v_22inner_paragraph_vector_sscal = ((__pyx_t_22inner_paragraph_vector_sscal_ptr)PyCObject_AsVoidPtr(__pyx_t_1));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0125: </pre>
<pre class='cython line score-0'>&#xA0;0126: <span class="sd">&#39;&#39;&#39; cbow average&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0127: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_average_simple_hs_ptr</span> <span class="nf">fast_sentence_cbow_average_simple_hs</span></pre>
<pre class='cython line score-0'>&#xA0;0128: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_average_simple_neg_ptr</span> <span class="nf">fast_sentence_cbow_average_simple_neg</span></pre>
<pre class='cython line score-0'>&#xA0;0129: </pre>
<pre class='cython line score-0'>&#xA0;0130: <span class="sd">&#39;&#39;&#39; cbow average plus doc&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0131: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_average_plus_doc_hs_ptr</span> <span class="nf">fast_sentence_cbow_average_plus_doc_hs</span></pre>
<pre class='cython line score-0'>&#xA0;0132: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_average_plus_doc_neg_ptr</span> <span class="nf">fast_sentence_cbow_average_plus_doc_neg</span></pre>
<pre class='cython line score-0'>&#xA0;0133: </pre>
<pre class='cython line score-0'>&#xA0;0134: <span class="sd">&#39;&#39;&#39; cbow concat&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0135: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_hs_concat_ptr</span> <span class="nf">fast_sentence_cbow_hs_concat</span></pre>
<pre class='cython line score-0'>&#xA0;0136: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_neg_concat_ptr</span> <span class="nf">fast_sentence_cbow_neg_concat</span></pre>
<pre class='cython line score-0'>&#xA0;0137: </pre>
<pre class='cython line score-0'>&#xA0;0138: <span class="sd">&#39;&#39;&#39; sg simple&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0139: <span class="k">cdef</span> <span class="kt">fast_sentence_sg_hs_simple_ptr</span> <span class="nf">fast_sentence_sg_hs_simple</span></pre>
<pre class='cython line score-0'>&#xA0;0140: <span class="k">cdef</span> <span class="kt">fast_sentence_sg_neg_simple_ptr</span> <span class="nf">fast_sentence_sg_neg_simple</span></pre>
<pre class='cython line score-0'>&#xA0;0141: </pre>
<pre class='cython line score-0'>&#xA0;0142: <span class="sd">&#39;&#39;&#39; cbow&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0143: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_hs_ptr</span> <span class="nf">fast_sentence_cbow_hs</span></pre>
<pre class='cython line score-0'>&#xA0;0144: <span class="k">cdef</span> <span class="kt">fast_sentence_cbow_neg_ptr</span> <span class="nf">fast_sentence_cbow_neg</span></pre>
<pre class='cython line score-0'>&#xA0;0145: </pre>
<pre class='cython line score-0'>&#xA0;0146: <span class="sd">&#39;&#39;&#39; sg&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0'>&#xA0;0147: <span class="k">cdef</span> <span class="kt">fast_sentence_sg_hs_ptr</span> <span class="nf">fast_sentence_sg_hs</span></pre>
<pre class='cython line score-0'>&#xA0;0148: <span class="k">cdef</span> <span class="kt">fast_sentence_sg_neg_ptr</span> <span class="nf">fast_sentence_sg_neg</span></pre>
<pre class='cython line score-0'>&#xA0;0149: </pre>
<pre class='cython line score-0'>&#xA0;0150: </pre>
<pre class='cython line score-0'>&#xA0;0151: <span class="cp">DEF</span> <span class="n">EXP_TABLE_SIZE</span> <span class="o">=</span> <span class="mf">10000</span></pre>
<pre class='cython line score-0'>&#xA0;0152: <span class="cp">DEF</span> <span class="n">MAX_EXP</span> <span class="o">=</span> <span class="mf">12</span></pre>
<pre class='cython line score-0'>&#xA0;0153: </pre>
<pre class='cython line score-0'>&#xA0;0154: <span class="k">cdef</span> <span class="kt">REAL_t</span>[<span class="kt">EXP_TABLE_SIZE</span>] <span class="nf">EXP_TABLE</span></pre>
<pre class='cython line score-0'>&#xA0;0155: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0156: <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">ONE</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_ONE = 1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0157: <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">ONEF</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">1.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_ONEF = ((__pyx_t_22inner_paragraph_vector_REAL_t)1.0);
</pre><pre class='cython line score-0'>&#xA0;0158: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0159: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_sg_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0160:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0161:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0162:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0163: </pre>
<pre class='cython line score-0'>&#xA0;0164:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0165:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;0166:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span></pre>
<pre class='cython line score-0'>&#xA0;0167: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0168:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0169:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0170:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0171:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0172:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0173:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0174:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0175:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0176:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0177:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0178:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0179: </pre>
<pre class='cython line score-0'>&#xA0;0180: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0181: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_sg_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0182:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0183:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0184:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0185: </pre>
<pre class='cython line score-0'>&#xA0;0186:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0187:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;0188:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span></pre>
<pre class='cython line score-0'>&#xA0;0189: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0190:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0191:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0192:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0193:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0194:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0195:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0196:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0197:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0198:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0199:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0200:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0201: </pre>
<pre class='cython line score-0'>&#xA0;0202: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0203: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence2_sg_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence2_sg_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work) {
  PY_LONG_LONG __pyx_v_a;
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0204:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0205:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0206:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0207: </pre>
<pre class='cython line score-0'>&#xA0;0208:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0209:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;0210:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span></pre>
<pre class='cython line score-0'>&#xA0;0211: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0212:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0213:         <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_work[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0214:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0215:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0216:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0217:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_a = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0218:             <span class="n">f</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_f = (__pyx_v_f + ((__pyx_v_syn0[(__pyx_v_row1 + __pyx_v_a)]) * (__pyx_v_syn1[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0219:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_5 = __pyx_t_6;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_5 = __pyx_t_6;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_5) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0220:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L5_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0221:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0222:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0223:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_a = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0224:             <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_a;
      (__pyx_v_work[__pyx_t_7]) = ((__pyx_v_work[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_syn1[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0225:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
      __pyx_v_a = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0226:             <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = (__pyx_v_row2 + __pyx_v_a);
      (__pyx_v_syn1[__pyx_t_7]) = ((__pyx_v_syn1[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_syn0[(__pyx_v_row1 + __pyx_v_a)])));
    }
    __pyx_L5_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0227:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0228:         <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = (__pyx_v_row1 + __pyx_v_a);
    (__pyx_v_syn0[__pyx_t_4]) = ((__pyx_v_syn0[__pyx_t_4]) + (__pyx_v_work[__pyx_v_a]));
  }
</pre><pre class='cython line score-0'>&#xA0;0229: </pre>
<pre class='cython line score-0'>&#xA0;0230: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0231: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_sg_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0232:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0233:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0234:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0235:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0236: </pre>
<pre class='cython line score-0'>&#xA0;0237:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0238:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0239:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0240:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0241:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;0242:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;0243: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0244:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;0245: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0246:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0247:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0248:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0249:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0250:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0251:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0252:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0253:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0254:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0255:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;0256: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0257:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0258:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0259:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0260:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0261:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0262:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0263:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0264:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0265: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0266:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0267: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0268:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0269: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0270: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_sg_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0271:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0272:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0273:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0274:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0275: </pre>
<pre class='cython line score-0'>&#xA0;0276:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0277:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0278:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0279:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0280:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;0281:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;0282: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0283:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;0284: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0285:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0286: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0287:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0288:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0289:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0290:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0291:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0292:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0293:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0294:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0295:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;0296: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0297:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0298:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0299:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0300:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0301:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0302:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0303:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0304:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0305: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0306:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0307: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0308:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0309: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0310: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence2_sg_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence2_sg_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_a;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0311:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0312:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0313:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0314:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0315: </pre>
<pre class='cython line score-0'>&#xA0;0316:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0317:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0318:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0319:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0320:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;0321:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;0322: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0323:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0324:         <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_work[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0'>&#xA0;0325: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0326:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_3; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0'>&#xA0;0327: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0328:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0329:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0330:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0331:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0332:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0333:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0334:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_4 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0335:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L5_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0336:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L7:;
</pre><pre class='cython line score-0'>&#xA0;0337: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0338:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0339:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0340:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_5; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0341:             <span class="n">f</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_f = (__pyx_v_f + ((__pyx_v_syn0[(__pyx_v_row1 + __pyx_v_a)]) * (__pyx_v_syn1neg[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0342:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_6) {
    } else {
      __pyx_t_4 = __pyx_t_6;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_6 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_4 = __pyx_t_6;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0343:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L5_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0344:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0345:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0346:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_5; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0347:             <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_a;
      (__pyx_v_work[__pyx_t_7]) = ((__pyx_v_work[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_syn1neg[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0348:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_5; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0349:             <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = (__pyx_v_row2 + __pyx_v_a);
      (__pyx_v_syn1neg[__pyx_t_7]) = ((__pyx_v_syn1neg[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_syn0[(__pyx_v_row1 + __pyx_v_a)])));
    }
    __pyx_L5_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0350: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0351:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0352:         <span class="n">syn0</span><span class="p">[</span><span class="n">row1</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_t_7 = (__pyx_v_row1 + __pyx_v_a);
    (__pyx_v_syn0[__pyx_t_7]) = ((__pyx_v_syn0[__pyx_t_7]) + (__pyx_v_work[__pyx_v_a]));
  }
</pre><pre class='cython line score-0'>&#xA0;0353: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0354:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0355: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0356: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_cbow_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0357:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0358:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0359:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0360:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0361: </pre>
<pre class='cython line score-0'>&#xA0;0362:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;0363:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;0364:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;0365:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0366: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0367:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0368:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0369:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0370:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0371:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0372:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0373:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0374:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0375:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0376:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0377:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;0378: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0379:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0380:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0381:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0382:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0383:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0384:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0385:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0386:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0387:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0388:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0389: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0390:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0391:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0392:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L16_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0393:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0394:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0395: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0396: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_cbow_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0397:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0398:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0399:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0400:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0401: </pre>
<pre class='cython line score-0'>&#xA0;0402:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;0403:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;0404:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;0405:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0406: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0407:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0408:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0409:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0410:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0411:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0412:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0413:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0414:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0415:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0416:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0417:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;0418: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0419:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0420:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0421:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0422:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0423:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0424:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0425:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0426:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0427:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0428:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0429: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0430:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0431:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0432:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L16_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0433:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0434:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0435: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0436: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence2_cbow_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence2_cbow_hs(__pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean) {
  PY_LONG_LONG __pyx_v_a;
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  int __pyx_v_m;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0437:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0438:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0439:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0440:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0441: </pre>
<pre class='cython line score-0'>&#xA0;0442:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;0443:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;0444:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span></pre>
<pre class='cython line score-0'>&#xA0;0445:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0446: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0447:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0448:         <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_neu1[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0449:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0450:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_3 = __pyx_v_j; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_m = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0451:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0452:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L5_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0453:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0454:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0455:             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_6 = __pyx_v_size;
      for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_6; __pyx_t_2+=1) {
        __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0456:                 <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_a;
        (__pyx_v_neu1[__pyx_t_7]) = ((__pyx_v_neu1[__pyx_t_7]) + (__pyx_v_syn0[(((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size) + __pyx_v_a)]));
      }
    }
    __pyx_L5_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0457:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_5 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_4 = __pyx_t_5;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0458:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_1 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0459:             <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">/=</span> <span class="n">count</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_a;
      (__pyx_v_neu1[__pyx_t_7]) = ((__pyx_v_neu1[__pyx_t_7]) / __pyx_v_count);
    }
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;0460: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0461:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0462:         <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_work[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0463:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0464:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0465:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0466:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_3; __pyx_t_7+=1) {
      __pyx_v_a = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0467:             <span class="n">f</span> <span class="o">+=</span> <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_f = (__pyx_v_f + ((__pyx_v_neu1[__pyx_v_a]) * (__pyx_v_syn1[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0468:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L24_bool_binop_done;
    }
    __pyx_t_5 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L24_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0469:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L19_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0470:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0471:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0472:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_3; __pyx_t_7+=1) {
      __pyx_v_a = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0473:             <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_8 = __pyx_v_a;
      (__pyx_v_work[__pyx_t_8]) = ((__pyx_v_work[__pyx_t_8]) + (__pyx_v_g * (__pyx_v_syn1[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0474:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_7 = 0; __pyx_t_7 &lt; __pyx_t_3; __pyx_t_7+=1) {
      __pyx_v_a = __pyx_t_7;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0475:             <span class="n">syn1</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_8 = (__pyx_v_row2 + __pyx_v_a);
      (__pyx_v_syn1[__pyx_t_8]) = ((__pyx_v_syn1[__pyx_t_8]) + (__pyx_v_g * (__pyx_v_neu1[__pyx_v_a])));
    }
    __pyx_L19_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0476: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0477:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_3 = __pyx_v_j; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_m = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0478:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L33_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L33_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0479:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L30_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0480:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0481:             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_6 = __pyx_v_size;
      for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_6; __pyx_t_2+=1) {
        __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0482:                 <span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = (((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size) + __pyx_v_a);
        (__pyx_v_syn0[__pyx_t_7]) = ((__pyx_v_syn0[__pyx_t_7]) + (__pyx_v_work[__pyx_v_a]));
      }
    }
    __pyx_L30_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0483: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0484: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_cbow_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0485:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0486:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0487:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0488:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0489: </pre>
<pre class='cython line score-0'>&#xA0;0490:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;0491:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0492:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0493:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0494:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;0495:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0496: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0497:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;0498: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0499:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0500:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0501:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0502:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0503:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0504:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0505:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0506:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0507:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0508:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0509:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;0510: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0511:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;0512: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0513:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0514:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0515:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0516:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0517:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0518:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0519:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0520:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0521:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L11_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0522:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;0523: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0524:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0525:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0526:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0527:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0528:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0529:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0530:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0531:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0532: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0533:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0534:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0535:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0536:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0537:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0538: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0539:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0540: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0541: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_cbow_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0542:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0543:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0544:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0545:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0546: </pre>
<pre class='cython line score-0'>&#xA0;0547:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;0548:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0549:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0550:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0551:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;0552:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0553: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0554:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;0555: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0556:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0557:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0558:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0559:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0560:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0561:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0562:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0563:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0564:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0565:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0566:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;0567: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0568:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;0569: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0570:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0571:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0572:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0573:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0574:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0575:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0576:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0577:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0578:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L11_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0579:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;0580: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0581:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0582:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0583:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0584:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0585:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0586:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0587:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0588:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0589: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0590:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0591:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0592:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0593:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0594:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0595: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0596:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0597: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0598: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence2_cbow_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence2_cbow_neg(int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_a;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0599:     <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;0600:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0601:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0602:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0603: </pre>
<pre class='cython line score-0'>&#xA0;0604:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;0605:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0606:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0607:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;0608:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;0609:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;0610: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0611:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;0612: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0613:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0614:         <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_neu1[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0615:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0616:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_3 = __pyx_v_j; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_m = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0617:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0618:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L5_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0619:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0620:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0621:             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_6 = __pyx_v_size;
      for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_6; __pyx_t_2+=1) {
        __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0622:                 <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = __pyx_v_a;
        (__pyx_v_neu1[__pyx_t_7]) = ((__pyx_v_neu1[__pyx_t_7]) + (__pyx_v_syn0[(((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size) + __pyx_v_a)]));
      }
    }
    __pyx_L5_continue:;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0623:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_5) {
  } else {
    __pyx_t_4 = __pyx_t_5;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_5 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_4 = __pyx_t_5;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0624:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_1 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0625:             <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">/=</span> <span class="n">count</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_a;
      (__pyx_v_neu1[__pyx_t_7]) = ((__pyx_v_neu1[__pyx_t_7]) / __pyx_v_count);
    }
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;0626: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0627:     <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_size;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0628:         <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    (__pyx_v_work[__pyx_v_a]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
  }
</pre><pre class='cython line score-0'>&#xA0;0629: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0630:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_8 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_8; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0631:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0632:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0633:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L21;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0634:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0635:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0636:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0637:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_4 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0638:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L19_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0639:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L21:;
</pre><pre class='cython line score-0'>&#xA0;0640: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0641:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0642:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0643:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0644:             <span class="n">f</span> <span class="o">+=</span> <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_f = (__pyx_v_f + ((__pyx_v_neu1[__pyx_v_a]) * (__pyx_v_syn1neg[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0645:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L26_bool_binop_done;
    }
    __pyx_t_5 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L26_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0646:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L19_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0647:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0648:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0649:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0650:             <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = __pyx_v_a;
      (__pyx_v_work[__pyx_t_7]) = ((__pyx_v_work[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_syn1neg[(__pyx_v_row2 + __pyx_v_a)])));
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0651:         <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = __pyx_v_size;
    for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_3; __pyx_t_2+=1) {
      __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0652:             <span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">g</span> <span class="o">*</span> <span class="n">neu1</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_t_7 = (__pyx_v_row2 + __pyx_v_a);
      (__pyx_v_syn1neg[__pyx_t_7]) = ((__pyx_v_syn1neg[__pyx_t_7]) + (__pyx_v_g * (__pyx_v_neu1[__pyx_v_a])));
    }
    __pyx_L19_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0653: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0654:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_3 = __pyx_v_j; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_m = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0655:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L35_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L35_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0656:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L32_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0657:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0658:             <span class="k">for</span> <span class="n">a</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span></pre>
<pre class='cython code score-0'>      __pyx_t_6 = __pyx_v_size;
      for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_6; __pyx_t_2+=1) {
        __pyx_v_a = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0659:                 <span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span> <span class="o">+</span> <span class="n">a</span><span class="p">]</span> <span class="o">+=</span> <span class="n">work</span><span class="p">[</span><span class="n">a</span><span class="p">]</span></pre>
<pre class='cython code score-0'>        __pyx_t_7 = (((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size) + __pyx_v_a);
        (__pyx_v_syn0[__pyx_t_7]) = ((__pyx_v_syn0[__pyx_t_7]) + (__pyx_v_work[__pyx_v_a]));
      }
    }
    __pyx_L32_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0660: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0661:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0662: </pre>
<pre class='cython line score-0'>&#xA0;0663: </pre>
<pre class='cython line score-0'>&#xA0;0664: <span class="sd">&#39;&#39;&#39; normal skip&#39;&#39;&#39;</span></pre>
<pre class='cython line score-69' onclick='toggleDiv(this)'>+0665: <span class="k">def</span> <span class="nf">train_sentence_sg</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">):</span></pre>
<pre class='cython code score-69'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_1train_sentence_sg(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_1train_sentence_sg = {"train_sentence_sg", (PyCFunction)__pyx_pw_22inner_paragraph_vector_1train_sentence_sg, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_1train_sentence_sg(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,0};
    PyObject* values[4] = {0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg", 1, 4, 4, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg", 1, 4, 4, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg", 1, 4, 4, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_sg") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 4) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence = values[1];
    __pyx_v_alpha = values[2];
    __pyx_v__work = values[3];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg", 1, 4, 4, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_train_sentence_sg(__pyx_self, __pyx_v_model, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_train_sentence_sg(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  int __pyx_v_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_reduced_windows[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__23 = <span class='py_c_api'>PyTuple_Pack</span>(27, __pyx_n_s_model, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_syn0, __pyx_n_s_work_2, __pyx_n_s_alpha_2, __pyx_n_s_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_reduced_windows, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__23)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__23);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__23);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_1train_sentence_sg, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_sg, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__24 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(4, 0, 27, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__23, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_sg, 665, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__24)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 665; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0666:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 666; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0667:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 667; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 667; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0668: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+0669:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 669; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0670:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0671:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 671; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0672:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 672; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 672; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0673: </pre>
<pre class='cython line score-0'>&#xA0;0674:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0675:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0676:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">reduced_windows</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0677:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0678:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 678; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0679: </pre>
<pre class='cython line score-0'>&#xA0;0680:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0681:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-0'>&#xA0;0682: </pre>
<pre class='cython line score-0'>&#xA0;0683:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;0684:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;0685:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0686:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0687: </pre>
<pre class='cython line score-0'>&#xA0;0688:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;0689:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;0690:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;0691:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;0692:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;0693: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0694:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_hs != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0695:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 695; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;0696: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0697:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_negative != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0698:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 698; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0699:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 699; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0700:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 700; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_table_len = __pyx_t_5;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+0701:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple_, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/*  */
  __pyx_tuple_ = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple_)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple_);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple_);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__2, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_8 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_next_random = __pyx_t_8;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__2 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 701; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__2);
</pre><pre class='cython line score-0'>&#xA0;0702: </pre>
<pre class='cython line score-0'>&#xA0;0703:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0704:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 704; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0705:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 705; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = 10000;
  if (((__pyx_t_5 &lt; __pyx_t_9) != 0)) {
    __pyx_t_10 = __pyx_t_5;
  } else {
    __pyx_t_10 = __pyx_t_9;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;0706: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0707:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+0708:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 708; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0709:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_4 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0710:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0711:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0712:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 712; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-35' onclick='toggleDiv(this)'>+0713:             <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">window</span><span class="p">)</span></pre>
<pre class='cython code score-35'>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_14) {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 713; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      (__pyx_v_reduced_windows[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0714:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0715:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 715; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0716:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 716; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_6)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0717:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 717; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_6)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0718:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0719:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0720:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;0721: </pre>
<pre class='cython line score-0'>&#xA0;0722:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0723:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0724:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0725:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0726:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0727:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = ((__pyx_v_i - __pyx_v_window) + (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0728:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0729:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0730:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = (((__pyx_v_i + __pyx_v_window) + 1) - (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0731:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0732:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0733:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_16 = __pyx_v_k;
          for (__pyx_t_17 = __pyx_v_j; __pyx_t_17 &lt; __pyx_t_16; __pyx_t_17+=1) {
            __pyx_v_j = __pyx_t_17;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0734:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_4 = ((__pyx_v_j == __pyx_v_i) != 0);
            if (!__pyx_t_4) {
            } else {
              __pyx_t_12 = __pyx_t_4;
              goto __pyx_L20_bool_binop_done;
            }
            __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_j]) == 0) != 0);
            __pyx_t_12 = __pyx_t_4;
            __pyx_L20_bool_binop_done:;
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0735:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L17_continue;
            }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0736:                 <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_hs != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0737:                     <span class="n">fast_sentence_sg_hs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs((__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), (__pyx_v_codelens[__pyx_v_i]), __pyx_v_syn0, __pyx_v_syn1, __pyx_v_size, (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work);
              goto __pyx_L22;
            }
            __pyx_L22:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0738:                 <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_negative != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0739:                     <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_sg_neg</span><span class="p">(</span><span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">next_random</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg(__pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_size, (__pyx_v_indexes[__pyx_v_i]), (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_next_random);
              goto __pyx_L23;
            }
            __pyx_L23:;
            __pyx_L17_continue:;
          }
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;0740: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0741:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0742: </pre>
<pre class='cython line score-0'>&#xA0;0743: <span class="sd">&#39;&#39;&#39; normal cbow&#39;&#39;&#39;</span></pre>
<pre class='cython line score-78' onclick='toggleDiv(this)'>+0744: <span class="k">def</span> <span class="nf">train_sentence_cbow</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">):</span></pre>
<pre class='cython code score-78'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_3train_sentence_cbow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_3train_sentence_cbow = {"train_sentence_cbow", (PyCFunction)__pyx_pw_22inner_paragraph_vector_3train_sentence_cbow, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_3train_sentence_cbow(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,0};
    PyObject* values[5] = {0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow", 1, 5, 5, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow", 1, 5, 5, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow", 1, 5, 5, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow", 1, 5, 5, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_cbow") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 5) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence = values[1];
    __pyx_v_alpha = values[2];
    __pyx_v__work = values[3];
    __pyx_v__neu1 = values[4];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow", 1, 5, 5, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_2train_sentence_cbow(__pyx_self, __pyx_v_model, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_2train_sentence_cbow(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  int __pyx_v_cbow_mean;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  int __pyx_v_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_reduced_windows[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_6);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_7);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__25 = <span class='py_c_api'>PyTuple_Pack</span>(30, __pyx_n_s_model, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_cbow_mean, __pyx_n_s_syn0, __pyx_n_s_work_2, __pyx_n_s_neu1_2, __pyx_n_s_alpha_2, __pyx_n_s_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_reduced_windows, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__25)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__25);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__25);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_3train_sentence_cbow, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_cbow, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__26 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(5, 0, 30, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__25, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_cbow, 744, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__26)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 744; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0745:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 745; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0746:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 746; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0747:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 747; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0748: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+0749:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 749; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0750:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-0'>&#xA0;0751:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">neu1</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0752:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 752; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0753:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 753; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0754: </pre>
<pre class='cython line score-0'>&#xA0;0755:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0756:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0757:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">reduced_windows</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0758:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0759:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 759; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0760: </pre>
<pre class='cython line score-0'>&#xA0;0761:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0762:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-0'>&#xA0;0763: </pre>
<pre class='cython line score-0'>&#xA0;0764:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;0765:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;0766:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0767:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0768: </pre>
<pre class='cython line score-0'>&#xA0;0769:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;0770:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;0771:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;0772:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;0773:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;0774: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0775:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_hs != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0776:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 776; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;0777: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0778:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_negative != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0779:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 779; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0780:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 780; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0781:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 781; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_table_len = __pyx_t_5;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+0782:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__3, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_6);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_6, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
/*  */
  __pyx_tuple__3 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__3)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__3);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__3);
    __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_6, __pyx_tuple__4, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_t_6 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_1, __pyx_t_7);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_8 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
    __pyx_v_next_random = __pyx_t_8;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__4 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 782; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__4);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__4);
</pre><pre class='cython line score-0'>&#xA0;0783: </pre>
<pre class='cython line score-0'>&#xA0;0784:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0785:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 785; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+0786:     <span class="n">neu1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 786; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_neu1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0787:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_5 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_5 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 787; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_9 = 10000;
  if (((__pyx_t_5 &lt; __pyx_t_9) != 0)) {
    __pyx_t_10 = __pyx_t_5;
  } else {
    __pyx_t_10 = __pyx_t_9;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;0788: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0789:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+0790:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_6 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_6 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 790; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_6);
    __pyx_t_6 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0791:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_4 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0792:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0793:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0794:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 794; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-35' onclick='toggleDiv(this)'>+0795:             <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">window</span><span class="p">)</span></pre>
<pre class='cython code score-35'>      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_7, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_7 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_7);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_14 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_7))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_7);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_7);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_7, function);
        }
      }
      if (!__pyx_t_14) {
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_7, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_1);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
        __pyx_t_1 = 0;
        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_7, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_7); __pyx_t_7 = 0;
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_6);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 795; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
      (__pyx_v_reduced_windows[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0796:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0797:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_6);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 797; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0798:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 798; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_6)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0799:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
        if (!(likely(((__pyx_t_6) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_6, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 799; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_6)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_6); __pyx_t_6 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0800:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0801:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0802:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;0803: </pre>
<pre class='cython line score-0'>&#xA0;0804:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0805:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0806:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0807:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0808:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0809:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = ((__pyx_v_i - __pyx_v_window) + (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0810:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0811:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0812:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = (((__pyx_v_i + __pyx_v_window) + 1) - (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0813:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0814:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0815:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_hs != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0816:                 <span class="n">fast_sentence_cbow_hs</span><span class="p">(</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs((__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), __pyx_v_codelens, __pyx_v_neu1, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean);
            goto __pyx_L17;
          }
          __pyx_L17:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0817:             <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_negative != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0818:                 <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_cbow_neg</span><span class="p">(</span><span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">next_random</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg(__pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_codelens, __pyx_v_neu1, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_next_random);
            goto __pyx_L18;
          }
          __pyx_L18:;
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;0819: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0820:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_6 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 820; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_6);
  __pyx_r = __pyx_t_6;
  __pyx_t_6 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0821: </pre>
<pre class='cython line score-0'>&#xA0;0822: </pre>
<pre class='cython line score-0'>&#xA0;0823: </pre>
<pre class='cython line score-0'>&#xA0;0824: </pre>
<pre class='cython line score-0'>&#xA0;0825: <span class="c"># doc_vecword_vec</span></pre>
<pre class='cython line score-0'>&#xA0;0826: <span class="sd">&#39;&#39;&#39; concat skip &#39;&#39;&#39;</span></pre>
<pre class='cython line score-94' onclick='toggleDiv(this)'>+0827: <span class="k">def</span> <span class="nf">train_sentence_sg_concat</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-94'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_5train_sentence_sg_concat(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_5train_sentence_sg_concat = {"train_sentence_sg_concat", (PyCFunction)__pyx_pw_22inner_paragraph_vector_5train_sentence_sg_concat, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_5train_sentence_sg_concat(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_concat (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_sg_concat") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v__neu1 = values[5];
    __pyx_v_alpha_doc = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_concat", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_concat", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_4train_sentence_sg_concat(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_4train_sentence_sg_concat(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  CYTHON_UNUSED int __pyx_v_l1_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_window_r;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  long __pyx_v__sentence_id;
  int __pyx_v_cbow_mean;
  int __pyx_v_average_flag;
  int __pyx_v_flag_freeze_learning;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_concat", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_concat", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__27 = <span class='py_c_api'>PyTuple_Pack</span>(39, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_l1, __pyx_n_s_work_2, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_l1_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_window_r, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_sentence_id_2, __pyx_n_s_cbow_mean, __pyx_n_s_average_flag, __pyx_n_s_flag_freeze_learning, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__27)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__27);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__27);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_5train_sentence_sg_concat, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_sg_concat, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__28 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 39, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__27, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_sg_concat, 827, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__28)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 827; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0828:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 828; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0829:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 829; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0830: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+0831:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span> <span class="c"># simple</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 831; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0832:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 832; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;0833: </pre>
<pre class='cython line score-0'>&#xA0;0834:     <span class="c"># init l1</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0835:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">l1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 835; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_l1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-0'>&#xA0;0836: </pre>
<pre class='cython line score-0'>&#xA0;0837:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0838:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 838; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0839:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 839; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0840:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 840; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0841:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 841; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0842:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;0843: </pre>
<pre class='cython line score-0'>&#xA0;0844:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0845:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0846:     <span class="c"># cdef np.uint32_t reduced_windows[MAX_SENTENCE_LEN]</span></pre>
<pre class='cython line score-0'>&#xA0;0847:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0848:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 848; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0849:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window_r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window_r</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window_r);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 849; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window_r = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0850: </pre>
<pre class='cython line score-0'>&#xA0;0851:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0852:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+0853:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 853; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;0854: </pre>
<pre class='cython line score-0'>&#xA0;0855: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0856:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 856; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0857:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">average_flag</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">average_flag</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_average_flag);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 857; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_average_flag = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0858: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+0859:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">flag_freeze_learning</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">freeze_learn</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_freeze_learn);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 859; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_flag_freeze_learning = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;0860: </pre>
<pre class='cython line score-0'>&#xA0;0861:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;0862:         <span class="c"># print &quot;sentence_id : &quot;,sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;0863:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-0'>&#xA0;0864:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;0865:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;0866:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0867:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;0868: </pre>
<pre class='cython line score-0'>&#xA0;0869:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;0870:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;0871:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;0872:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;0873:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;0874: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0875:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0876:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 876; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;0877: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0878:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0879:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 879; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 879; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0880:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 880; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0881:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 881; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+0882:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__5, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__5 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__5)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__5);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__5);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__6, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__6 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__6)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 882; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__6);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__6);
</pre><pre class='cython line score-0'>&#xA0;0883: </pre>
<pre class='cython line score-0'>&#xA0;0884:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0885:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 885; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+0886:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 886; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;0887: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0888:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+0889:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 889; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0890:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0891:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0892:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0893:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 893; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;0894:             <span class="c"># reduced_windows[i] = np.random.randint(window)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0895:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+0896:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 896; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 896; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0897:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 897; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+0898:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 898; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;0899:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0900:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0901:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;0902: </pre>
<pre class='cython line score-0'>&#xA0;0903:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0904:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0905:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0906:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0907:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;0908:             <span class="c"># j = i - window + reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0909:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = (__pyx_v_i - __pyx_v_window);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0910:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0911:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;0912:             <span class="c"># k = i + window_r + 1 - reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0913:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span> <span class="o">+</span> <span class="mf">1</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = ((__pyx_v_i + __pyx_v_window_r) + 1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0914:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0915:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0916:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_14 = __pyx_v_k;
          for (__pyx_t_15 = __pyx_v_j; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_j = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0917:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_6 = ((__pyx_v_j == __pyx_v_i) != 0);
            if (!__pyx_t_6) {
            } else {
              __pyx_t_12 = __pyx_t_6;
              goto __pyx_L20_bool_binop_done;
            }
            __pyx_t_6 = (((__pyx_v_codelens[__pyx_v_j]) == 0) != 0);
            __pyx_t_12 = __pyx_t_6;
            __pyx_L20_bool_binop_done:;
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0918:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L17_continue;
            }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0919:                 <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_hs != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0920:                     <span class="n">fast_sentence1_sg_hs_concat</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">doc</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">cbow_mean</span><span class="p">,</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_concat(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), (__pyx_v_codelens[__pyx_v_i]), __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_size, __pyx_v_doc_size, (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_l1, __pyx_v_cbow_mean, __pyx_v_average_flag, __pyx_v_flag_freeze_learning);
              goto __pyx_L22;
            }
            __pyx_L22:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0921:                 <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_negative != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0922:                     <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_neg_concat</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span> <span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span><span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">next_random</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">cbow_mean</span><span class="p">,</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_next_random = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_concat(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_size, __pyx_v_doc_size, (__pyx_v_indexes[__pyx_v_i]), (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_next_random, __pyx_v_l1, __pyx_v_cbow_mean, __pyx_v_average_flag, __pyx_v_flag_freeze_learning);
              goto __pyx_L23;
            }
            __pyx_L23:;
            __pyx_L17_continue:;
          }
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;0923: </pre>
<pre class='cython line score-0'>&#xA0;0924: </pre>
<pre class='cython line score-0'>&#xA0;0925:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;0926:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+0927:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 927; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;0928: </pre>
<pre class='cython line score-0'>&#xA0;0929: </pre>
<pre class='cython line score-0'>&#xA0;0930: <span class="sd">&#39;&#39;&#39; concat skip hs&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0931: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_sg_hs_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_concat(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, CYTHON_UNUSED int const __pyx_v_cbow_mean, CYTHON_UNUSED int const __pyx_v_average_flag, int const __pyx_v_flag_freeze_learning) {
  PY_LONG_LONG __pyx_v_b;
  int __pyx_v_l1_size;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  long __pyx_v_exp_index;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;0932:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0933:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0934:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0935: </pre>
<pre class='cython line score-0'>&#xA0;0936:     <span class="c"># print sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;0937:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0938:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0939:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;0940:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;0941:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;0942: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0943:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0944:     <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;0945: </pre>
<pre class='cython line score-0'>&#xA0;0946: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0947:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0948:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0949: </pre>
<pre class='cython line score-0'>&#xA0;0950:     <span class="c"># saxpy(&amp;size, &amp;ONEF, &amp;syn0[row1], &amp;ONE, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;0951:     <span class="c"># # doc add</span></pre>
<pre class='cython line score-0'>&#xA0;0952:     <span class="c"># saxpy(&amp;doc_size, &amp;ONEF, &amp;doc[sentence_id], &amp;ONE, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;0953: </pre>
<pre class='cython line score-0'>&#xA0;0954:     <span class="c"># if cbow_mean == 1 and average_flag == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;0955:     <span class="c">#     inv_count = ONEF+ONEF</span></pre>
<pre class='cython line score-0'>&#xA0;0956:     <span class="c">#     sscal(&amp;size, &amp;inv_count, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;0957: </pre>
<pre class='cython line score-0'>&#xA0;0958: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0959:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0960:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;0961:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0962:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0963:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0964:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0965:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0966:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0967:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0968:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0969:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0970:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0971:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;0972: </pre>
<pre class='cython line score-0'>&#xA0;0973: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0974:     <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = ((__pyx_v_flag_freeze_learning == 0) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0975:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;0976: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0977:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;0978: </pre>
<pre class='cython line score-0'>&#xA0;0979: </pre>
<pre class='cython line score-0'>&#xA0;0980: </pre>
<pre class='cython line score-0'>&#xA0;0981: </pre>
<pre class='cython line score-0'>&#xA0;0982: <span class="sd">&#39;&#39;&#39; concat skip negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0983: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_sg_neg_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_concat(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, CYTHON_UNUSED int const __pyx_v_cbow_mean, CYTHON_UNUSED int const __pyx_v_average_flag, int const __pyx_v_flag_freeze_learning) {
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  int __pyx_v_l1_size;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;0984:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0985:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0986:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;0987:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;0988: </pre>
<pre class='cython line score-0'>&#xA0;0989:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0990:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0991:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;0992:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span><span class="p">,</span><span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;0993:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;0994:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;0995: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0996:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;0997: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+0998:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+0999:     <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1000: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1001:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1002:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1003: </pre>
<pre class='cython line score-0'>&#xA0;1004: </pre>
<pre class='cython line score-0'>&#xA0;1005:     <span class="c"># saxpy(&amp;size, &amp;ONEF, &amp;syn0[row1], &amp;ONE, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;1006:     <span class="c"># # doc add</span></pre>
<pre class='cython line score-0'>&#xA0;1007:     <span class="c"># saxpy(&amp;doc_size, &amp;ONEF, &amp;doc[sentence_id], &amp;ONE, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;1008: </pre>
<pre class='cython line score-0'>&#xA0;1009:     <span class="c"># if cbow_mean == 1 and average_flag == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1010:     <span class="c">#     inv_count = ONEF+ONEF</span></pre>
<pre class='cython line score-0'>&#xA0;1011:     <span class="c">#     sscal(&amp;size, &amp;inv_count, l1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;1012: </pre>
<pre class='cython line score-0'>&#xA0;1013: </pre>
<pre class='cython line score-0'>&#xA0;1014: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1015:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1016: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1017:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1018:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1019:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1020:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1021:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1022:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1023:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1024:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1025:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;1026: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1027:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1028:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1029:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1030:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1031:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1032:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1033:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1034:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1035:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1036: </pre>
<pre class='cython line score-0'>&#xA0;1037: </pre>
<pre class='cython line score-0'>&#xA0;1038: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1039:     <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = ((__pyx_v_flag_freeze_learning == 0) != 0);
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1040:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L10;
  }
  __pyx_L10:;
</pre><pre class='cython line score-0'>&#xA0;1041: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1042:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1043: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1044:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1045: </pre>
<pre class='cython line score-0'>&#xA0;1046: </pre>
<pre class='cython line score-0'>&#xA0;1047: </pre>
<pre class='cython line score-0'>&#xA0;1048: </pre>
<pre class='cython line score-0'>&#xA0;1049: <span class="c"># doc_vecword_vec</span></pre>
<pre class='cython line score-0'>&#xA0;1050: <span class="sd">&#39;&#39;&#39; average skip &#39;&#39;&#39;</span></pre>
<pre class='cython line score-94' onclick='toggleDiv(this)'>+1051: <span class="k">def</span> <span class="nf">train_sentence_sg_average</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-94'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_7train_sentence_sg_average(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_7train_sentence_sg_average = {"train_sentence_sg_average", (PyCFunction)__pyx_pw_22inner_paragraph_vector_7train_sentence_sg_average, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_7train_sentence_sg_average(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_average (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_sg_average") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v__neu1 = values[5];
    __pyx_v_alpha_doc = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_average", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_6train_sentence_sg_average(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_6train_sentence_sg_average(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  CYTHON_UNUSED int __pyx_v_l1_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_window_r;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  long __pyx_v__sentence_id;
  int __pyx_v_cbow_mean;
  int __pyx_v_average_flag;
  int __pyx_v_flag_freeze_learning;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_average", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_average", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__29 = <span class='py_c_api'>PyTuple_Pack</span>(39, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_l1, __pyx_n_s_work_2, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_l1_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_window_r, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_sentence_id_2, __pyx_n_s_cbow_mean, __pyx_n_s_average_flag, __pyx_n_s_flag_freeze_learning, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__29)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__29);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__29);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_7train_sentence_sg_average, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_sg_average, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__30 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 39, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__29, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_sg_average, 1051, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__30)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1051; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1052:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1052; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1052; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1053:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1053; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1053; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1054: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+1055:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span> <span class="c"># simple</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1055; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1056:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1056; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1056; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1057: </pre>
<pre class='cython line score-0'>&#xA0;1058:     <span class="c"># init l1</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1059:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">l1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1059; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_l1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-0'>&#xA0;1060: </pre>
<pre class='cython line score-0'>&#xA0;1061:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1062:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1062; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1063:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1063; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1064:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1064; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1065:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1065; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1066:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = __pyx_v_size;
</pre><pre class='cython line score-0'>&#xA0;1067: </pre>
<pre class='cython line score-0'>&#xA0;1068:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1069:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1070:     <span class="c"># cdef np.uint32_t reduced_windows[MAX_SENTENCE_LEN]</span></pre>
<pre class='cython line score-0'>&#xA0;1071:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1072:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1072; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1073:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window_r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window_r</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window_r);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1073; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window_r = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1074: </pre>
<pre class='cython line score-0'>&#xA0;1075:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1076:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1077:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1077; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;1078: </pre>
<pre class='cython line score-0'>&#xA0;1079: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1080:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1080; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1081:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">average_flag</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">average_flag</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_average_flag);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1081; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_average_flag = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1082: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1083:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">flag_freeze_learning</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">freeze_learn</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_freeze_learn);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1083; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_flag_freeze_learning = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1084: </pre>
<pre class='cython line score-0'>&#xA0;1085:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;1086:         <span class="c"># print &quot;sentence_id : &quot;,sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1087:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-0'>&#xA0;1088:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;1089:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;1090:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1091:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1092: </pre>
<pre class='cython line score-0'>&#xA0;1093:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;1094:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;1095:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;1096:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;1097:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;1098: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1099:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1100:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1100; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1101: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1102:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1103:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1104:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1105:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1105; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+1106:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__7, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__7 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__7)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__7);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__7);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__8, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__8 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1106; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__8);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__8);
</pre><pre class='cython line score-0'>&#xA0;1107: </pre>
<pre class='cython line score-0'>&#xA0;1108:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1109:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1109; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1110:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1110; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;1111: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1112:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+1113:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1114:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1115:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1116:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1117:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1117; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;1118:             <span class="c"># reduced_windows[i] = np.random.randint(window)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1119:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1120:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1120; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1121:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1122:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1123:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1124:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1125:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;1126: </pre>
<pre class='cython line score-0'>&#xA0;1127:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1128:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1129:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1130:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1131:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;1132:             <span class="c"># j = i - window + reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1133:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = (__pyx_v_i - __pyx_v_window);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1134:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1135:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;1136:             <span class="c"># k = i + window_r + 1 - reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1137:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span> <span class="o">+</span> <span class="mf">1</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = ((__pyx_v_i + __pyx_v_window_r) + 1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1138:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1139:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1140:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_14 = __pyx_v_k;
          for (__pyx_t_15 = __pyx_v_j; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_j = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1141:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_6 = ((__pyx_v_j == __pyx_v_i) != 0);
            if (!__pyx_t_6) {
            } else {
              __pyx_t_12 = __pyx_t_6;
              goto __pyx_L20_bool_binop_done;
            }
            __pyx_t_6 = (((__pyx_v_codelens[__pyx_v_j]) == 0) != 0);
            __pyx_t_12 = __pyx_t_6;
            __pyx_L20_bool_binop_done:;
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1142:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L17_continue;
            }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1143:                 <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_hs != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1144:                     <span class="n">fast_sentence1_sg_hs_average</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">doc</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">cbow_mean</span><span class="p">,</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_average(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), (__pyx_v_codelens[__pyx_v_i]), __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_size, __pyx_v_doc_size, (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_l1, __pyx_v_cbow_mean, __pyx_v_average_flag, __pyx_v_flag_freeze_learning);
              goto __pyx_L22;
            }
            __pyx_L22:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1145:                 <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_negative != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1146:                     <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_neg_average</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span> <span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span><span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">next_random</span><span class="p">,</span><span class="n">l1</span><span class="p">,</span><span class="n">cbow_mean</span><span class="p">,</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_next_random = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_average(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_size, __pyx_v_doc_size, (__pyx_v_indexes[__pyx_v_i]), (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_next_random, __pyx_v_l1, __pyx_v_cbow_mean, __pyx_v_average_flag, __pyx_v_flag_freeze_learning);
              goto __pyx_L23;
            }
            __pyx_L23:;
            __pyx_L17_continue:;
          }
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;1147: </pre>
<pre class='cython line score-0'>&#xA0;1148: </pre>
<pre class='cython line score-0'>&#xA0;1149:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;1150:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1151:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1152: </pre>
<pre class='cython line score-0'>&#xA0;1153: </pre>
<pre class='cython line score-0'>&#xA0;1154: </pre>
<pre class='cython line score-0'>&#xA0;1155: <span class="sd">&#39;&#39;&#39; average skip hs&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1156: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_sg_hs_average</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_average(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, int const __pyx_v_cbow_mean, int const __pyx_v_average_flag, int const __pyx_v_flag_freeze_learning) {
  PY_LONG_LONG __pyx_v_b;
  int __pyx_v_l1_size;
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  long __pyx_v_exp_index;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;1157:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1158:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1159:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1160: </pre>
<pre class='cython line score-0'>&#xA0;1161:     <span class="c"># print sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1162:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1163:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = __pyx_v_size;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1164:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1165:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;1166:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1167: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1168:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1169:     <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1170: </pre>
<pre class='cython line score-0'>&#xA0;1171: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1172:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1173:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1174:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1175: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1176:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1177:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">+</span><span class="n">ONEF</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1178:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1179: </pre>
<pre class='cython line score-0'>&#xA0;1180: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1181:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = __pyx_v_codelen;
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_b = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1182:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1183:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1184:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1185:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1186:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L6_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1187:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1188:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1189:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L6_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1190:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1191:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1192:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1193:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L6_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1194: </pre>
<pre class='cython line score-0'>&#xA0;1195: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1196:     <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_flag_freeze_learning == 0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1197:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L14;
  }
  __pyx_L14:;
</pre><pre class='cython line score-0'>&#xA0;1198: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1199:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1200: </pre>
<pre class='cython line score-0'>&#xA0;1201: </pre>
<pre class='cython line score-0'>&#xA0;1202: </pre>
<pre class='cython line score-0'>&#xA0;1203: </pre>
<pre class='cython line score-0'>&#xA0;1204: <span class="sd">&#39;&#39;&#39; average skip negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1205: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_sg_neg_average</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_average(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, int const __pyx_v_cbow_mean, int const __pyx_v_average_flag, int const __pyx_v_flag_freeze_learning) {
  PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  int __pyx_v_l1_size;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;1206:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1207:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1208:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1209:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1210: </pre>
<pre class='cython line score-0'>&#xA0;1211:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1212:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1213:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;1214:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span><span class="p">,</span><span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;1215:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;1216:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;1217: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1218:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = __pyx_v_size;
</pre><pre class='cython line score-0'>&#xA0;1219: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1220:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1221:     <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1222: </pre>
<pre class='cython line score-0'>&#xA0;1223: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1224:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1225:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1226:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1227: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1228:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_2) {
  } else {
    __pyx_t_1 = __pyx_t_2;
    goto __pyx_L4_bool_binop_done;
  }
  __pyx_t_2 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_1 = __pyx_t_2;
  __pyx_L4_bool_binop_done:;
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1229:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">+</span><span class="n">ONEF</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1230:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1231: </pre>
<pre class='cython line score-0'>&#xA0;1232: </pre>
<pre class='cython line score-0'>&#xA0;1233: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1234:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (__pyx_v_negative + 1);
  for (__pyx_t_4 = 0; __pyx_t_4 &lt; __pyx_t_3; __pyx_t_4+=1) {
    __pyx_v_d = __pyx_t_4;
</pre><pre class='cython line score-0'>&#xA0;1235: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1236:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_1 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1237:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1238:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L8;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1239:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1240:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1241:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1242:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_1 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1243:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L6_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1244:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;1245: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1246:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1247:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1248:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1249:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_2 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_2) {
    } else {
      __pyx_t_1 = __pyx_t_2;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_2 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_1 = __pyx_t_2;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1250:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L6_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1251:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1252:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1253:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1254:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L6_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1255: </pre>
<pre class='cython line score-0'>&#xA0;1256: </pre>
<pre class='cython line score-0'>&#xA0;1257: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1258:     <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = ((__pyx_v_flag_freeze_learning == 0) != 0);
  if (__pyx_t_1) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1259:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">row1</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[__pyx_v_row1])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L13;
  }
  __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;1260: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1261:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1262: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1263:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1264: </pre>
<pre class='cython line score-0'>&#xA0;1265: </pre>
<pre class='cython line score-0'>&#xA0;1266: <span class="sd">&#39;&#39;&#39; simple skip &#39;&#39;&#39;</span></pre>
<pre class='cython line score-85' onclick='toggleDiv(this)'>+1267: <span class="k">def</span> <span class="nf">train_sentence_sg_simple</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-85'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_9train_sentence_sg_simple(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_9train_sentence_sg_simple = {"train_sentence_sg_simple", (PyCFunction)__pyx_pw_22inner_paragraph_vector_9train_sentence_sg_simple, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_9train_sentence_sg_simple(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_simple (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[6] = {0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_sg_simple") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 6) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v_alpha_doc = values[5];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_sg_simple", 1, 6, 6, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_8train_sentence_sg_simple(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_8train_sentence_sg_simple(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_window_r;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  long __pyx_v__sentence_id;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_sg_simple", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_sg_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__31 = <span class='py_c_api'>PyTuple_Pack</span>(33, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_work_2, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_window_r, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_sentence_id_2, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__31)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__31);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__31);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_9train_sentence_sg_simple, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_sg_simple, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__32 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(6, 0, 33, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__31, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_sg_simple, 1267, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__32)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1267; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1268:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1268; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1269:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1269; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1270: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+1271:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span> <span class="c"># simple</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1271; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1272:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1272; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1273: </pre>
<pre class='cython line score-0'>&#xA0;1274:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1275:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1275; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1276:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1276; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1277:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1277; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1278:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1278; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1279: </pre>
<pre class='cython line score-0'>&#xA0;1280:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1281:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1282:     <span class="c"># cdef np.uint32_t reduced_windows[MAX_SENTENCE_LEN]</span></pre>
<pre class='cython line score-0'>&#xA0;1283:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1284:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1284; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1285:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window_r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window_r</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window_r);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1285; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window_r = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1286: </pre>
<pre class='cython line score-0'>&#xA0;1287:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1288:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1289:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1289; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;1290: </pre>
<pre class='cython line score-0'>&#xA0;1291:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;1292:         <span class="c"># print &quot;sentence_id : &quot;,sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1293:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-0'>&#xA0;1294:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;1295:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;1296:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1297:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1298: </pre>
<pre class='cython line score-0'>&#xA0;1299:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;1300:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;1301:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;1302:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;1303:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;1304: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1305:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1306:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1306; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1307: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1308:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1309:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1309; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1310:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1310; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1311:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1311; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+1312:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__9, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__9 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__9)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__9);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__9);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__10, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__10 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__10)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1312; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__10);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__10);
</pre><pre class='cython line score-0'>&#xA0;1313: </pre>
<pre class='cython line score-0'>&#xA0;1314:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1315:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1315; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1316:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1316; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;1317: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1318:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+1319:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1319; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1320:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1321:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1322:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1323:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1323; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;1324:             <span class="c"># reduced_windows[i] = np.random.randint(window)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1325:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1326:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1326; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1327:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1327; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1328:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1328; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1329:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1330:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1331:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;1332: </pre>
<pre class='cython line score-0'>&#xA0;1333:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1334:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1335:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1336:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1337:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;1338:             <span class="c"># j = i - window + reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1339:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = (__pyx_v_i - __pyx_v_window);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1340:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1341:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;1342:             <span class="c"># k = i + window_r + 1 - reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1343:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span> <span class="o">+</span> <span class="mf">1</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = ((__pyx_v_i + __pyx_v_window_r) + 1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1344:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1345:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1346:             <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_14 = __pyx_v_k;
          for (__pyx_t_15 = __pyx_v_j; __pyx_t_15 &lt; __pyx_t_14; __pyx_t_15+=1) {
            __pyx_v_j = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1347:                 <span class="k">if</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_6 = ((__pyx_v_j == __pyx_v_i) != 0);
            if (!__pyx_t_6) {
            } else {
              __pyx_t_12 = __pyx_t_6;
              goto __pyx_L20_bool_binop_done;
            }
            __pyx_t_6 = (((__pyx_v_codelens[__pyx_v_j]) == 0) != 0);
            __pyx_t_12 = __pyx_t_6;
            __pyx_L20_bool_binop_done:;
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1348:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L17_continue;
            }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1349:                 <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_hs != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1350:                     <span class="n">fast_sentence_sg_hs_simple</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">doc</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs_simple(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), (__pyx_v_codelens[__pyx_v_i]), __pyx_v_doc, __pyx_v_syn1, __pyx_v_size, (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work);
              goto __pyx_L22;
            }
            __pyx_L22:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1351:                 <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = (__pyx_v_negative != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1352:                     <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_sg_neg_simple</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span> <span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">indexes</span><span class="p">[</span><span class="n">j</span><span class="p">],</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">next_random</span><span class="p">)</span></pre>
<pre class='cython code score-0'>              __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg_simple(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_doc, __pyx_v_syn1neg, __pyx_v_size, (__pyx_v_indexes[__pyx_v_i]), (__pyx_v_indexes[__pyx_v_j]), __pyx_v__alpha, __pyx_v_work, __pyx_v_next_random);
              goto __pyx_L23;
            }
            __pyx_L23:;
            __pyx_L17_continue:;
          }
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;1353: </pre>
<pre class='cython line score-0'>&#xA0;1354: </pre>
<pre class='cython line score-0'>&#xA0;1355:     <span class="c"># if sentence_id in [0,2,149066]:</span></pre>
<pre class='cython line score-0'>&#xA0;1356:         <span class="c"># print &quot;inner af : &quot;,doc[_sentence_id]</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1357:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1357; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1358: </pre>
<pre class='cython line score-0'>&#xA0;1359: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1360: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_sg_hs_simple</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_hs_simple(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work) {
  PY_LONG_LONG __pyx_v_b;
  CYTHON_UNUSED PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  long __pyx_v_exp_index;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;1361:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1362:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1363:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1364: </pre>
<pre class='cython line score-0'>&#xA0;1365:     <span class="c"># print sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1366:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1367:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1368:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span></pre>
<pre class='cython line score-0'>&#xA0;1369:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1370: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1371:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1372:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1373:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1374:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1375:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1376:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1377:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1378:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1379:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1380:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1381:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1382:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1383:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1384:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1385: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1386:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1387: </pre>
<pre class='cython line score-0'>&#xA0;1388: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1389: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_sg_hs_simple</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_simple(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int const __pyx_v_codelen, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work) {
  PY_LONG_LONG __pyx_v_b;
  CYTHON_UNUSED PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  long __pyx_v_exp_index;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;1390:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">codelen</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1391:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1392:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1393: </pre>
<pre class='cython line score-0'>&#xA0;1394:     <span class="c"># print sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1395:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1396:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1397:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span></pre>
<pre class='cython line score-0'>&#xA0;1398:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1399: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1400:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1401:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelen</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_codelen;
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1402:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1403:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1404:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1405:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1406:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1407:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1408:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1409:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1410:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1411:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1412:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1413:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1414: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1415:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1416: </pre>
<pre class='cython line score-0'>&#xA0;1417: </pre>
<pre class='cython line score-0'>&#xA0;1418: </pre>
<pre class='cython line score-0'>&#xA0;1419: <span class="sd">&#39;&#39;&#39; simple skip negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1420: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_sg_neg_simple</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_neg_simple(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random) {
  CYTHON_UNUSED PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;1421:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1422:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1423:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1424:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1425: </pre>
<pre class='cython line score-0'>&#xA0;1426:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1427:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1428:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;1429:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;1430:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;1431:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;1432: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1433:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1434: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1435:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1436: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1437:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1438:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1439:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1440:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1441:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1442:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1443:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1444:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1445:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;1446: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1447:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1448:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1449:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1450:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1451:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1452:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1453:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1454:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1455:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1456: </pre>
<pre class='cython line score-0'>&#xA0;1457: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1458:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1459: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1460:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1461: </pre>
<pre class='cython line score-0'>&#xA0;1462: <span class="sd">&#39;&#39;&#39; simple skip negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1463: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_sg_neg_simple</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_simple(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const __pyx_v_word_index, __pyx_t_5numpy_uint32_t const __pyx_v_word2_index, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, unsigned PY_LONG_LONG __pyx_v_next_random) {
  CYTHON_UNUSED PY_LONG_LONG __pyx_v_row1;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  int __pyx_v_d;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;1464:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1465:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word_index</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1466:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">word2_index</span><span class="p">,</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1467:     <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1468: </pre>
<pre class='cython line score-0'>&#xA0;1469:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1470:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row1</span> <span class="o">=</span> <span class="n">word2_index</span> <span class="o">*</span> <span class="n">size</span><span class="p">,</span> <span class="n">row2</span></pre>
<pre class='cython code score-0'>  __pyx_v_row1 = (__pyx_v_word2_index * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1471:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;1472:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;1473:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span></pre>
<pre class='cython line score-0'>&#xA0;1474:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span></pre>
<pre class='cython line score-0'>&#xA0;1475: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1476:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1477: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1478:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1479: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1480:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1481:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1482:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1483:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1484:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1485:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1486:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1487:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1488:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;1489: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1490:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;1491:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, &amp;syn0[row1], &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1492:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1493:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1494:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1495:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1496:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1497:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1498:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1499: </pre>
<pre class='cython line score-0'>&#xA0;1500: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1501:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1502: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1503:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1504: </pre>
<pre class='cython line score-0'>&#xA0;1505: <span class="sd">&#39;&#39;&#39; concat cbow &#39;&#39;&#39;</span></pre>
<pre class='cython line score-94' onclick='toggleDiv(this)'>+1506: <span class="k">def</span> <span class="nf">train_sentence_cbow_concatenate</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span>  <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-94'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_11train_sentence_cbow_concatenate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_11train_sentence_cbow_concatenate = {"train_sentence_cbow_concatenate", (PyCFunction)__pyx_pw_22inner_paragraph_vector_11train_sentence_cbow_concatenate, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_11train_sentence_cbow_concatenate(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_concatenate (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_cbow_concatenate") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v__neu1 = values[5];
    __pyx_v_alpha_doc = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_concatenate", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_concatenate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_10train_sentence_cbow_concatenate(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_10train_sentence_cbow_concatenate(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  int __pyx_v_cbow_mean;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_null_vec;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_window_r;
  long __pyx_v_word_vec_length_total;
  int __pyx_v_l1_size;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  long __pyx_v__sentence_id;
  long __pyx_v_l1_i;
  CYTHON_UNUSED long __pyx_v_top_i;
  long __pyx_v_m;
  CYTHON_UNUSED long __pyx_v_bottom_i;
  int __pyx_v_flag_freeze_learning;
  int __pyx_v_skip_concat;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_concatenate", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_concatenate", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__33 = <span class='py_c_api'>PyTuple_Pack</span>(50, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_cbow_mean, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_null_vec, __pyx_n_s_neu1_2, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_window_r, __pyx_n_s_word_vec_length_total, __pyx_n_s_l1_size, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_sentence_id_2, __pyx_n_s_sent_i, __pyx_n_s_l1_i, __pyx_n_s_l1_j, __pyx_n_s_size_i, __pyx_n_s_top_i, __pyx_n_s_m, __pyx_n_s_bottom_i, __pyx_n_s_flag_freeze_learning, __pyx_n_s_skip_concat, __pyx_n_s_l1, __pyx_n_s_work_2, __pyx_n_s_iii, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__33)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__33);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__33);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_11train_sentence_cbow_concatenate, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_cbow_concatenate, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__34 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 50, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__33, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_cbow_concatenate, 1506, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__34)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1507:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1508:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1509:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1510: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+1511:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1511; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1512:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span> <span class="c"># add</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1513:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">null_vec</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">null_vec</span><span class="p">))</span> <span class="c"># add</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_null_vec);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_null_vec = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;1514:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">neu1</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1515:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1515; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1516:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1516; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1517:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1518:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1518; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1519: </pre>
<pre class='cython line score-0'>&#xA0;1520:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1521:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1522:     <span class="c"># cdef np.uint32_t reduced_windows[MAX_SENTENCE_LEN] # no reduce</span></pre>
<pre class='cython line score-0'>&#xA0;1523:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1524:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1525:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window_r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window_r</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window_r);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_window_r = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1526:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">word_vec_length_total</span> <span class="o">=</span> <span class="p">(</span><span class="n">window</span><span class="o">+</span><span class="n">window_r</span><span class="p">)</span><span class="o">*</span><span class="n">size</span> <span class="c"># add</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_vec_length_total = ((__pyx_v_window + __pyx_v_window_r) * __pyx_v_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1527:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">l1_size</span> <span class="o">=</span> <span class="n">word_vec_length_total</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_size = (__pyx_v_word_vec_length_total + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;1528:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1529:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+1530:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span> <span class="c"># add</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1530; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;1531:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">sent_i</span></pre>
<pre class='cython line score-0'>&#xA0;1532:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_i</span></pre>
<pre class='cython line score-0'>&#xA0;1533:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_j</span><span class="p">,</span><span class="nf">size_i</span></pre>
<pre class='cython line score-0'>&#xA0;1534:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">top_i</span><span class="p">,</span><span class="nf">m</span><span class="p">,</span><span class="nf">bottom_i</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1535:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">flag_freeze_learning</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">freeze_learn</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_freeze_learn);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1535; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_flag_freeze_learning = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+1536:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">skip_concat</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">skip_concat</span> <span class="c"># null</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_skip_concat);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1536; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_skip_concat = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;1537:     <span class="c"># init l1</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1538:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">l1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1538; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_l1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1539:     <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1540: </pre>
<pre class='cython line score-0'>&#xA0;1541:     <span class="c"># print &quot;init work&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1542:     <span class="c"># init work</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1543:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1543; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1544:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1545:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">iii</span></pre>
<pre class='cython line score-0'>&#xA0;1546: </pre>
<pre class='cython line score-0'>&#xA0;1547:     <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1548:     <span class="c">#     print &quot;cython&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1549:     <span class="c"># else:</span></pre>
<pre class='cython line score-0'>&#xA0;1550:     <span class="c">#     print &quot;g_cython&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1551:     <span class="c"># print &quot;syn0&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1552:     <span class="c"># print model.syn0[1]</span></pre>
<pre class='cython line score-0'>&#xA0;1553: </pre>
<pre class='cython line score-0'>&#xA0;1554: </pre>
<pre class='cython line score-0'>&#xA0;1555:     <span class="c"># print &quot;syn0_here&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1556:     <span class="c"># for iii in range(size):</span></pre>
<pre class='cython line score-0'>&#xA0;1557:     <span class="c">#     print syn0[iii+size]</span></pre>
<pre class='cython line score-0'>&#xA0;1558:     <span class="c"># print &quot;doc&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1559:     <span class="c"># print model.doc[1]</span></pre>
<pre class='cython line score-0'>&#xA0;1560: </pre>
<pre class='cython line score-0'>&#xA0;1561: </pre>
<pre class='cython line score-0'>&#xA0;1562:     <span class="c"># print &quot;doc_here&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1563:     <span class="c"># for iii in range(doc_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1564:     <span class="c">#     print doc[iii+doc_size]</span></pre>
<pre class='cython line score-0'>&#xA0;1565: </pre>
<pre class='cython line score-0'>&#xA0;1566:     <span class="c"># print &quot;shape&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1567:     <span class="c"># print model.null_vec.shape</span></pre>
<pre class='cython line score-0'>&#xA0;1568:     <span class="c"># print type(model.syn0)</span></pre>
<pre class='cython line score-0'>&#xA0;1569:     <span class="c"># print type(model.null_vec)</span></pre>
<pre class='cython line score-0'>&#xA0;1570:     <span class="c"># print &quot;null_vec_py&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1571:     <span class="c"># print model.null_vec</span></pre>
<pre class='cython line score-0'>&#xA0;1572: </pre>
<pre class='cython line score-0'>&#xA0;1573: </pre>
<pre class='cython line score-0'>&#xA0;1574:     <span class="c"># print &quot;null_vec_here&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1575:     <span class="c"># for iii in range(size):</span></pre>
<pre class='cython line score-0'>&#xA0;1576:     <span class="c">#     print null_vec[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1577:         <span class="c"># print null_vec+iii,</span></pre>
<pre class='cython line score-0'>&#xA0;1578: </pre>
<pre class='cython line score-0'>&#xA0;1579:     <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1580:     <span class="c"># print &quot;word_vec_length_total&quot;, word_vec_length_total</span></pre>
<pre class='cython line score-0'>&#xA0;1581:     <span class="c"># print &quot;doc_size&quot;, doc_size</span></pre>
<pre class='cython line score-0'>&#xA0;1582:     <span class="c"># print &quot;total&quot;, l1_size</span></pre>
<pre class='cython line score-0'>&#xA0;1583:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;1584:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;1585:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1586:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;1587: </pre>
<pre class='cython line score-0'>&#xA0;1588:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;1589:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;1590:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;1591:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;1592:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;1593: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1594:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1595:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1595; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;1596: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1597:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1598:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1598; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1599:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1599; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1600:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1600; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+1601:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__11, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__11 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__11)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__11);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__11);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__12, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__12 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__12)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1601; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__12);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__12);
</pre><pre class='cython line score-0'>&#xA0;1602: </pre>
<pre class='cython line score-0'>&#xA0;1603:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+1604:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1604; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;1605: </pre>
<pre class='cython line score-0'>&#xA0;1606:     <span class="c"># print &quot;doc_original&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1607:     <span class="c"># print model.doc[0]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1608:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+1609:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1609; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1610:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1611:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1612:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;1613: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1614:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1614; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;1615:             <span class="c"># reduced_windows[i] = np.random.randint(window) # no reduce</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1616:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+1617:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1617; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1618:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1618; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+1619:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 1619; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1620:                 <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1621:                     <span class="c"># print word.point</span></pre>
<pre class='cython line score-0'>&#xA0;1622:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1623:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1624:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;1625: </pre>
<pre class='cython line score-0'>&#xA0;1626:     <span class="c"># print &quot;nogil&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1627:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1628:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1629:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0'>&#xA0;1630:             <span class="c"># print &quot;\n-----------------&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1631:             <span class="c"># print &quot;i = &quot;,i</span></pre>
<pre class='cython line score-0'>&#xA0;1632:             <span class="c"># print &quot;-----------------&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1633:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1634:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0'>&#xA0;1635: </pre>
<pre class='cython line score-0'>&#xA0;1636:             <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1637:                 <span class="c"># print &quot;points[i]  : &quot;, points[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1638: </pre>
<pre class='cython line score-0'>&#xA0;1639:             <span class="c"># print &quot;l1 : &quot;, l1_size</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1640:             <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>          memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1641:             <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">l1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>          memset(__pyx_v_l1, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1642: </pre>
<pre class='cython line score-0'>&#xA0;1643:             <span class="c"># print &quot;memset af&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1644:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = (__pyx_v_i - __pyx_v_window);
</pre><pre class='cython line score-0'>&#xA0;1645: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1646:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1647:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1648:                 <span class="k">if</span> <span class="n">skip_concat</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = ((__pyx_v_skip_concat == 1) != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1649:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L12_continue;
            }
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0'>&#xA0;1650:             <span class="c"># k = i + window + 1 - reduced_windows[i]</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1651:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span> <span class="o">+</span> <span class="mf">1</span>  <span class="c"># no reduce</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = ((__pyx_v_i + __pyx_v_window_r) + 1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1652:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1653:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1654:                 <span class="k">if</span> <span class="n">skip_concat</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_12 = ((__pyx_v_skip_concat == 1) != 0);
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1655:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L12_continue;
            }
            goto __pyx_L17;
          }
          __pyx_L17:;
</pre><pre class='cython line score-0'>&#xA0;1656: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1657:             <span class="n">l1_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>          __pyx_v_l1_i = 0;
</pre><pre class='cython line score-0'>&#xA0;1658: </pre>
<pre class='cython line score-0'>&#xA0;1659:             <span class="c"># top</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1660:             <span class="k">for</span> <span class="n">top_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="o">-</span><span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_14 = (__pyx_v_window - __pyx_v_i);
          for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_14; __pyx_t_5+=1) {
            __pyx_v_top_i = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1661:                 <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">null_vec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">l1_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_null_vec, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[(__pyx_v_l1_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1662:                 <span class="n">l1_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>            __pyx_v_l1_i = (__pyx_v_l1_i + 1);
          }
</pre><pre class='cython line score-0'>&#xA0;1663: </pre>
<pre class='cython line score-0'>&#xA0;1664: </pre>
<pre class='cython line score-0'>&#xA0;1665:             <span class="c">#     print &quot;\nSTEP TOP:&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1666:             <span class="c">#     print &quot;window-i : &quot;,window-i</span></pre>
<pre class='cython line score-0'>&#xA0;1667:             <span class="c">#     print &quot;l1_i : &quot;,l1_i</span></pre>
<pre class='cython line score-0'>&#xA0;1668: </pre>
<pre class='cython line score-0'>&#xA0;1669:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1670:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1671:             <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1672:             <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1673: </pre>
<pre class='cython line score-0'>&#xA0;1674: </pre>
<pre class='cython line score-0'>&#xA0;1675:             <span class="c"># indcies</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1676:             <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_14 = __pyx_v_k;
          for (__pyx_t_5 = __pyx_v_j; __pyx_t_5 &lt; __pyx_t_14; __pyx_t_5+=1) {
            __pyx_v_m = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1677:                 <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>            __pyx_t_6 = ((__pyx_v_m == __pyx_v_i) != 0);
            if (!__pyx_t_6) {
            } else {
              __pyx_t_12 = __pyx_t_6;
              goto __pyx_L24_bool_binop_done;
            }
            __pyx_t_6 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
            __pyx_t_12 = __pyx_t_6;
            __pyx_L24_bool_binop_done:;
            if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1678:                     <span class="k">continue</span></pre>
<pre class='cython code score-0'>              goto __pyx_L21_continue;
            }
</pre><pre class='cython line score-0'>&#xA0;1679: </pre>
<pre class='cython line score-0'>&#xA0;1680:                 <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1681:                 <span class="c">#     print &quot;\nCENTER!!\n&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1682:                 <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">l1_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[(__pyx_v_l1_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1683:                 <span class="n">l1_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>            __pyx_v_l1_i = (__pyx_v_l1_i + 1);
            __pyx_L21_continue:;
          }
</pre><pre class='cython line score-0'>&#xA0;1684: </pre>
<pre class='cython line score-0'>&#xA0;1685: </pre>
<pre class='cython line score-0'>&#xA0;1686: </pre>
<pre class='cython line score-0'>&#xA0;1687:             <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1688:             <span class="c">#     print &quot;\nSTEP CENTER:&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1689:             <span class="c">#     print &quot;j : &quot;,j</span></pre>
<pre class='cython line score-0'>&#xA0;1690:             <span class="c">#     print &quot;k : &quot;,k</span></pre>
<pre class='cython line score-0'>&#xA0;1691: </pre>
<pre class='cython line score-0'>&#xA0;1692:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1693:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1694: </pre>
<pre class='cython line score-0'>&#xA0;1695:             <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1696:             <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1697: </pre>
<pre class='cython line score-0'>&#xA0;1698: </pre>
<pre class='cython line score-0'>&#xA0;1699:             <span class="c"># bottom</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1700:             <span class="k">for</span> <span class="n">bottom_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span><span class="o">-</span><span class="n">sentence_len</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>          __pyx_t_5 = (((__pyx_v_i + __pyx_v_window_r) - __pyx_v_sentence_len) + 1);
          for (__pyx_t_15 = 0; __pyx_t_15 &lt; __pyx_t_5; __pyx_t_15+=1) {
            __pyx_v_bottom_i = __pyx_t_15;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1701:                 <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">null_vec</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">l1_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_null_vec, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[(__pyx_v_l1_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1702:                 <span class="n">l1_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>            __pyx_v_l1_i = (__pyx_v_l1_i + 1);
          }
</pre><pre class='cython line score-0'>&#xA0;1703: </pre>
<pre class='cython line score-0'>&#xA0;1704:             <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1705:             <span class="c">#     print &quot;STEP BOTTOM:&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1706:             <span class="c">#     print &quot;i + window_r-sentence_len+1 : &quot;, i + window_r-sentence_len+1</span></pre>
<pre class='cython line score-0'>&#xA0;1707:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1708:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1709:             <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1710:             <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1711:             <span class="c"># print &quot;l1_i&quot;,l1_i</span></pre>
<pre class='cython line score-0'>&#xA0;1712:             <span class="c">#doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1713:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">_sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">l1</span><span class="p">[</span><span class="n">l1_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>          __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v__sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_l1[(__pyx_v_l1_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1714: </pre>
<pre class='cython line score-0'>&#xA0;1715: </pre>
<pre class='cython line score-0'>&#xA0;1716:             <span class="c"># print &quot;sentence_id : &quot;, sentence_id</span></pre>
<pre class='cython line score-0'>&#xA0;1717:             <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1718:             <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1719:             <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1720: </pre>
<pre class='cython line score-0'>&#xA0;1721: </pre>
<pre class='cython line score-0'>&#xA0;1722:             <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1723:             <span class="c">#     print &quot;\nSTEP DOC:&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1724:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1725:             <span class="c">#     print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1726:             <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1727:             <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1728: </pre>
<pre class='cython line score-0'>&#xA0;1729: </pre>
<pre class='cython line score-0'>&#xA0;1730: </pre>
<pre class='cython line score-0'>&#xA0;1731:             <span class="c">#     print &quot;\nDOC DOC:&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1732:             <span class="c">#     for iii in range(doc_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1733:             <span class="c">#         print doc[_sentence_id+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1734: </pre>
<pre class='cython line score-0'>&#xA0;1735:             <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1736:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_hs != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1737:                 <span class="n">fast_sentence_cbow_hs_concat</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">,</span><span class="n">null_vec</span> <span class="p">,</span><span class="n">window</span> <span class="p">,</span> <span class="n">window_r</span><span class="p">,</span><span class="n">sentence_len</span><span class="p">,</span> <span class="n">l1</span> <span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">size</span> <span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">l1_size</span><span class="p">,</span><span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs_concat(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), __pyx_v_codelens, __pyx_v_null_vec, __pyx_v_window, __pyx_v_window_r, __pyx_v_sentence_len, __pyx_v_l1, __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_size, __pyx_v_doc_size, __pyx_v_l1_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_flag_freeze_learning);
            goto __pyx_L28;
          }
          __pyx_L28:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1738:             <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_negative != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1739:                 <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_cbow_neg_concat</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">codelens</span><span class="p">,</span><span class="n">null_vec</span> <span class="p">,</span><span class="n">window</span> <span class="p">,</span> <span class="n">window_r</span><span class="p">,</span><span class="n">sentence_len</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">doc</span> <span class="p">,</span><span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">l1_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">next_random</span><span class="p">,</span><span class="n">flag_freeze_learning</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg_concat(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_codelens, __pyx_v_null_vec, __pyx_v_window, __pyx_v_window_r, __pyx_v_sentence_len, __pyx_v_l1, __pyx_v_doc, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_size, __pyx_v_doc_size, __pyx_v_l1_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_next_random, __pyx_v_flag_freeze_learning);
            goto __pyx_L29;
          }
          __pyx_L29:;
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;1740: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+1741:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 1741; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1742: </pre>
<pre class='cython line score-0'>&#xA0;1743: </pre>
<pre class='cython line score-0'>&#xA0;1744: </pre>
<pre class='cython line score-0'>&#xA0;1745: <span class="sd">&#39;&#39;&#39; conca cbow hs&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1746: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_cbow_hs_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_hs_concat(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_null_vec, int const __pyx_v_window, int const __pyx_v_window_r, int const __pyx_v_sentence_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, int const __pyx_v_doc_size, int const __pyx_v_l1_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_cbow_mean, int __pyx_v_flag_freeze_learning) {
  long __pyx_v__sentence_id;
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  long __pyx_v_m;
  CYTHON_UNUSED long __pyx_v_l1_i;
  CYTHON_UNUSED long __pyx_v_top_i;
  CYTHON_UNUSED long __pyx_v_bottom_i;
  long __pyx_v_word_start_i;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;1747:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;1748:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1749:     <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1750:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span><span class="c"># </span></pre>
<pre class='cython line score-0'>&#xA0;1751: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1752:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="c"># add</span></pre>
<pre class='cython code score-0'>  __pyx_v__sentence_id = __pyx_v_sentence_id;
</pre><pre class='cython line score-0'>&#xA0;1753:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;1754:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">size_i</span><span class="p">,</span><span class="nf">d_i</span></pre>
<pre class='cython line score-0'>&#xA0;1755:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;1756:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;1757:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1758:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_i</span> <span class="o">=</span> <span class="n">window</span> <span class="o">+</span> <span class="n">window_r</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_i = (__pyx_v_window + __pyx_v_window_r);
</pre><pre class='cython line score-0'>&#xA0;1759:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;1760:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">top_i</span><span class="p">,</span><span class="nf">bottom_i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1761:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0'>&#xA0;1762:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1763:     <span class="c"># cdef int flag_freeze_learning_ = flag_freeze_learning</span></pre>
<pre class='cython line score-0'>&#xA0;1764: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1765:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1766:     <span class="c"># for l1_j in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1767:     <span class="c">#         print &quot;l1 or &quot;,l1[l1_j],l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;1768: </pre>
<pre class='cython line score-0'>&#xA0;1769:     <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1770:     <span class="c">#     print &quot;codelens[i] : &quot;, codelens[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1771:     <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1772:     <span class="c">#         print l1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1773:     <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1774: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1775:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1776:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">l1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_l1_size);
</pre><pre class='cython line score-0'>&#xA0;1777:         <span class="c"># print &quot;word_point[b] : &quot;,word_point[b]</span></pre>
<pre class='cython line score-0'>&#xA0;1778:         <span class="c"># print &quot;row2 values : &quot;, row2</span></pre>
<pre class='cython line score-0'>&#xA0;1779: </pre>
<pre class='cython line score-0'>&#xA0;1780:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1781:         <span class="c">#     print &quot;syn1[row2]&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1782:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1783:         <span class="c">#         print syn1[row2+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1784:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1785: </pre>
<pre class='cython line score-0'>&#xA0;1786: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1787:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0'>&#xA0;1788: </pre>
<pre class='cython line score-0'>&#xA0;1789:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;1790:         <span class="c">#     continue</span></pre>
<pre class='cython line score-0'>&#xA0;1791:         <span class="c"># exp_index = &lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))</span></pre>
<pre class='cython line score-0'>&#xA0;1792:         <span class="c"># if exp_index &gt;= EXP_TABLE_SIZE or exp_index &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1793:         <span class="c">#     continue</span></pre>
<pre class='cython line score-0'>&#xA0;1794:         <span class="c"># f = &lt;REAL_t&gt; EXP_TABLE[exp_index]</span></pre>
<pre class='cython line score-0'>&#xA0;1795: </pre>
<pre class='cython line score-0'>&#xA0;1796: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1797:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;1798: </pre>
<pre class='cython line score-0'>&#xA0;1799: </pre>
<pre class='cython line score-0'>&#xA0;1800:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1801:         <span class="c">#     print &quot;f&quot;, f</span></pre>
<pre class='cython line score-0'>&#xA0;1802: </pre>
<pre class='cython line score-0'>&#xA0;1803:         <span class="c"># original code</span></pre>
<pre class='cython line score-0'>&#xA0;1804:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, neu1, &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;1805:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;1806:         <span class="c">#     continue</span></pre>
<pre class='cython line score-0'>&#xA0;1807:         <span class="c"># f = EXP_TABLE[&lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]</span></pre>
<pre class='cython line score-0'>&#xA0;1808: </pre>
<pre class='cython line score-0'>&#xA0;1809: </pre>
<pre class='cython line score-0'>&#xA0;1810:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1811:         <span class="c">#     print &quot;row2 : &quot;,row2</span></pre>
<pre class='cython line score-0'>&#xA0;1812: </pre>
<pre class='cython line score-0'>&#xA0;1813:         <span class="c">#     print &quot;syn1 before&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1814:         <span class="c">#     # print &quot;codelens[i] : &quot;, codelens[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1815:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1816:         <span class="c">#         print syn1[row2+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1817:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1818:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1819: </pre>
<pre class='cython line score-0'>&#xA0;1820: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1821:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1822:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1823:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
  }
</pre><pre class='cython line score-0'>&#xA0;1824: </pre>
<pre class='cython line score-0'>&#xA0;1825: </pre>
<pre class='cython line score-0'>&#xA0;1826:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1827:         <span class="c">#     print &quot;syn1 after&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1828:         <span class="c">#     # print &quot;codelens[i] : &quot;, codelens[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1829:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1830:         <span class="c">#         print syn1[row2+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1831:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1832:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1833: </pre>
<pre class='cython line score-0'>&#xA0;1834:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1835:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1836:         <span class="c">#         print work[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1837:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1838: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1839:     <span class="n">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1840:     <span class="k">for</span> <span class="n">top_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="o">-</span><span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_window - __pyx_v_i);
  for (__pyx_t_3 = 0; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_top_i = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1841:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;1842:     <span class="c"># word indexes</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1843:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_3 = __pyx_v_j; __pyx_t_3 &lt; __pyx_t_1; __pyx_t_3+=1) {
    __pyx_v_m = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1844:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_4 = __pyx_t_5;
      goto __pyx_L10_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_4 = __pyx_t_5;
    __pyx_L10_bool_binop_done:;
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1845:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L7_continue;
    }
</pre><pre class='cython line score-0'>&#xA0;1846: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1847:         <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_flag_freeze_learning == 0) != 0);
    if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1848:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
      goto __pyx_L12;
    }
    __pyx_L12:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1849:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
    __pyx_L7_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1850: </pre>
<pre class='cython line score-0'>&#xA0;1851:     <span class="c"># null word</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1852:     <span class="k">for</span> <span class="n">bottom_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span><span class="o">-</span><span class="n">sentence_len</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_3 = (((__pyx_v_i + __pyx_v_window_r) - __pyx_v_sentence_len) + 1);
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_3; __pyx_t_6+=1) {
    __pyx_v_bottom_i = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1853:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;1854: </pre>
<pre class='cython line score-0'>&#xA0;1855:     <span class="c"># print &quot;word_start_i*size&quot;,word_start_i*size</span></pre>
<pre class='cython line score-0'>&#xA0;1856:     <span class="c"># #doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1857:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">_sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v__sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1858: </pre>
<pre class='cython line score-0'>&#xA0;1859: </pre>
<pre class='cython line score-0'>&#xA0;1860: </pre>
<pre class='cython line score-0'>&#xA0;1861: <span class="sd">&#39;&#39;&#39; conca cbow negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1862: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_cbow_neg_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_neg_concat(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_null_vec, int const __pyx_v_window, int const __pyx_v_window_r, int const __pyx_v_sentence_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, int const __pyx_v_doc_size, int const __pyx_v_l1_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random, int __pyx_v_flag_freeze_learning) {
  long __pyx_v__sentence_id;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  CYTHON_UNUSED long __pyx_v_l1_i;
  CYTHON_UNUSED long __pyx_v_top_i;
  CYTHON_UNUSED long __pyx_v_bottom_i;
  long __pyx_v_word_start_i;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;1863:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;1864:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1865:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1866:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1867:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span><span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span><span class="k">nogil</span> <span class="p">:</span><span class="c">#nogil</span></pre>
<pre class='cython line score-0'>&#xA0;1868: </pre>
<pre class='cython line score-0'>&#xA0;1869: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1870:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="c"># add</span></pre>
<pre class='cython code score-0'>  __pyx_v__sentence_id = __pyx_v_sentence_id;
</pre><pre class='cython line score-0'>&#xA0;1871: </pre>
<pre class='cython line score-0'>&#xA0;1872:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;1873:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1874:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;1875:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;1876:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;1877:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;1878: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1879:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_i</span> <span class="o">=</span> <span class="n">window</span> <span class="o">+</span> <span class="n">window_r</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_i = (__pyx_v_window + __pyx_v_window_r);
</pre><pre class='cython line score-0'>&#xA0;1880:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;1881:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">top_i</span><span class="p">,</span><span class="nf">bottom_i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1882:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0'>&#xA0;1883:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1884: </pre>
<pre class='cython line score-0'>&#xA0;1885: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1886:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;1887: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1888:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1889: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1890:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1891:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1892:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1893:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;1894:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1895:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1896:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1897:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1898:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1899:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;1900: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1901:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">l1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_l1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1902:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0'>&#xA0;1903: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1904:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;1905: </pre>
<pre class='cython line score-0'>&#xA0;1906:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;1907:         <span class="c">#     continue</span></pre>
<pre class='cython line score-0'>&#xA0;1908:         <span class="c"># exp_index = &lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))</span></pre>
<pre class='cython line score-0'>&#xA0;1909:         <span class="c"># if exp_index &gt;= EXP_TABLE_SIZE or exp_index &lt; 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1910:         <span class="c">#     continue</span></pre>
<pre class='cython line score-0'>&#xA0;1911:         <span class="c"># f = EXP_TABLE[exp_index]</span></pre>
<pre class='cython line score-0'>&#xA0;1912:         <span class="c"># print &quot;f &quot;, f</span></pre>
<pre class='cython line score-0'>&#xA0;1913:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1914:         <span class="c">#     print &quot;row2 : &quot;,row2</span></pre>
<pre class='cython line score-0'>&#xA0;1915: </pre>
<pre class='cython line score-0'>&#xA0;1916:         <span class="c">#     print &quot;syn1 before&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1917:         <span class="c">#     # print &quot;codelens[i] : &quot;, codelens[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1918:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1919:         <span class="c">#         print syn1neg[row2+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1920:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1921:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1922: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1923:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1924:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1925:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1926: </pre>
<pre class='cython line score-0'>&#xA0;1927: </pre>
<pre class='cython line score-0'>&#xA0;1928:         <span class="c"># if sentence_id == 0:</span></pre>
<pre class='cython line score-0'>&#xA0;1929:         <span class="c">#     print &quot;row2 : &quot;,row2</span></pre>
<pre class='cython line score-0'>&#xA0;1930: </pre>
<pre class='cython line score-0'>&#xA0;1931:         <span class="c">#     print &quot;syn1 after&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1932:         <span class="c">#     # print &quot;codelens[i] : &quot;, codelens[i]</span></pre>
<pre class='cython line score-0'>&#xA0;1933:         <span class="c">#     for iii in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1934:         <span class="c">#         print syn1neg[row2+iii],</span></pre>
<pre class='cython line score-0'>&#xA0;1935:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1936:         <span class="c">#     print &quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1937: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1938:     <span class="n">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1939:     <span class="k">for</span> <span class="n">top_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="o">-</span><span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_window - __pyx_v_i);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_2; __pyx_t_1+=1) {
    __pyx_v_top_i = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1940:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;1941:     <span class="c"># word indexes</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1942:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_k;
  for (__pyx_t_4 = __pyx_v_j; __pyx_t_4 &lt; __pyx_t_2; __pyx_t_4+=1) {
    __pyx_v_m = __pyx_t_4;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1943:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_5 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_5) {
    } else {
      __pyx_t_3 = __pyx_t_5;
      goto __pyx_L12_bool_binop_done;
    }
    __pyx_t_5 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_5;
    __pyx_L12_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1944:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L9_continue;
    }
</pre><pre class='cython line score-0'>&#xA0;1945: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1946:         <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_flag_freeze_learning == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1947:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
      goto __pyx_L14;
    }
    __pyx_L14:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1948:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
    __pyx_L9_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;1949: </pre>
<pre class='cython line score-0'>&#xA0;1950:     <span class="c"># null word</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1951:     <span class="k">for</span> <span class="n">bottom_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span><span class="o">-</span><span class="n">sentence_len</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_i + __pyx_v_window_r) - __pyx_v_sentence_len) + 1);
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_1; __pyx_t_6+=1) {
    __pyx_v_bottom_i = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1952:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;1953: </pre>
<pre class='cython line score-0'>&#xA0;1954:     <span class="c"># #doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1955:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">_sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v__sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;1956: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1957:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;1958: </pre>
<pre class='cython line score-0'>&#xA0;1959: </pre>
<pre class='cython line score-0'>&#xA0;1960: </pre>
<pre class='cython line score-0'>&#xA0;1961: <span class="sd">&#39;&#39;&#39; conca cbow hs&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1962: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_cbow_hs_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_hs_concat(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_null_vec, int const __pyx_v_window, int const __pyx_v_window_r, int const __pyx_v_sentence_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, int const __pyx_v_size, int const __pyx_v_doc_size, int const __pyx_v_l1_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_cbow_mean, int __pyx_v_flag_freeze_learning) {
  long __pyx_v__sentence_id;
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  long __pyx_v_m;
  CYTHON_UNUSED long __pyx_v_l1_i;
  CYTHON_UNUSED long __pyx_v_top_i;
  CYTHON_UNUSED long __pyx_v_bottom_i;
  long __pyx_v_word_start_i;
  int __pyx_v_exp_index;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;1963:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;1964:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1965:     <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;1966:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span><span class="c">#</span></pre>
<pre class='cython line score-0'>&#xA0;1967: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1968:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="c"># add</span></pre>
<pre class='cython code score-0'>  __pyx_v__sentence_id = __pyx_v_sentence_id;
</pre><pre class='cython line score-0'>&#xA0;1969:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;1970:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">size_i</span><span class="p">,</span><span class="nf">d_i</span></pre>
<pre class='cython line score-0'>&#xA0;1971:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;1972:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;1973:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1974:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_i</span> <span class="o">=</span> <span class="n">window</span> <span class="o">+</span> <span class="n">window_r</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_i = (__pyx_v_window + __pyx_v_window_r);
</pre><pre class='cython line score-0'>&#xA0;1975:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;1976:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">top_i</span><span class="p">,</span><span class="nf">bottom_i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1977:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0'>&#xA0;1978:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;1979:     <span class="c"># cdef int flag_freeze_learning_ = flag_freeze_learning</span></pre>
<pre class='cython line score-0'>&#xA0;1980: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1981:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;1982:     <span class="c"># for l1_j in range(l1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;1983:     <span class="c">#         print &quot;l1 or &quot;,l1[l1_j],l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;1984: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1985:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_b = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1986:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">l1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_l1_size);
</pre><pre class='cython line score-0'>&#xA0;1987:         <span class="c"># print &quot;f start&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;1988: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1989:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1990:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1991:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1992:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1993:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L9_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L9_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1994:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0'>&#xA0;1995: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1996:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)(__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]));
</pre><pre class='cython line score-0'>&#xA0;1997: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+1998:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+1999:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2000:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2001: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2002:     <span class="n">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2003:     <span class="k">for</span> <span class="n">top_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="o">-</span><span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_window - __pyx_v_i);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_top_i = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2004:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;2005:     <span class="c"># word indexes</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2006:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_5 = __pyx_v_j; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_m = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2007:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2008:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L13_continue;
    }
</pre><pre class='cython line score-0'>&#xA0;2009: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2010:         <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_flag_freeze_learning == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2011:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
      goto __pyx_L18;
    }
    __pyx_L18:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2012:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
    __pyx_L13_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2013: </pre>
<pre class='cython line score-0'>&#xA0;2014:     <span class="c"># null word</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2015:     <span class="k">for</span> <span class="n">bottom_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span><span class="o">-</span><span class="n">sentence_len</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (((__pyx_v_i + __pyx_v_window_r) - __pyx_v_sentence_len) + 1);
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_5; __pyx_t_6+=1) {
    __pyx_v_bottom_i = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2016:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;2017: </pre>
<pre class='cython line score-0'>&#xA0;2018:     <span class="c"># #doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2019:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">_sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v__sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2020: </pre>
<pre class='cython line score-0'>&#xA0;2021: </pre>
<pre class='cython line score-0'>&#xA0;2022: </pre>
<pre class='cython line score-0'>&#xA0;2023: <span class="sd">&#39;&#39;&#39; conca cbow negative&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2024: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_cbow_neg_concat</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_neg_concat(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_null_vec, int const __pyx_v_window, int const __pyx_v_window_r, int const __pyx_v_sentence_len, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, int const __pyx_v_size, int const __pyx_v_doc_size, int const __pyx_v_l1_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, CYTHON_UNUSED int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random, int __pyx_v_flag_freeze_learning) {
  long __pyx_v__sentence_id;
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  CYTHON_UNUSED long __pyx_v_l1_i;
  CYTHON_UNUSED long __pyx_v_top_i;
  CYTHON_UNUSED long __pyx_v_bottom_i;
  long __pyx_v_word_start_i;
  int __pyx_v_exp_index;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;2025:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2026:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">null_vec</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">window</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">window_r</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">sentence_len</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2027:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">l1_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2028:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2029:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span><span class="nb">int</span> <span class="n">flag_freeze_learning</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2030: </pre>
<pre class='cython line score-0'>&#xA0;2031: </pre>
<pre class='cython line score-0'>&#xA0;2032: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2033:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="c"># add</span></pre>
<pre class='cython code score-0'>  __pyx_v__sentence_id = __pyx_v_sentence_id;
</pre><pre class='cython line score-0'>&#xA0;2034: </pre>
<pre class='cython line score-0'>&#xA0;2035:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;2036:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2037:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;2038:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;2039:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;2040:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;2041: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2042:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_i</span> <span class="o">=</span> <span class="n">window</span> <span class="o">+</span> <span class="n">window_r</span></pre>
<pre class='cython code score-0'>  __pyx_v_l1_i = (__pyx_v_window + __pyx_v_window_r);
</pre><pre class='cython line score-0'>&#xA0;2043:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">l1_j</span></pre>
<pre class='cython line score-0'>&#xA0;2044:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">top_i</span><span class="p">,</span><span class="nf">bottom_i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2045:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0'>&#xA0;2046:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">exp_index</span></pre>
<pre class='cython line score-0'>&#xA0;2047: </pre>
<pre class='cython line score-0'>&#xA0;2048: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2049:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;2050: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2051:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="p">(</span><span class="n">l1_size</span><span class="p">)</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_l1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2052: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2053:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_negative + 1);
  for (__pyx_t_2 = 0; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_d = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2054:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2055:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2056:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L5;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2057:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2058:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2059:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2060:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2061:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L3_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2062:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L5:;
</pre><pre class='cython line score-0'>&#xA0;2063: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2064:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">l1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_l1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2065:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_l1_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2066:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L8_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L8_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2067:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2068:         <span class="n">exp_index</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_exp_index = ((int)((__pyx_v_f + 12.0) * 416.0));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2069:         <span class="k">if</span> <span class="n">exp_index</span> <span class="o">&gt;=</span> <span class="n">EXP_TABLE_SIZE</span> <span class="ow">or</span> <span class="n">exp_index</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_exp_index &gt;= 10000) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L11_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_exp_index &lt; 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L11_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2070:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2071:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">exp_index</span><span class="p">]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_exp_index]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2072:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2073:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2074:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">l1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_l1_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2075: </pre>
<pre class='cython line score-0'>&#xA0;2076: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2077:     <span class="n">word_start_i</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_start_i = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2078:     <span class="k">for</span> <span class="n">top_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">window</span><span class="o">-</span><span class="n">i</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = (__pyx_v_window - __pyx_v_i);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_2; __pyx_t_1+=1) {
    __pyx_v_top_i = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2079:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;2080:     <span class="c"># word indexes</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2081:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_k;
  for (__pyx_t_5 = __pyx_v_j; __pyx_t_5 &lt; __pyx_t_2; __pyx_t_5+=1) {
    __pyx_v_m = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2082:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L18_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L18_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2083:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L15_continue;
    }
</pre><pre class='cython line score-0'>&#xA0;2084: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2085:         <span class="k">if</span> <span class="n">flag_freeze_learning</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_flag_freeze_learning == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2086:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
      goto __pyx_L20;
    }
    __pyx_L20:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2087:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
    __pyx_L15_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2088: </pre>
<pre class='cython line score-0'>&#xA0;2089:     <span class="c"># null word</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2090:     <span class="k">for</span> <span class="n">bottom_i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span><span class="o">-</span><span class="n">sentence_len</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (((__pyx_v_i + __pyx_v_window_r) - __pyx_v_sentence_len) + 1);
  for (__pyx_t_6 = 0; __pyx_t_6 &lt; __pyx_t_1; __pyx_t_6+=1) {
    __pyx_v_bottom_i = __pyx_t_6;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2091:         <span class="n">word_start_i</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>    __pyx_v_word_start_i = (__pyx_v_word_start_i + 1);
  }
</pre><pre class='cython line score-0'>&#xA0;2092: </pre>
<pre class='cython line score-0'>&#xA0;2093:     <span class="c"># #doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2094:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">word_start_i</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">_sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[(__pyx_v_word_start_i * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v__sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2095: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2096:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2097: </pre>
<pre class='cython line score-0'>&#xA0;2098: </pre>
<pre class='cython line score-0'>&#xA0;2099: </pre>
<pre class='cython line score-0'>&#xA0;2100: <span class="sd">&#39;&#39;&#39; cbow average&#39;&#39;&#39;</span></pre>
<pre class='cython line score-94' onclick='toggleDiv(this)'>+2101: <span class="k">def</span> <span class="nf">train_sentence_cbow_average_simple</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-94'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_13train_sentence_cbow_average_simple(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_13train_sentence_cbow_average_simple = {"train_sentence_cbow_average_simple", (PyCFunction)__pyx_pw_22inner_paragraph_vector_13train_sentence_cbow_average_simple, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_13train_sentence_cbow_average_simple(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_average_simple (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_cbow_average_simple") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v__neu1 = values[5];
    __pyx_v_alpha_doc = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_simple", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_average_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_12train_sentence_cbow_average_simple(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_12train_sentence_cbow_average_simple(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  int __pyx_v_cbow_mean;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  long __pyx_v__sentence_id;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_window_r;
  int __pyx_v_average_flag;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_average_simple", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_average_simple", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__35 = <span class='py_c_api'>PyTuple_Pack</span>(38, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_cbow_mean, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_work_2, __pyx_n_s_l1, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_sentence_id_2, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_reduced_windows, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_window_r, __pyx_n_s_average_flag, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__35)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__35);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__35);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_13train_sentence_cbow_average_simple, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_cbow_average_simp, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__36 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 38, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__35, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_cbow_average_simp, 2101, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__36)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2101; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2102:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2102; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2103:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2103; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2104:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2104; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2105: </pre>
<pre class='cython line score-0'>&#xA0;2106: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+2107:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2107; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2108:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2108; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;2109:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-0'>&#xA0;2110:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">l1</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+2111:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2111; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2112:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2112; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2113:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2113; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2114:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2114; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2115: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+2116:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span> <span class="c"># add</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2116; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;2117:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2118:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2119:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">reduced_windows</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2120:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+2121:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2121; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2122:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window_r</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window_r</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window_r);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2122; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_window_r = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2123: </pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+2124:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">average_flag</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">average_flag</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_average_flag);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2124; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_average_flag = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2125: </pre>
<pre class='cython line score-0'>&#xA0;2126:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2127:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-0'>&#xA0;2128: </pre>
<pre class='cython line score-0'>&#xA0;2129:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;2130:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;2131:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2132:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2133: </pre>
<pre class='cython line score-0'>&#xA0;2134:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;2135:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;2136:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;2137:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;2138:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;2139: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2140:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2141:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2141; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;2142: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2143:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2144:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2144; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2145:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2145; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+2146:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2146; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+2147:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__13, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__13 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__13)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__13);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__13);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__14, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__14 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__14)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2147; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__14);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__14);
</pre><pre class='cython line score-0'>&#xA0;2148: </pre>
<pre class='cython line score-0'>&#xA0;2149:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2150:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2150; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+2151:     <span class="n">l1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2151; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_l1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2152:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2152; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;2153: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2154:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+2155:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2155; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2156:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2157:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2158:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2159:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2159; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0'>&#xA0;2160:             <span class="c"># reduced_windows[i] = np.random.randint(window)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2161:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+2162:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2162; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2163:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2163; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2164:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2164; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2165:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2166:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2167:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;2168: </pre>
<pre class='cython line score-0'>&#xA0;2169:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2170:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2171:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2172:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2173:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2174:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="c"># + reduced_windows[i]</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = (__pyx_v_i - __pyx_v_window);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2175:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2176:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2177:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window_r</span> <span class="o">+</span> <span class="mf">1</span> <span class="c"># - reduced_windows[i]</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = ((__pyx_v_i + __pyx_v_window_r) + 1);
</pre><pre class='cython line score-0'>&#xA0;2178: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2179:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2180:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0'>&#xA0;2181: </pre>
<pre class='cython line score-0'>&#xA0;2182: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2183:             <span class="n">memset</span><span class="p">(</span><span class="n">l1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>          memset(__pyx_v_l1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2184:             <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>          memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2185: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2186:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_hs != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2187:                 <span class="n">fast_sentence_cbow_average_simple_hs</span><span class="p">(</span><span class="n">_sentence_id</span> <span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span><span class="n">average_flag</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_hs(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), __pyx_v_codelens, __pyx_v_l1, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_doc, __pyx_v_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_average_flag);
            goto __pyx_L17;
          }
          __pyx_L17:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2188:             <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_negative != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2189:                 <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_cbow_average_simple_neg</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">next_random</span><span class="p">,</span><span class="n">average_flag</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_neg(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_codelens, __pyx_v_l1, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_doc, __pyx_v_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_next_random, __pyx_v_average_flag);
            goto __pyx_L18;
          }
          __pyx_L18:;
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;2190: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2191:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2191; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2192: </pre>
<pre class='cython line score-0'>&#xA0;2193: </pre>
<pre class='cython line score-0'>&#xA0;2194: </pre>
<pre class='cython line score-0'>&#xA0;2195: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2196: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_cbow_average_simple_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_simple_neg(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random, int __pyx_v_average_flag) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;2197:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2198:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2199:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2200:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2201: </pre>
<pre class='cython line score-0'>&#xA0;2202:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;2203:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2204:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;2205:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;2206:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;2207:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;2208: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2209:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;2210: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2211:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2212:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2213:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2214:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2215:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2216:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2217:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2218:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2219: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2220:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span>  <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0)) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2221:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2222:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2223: </pre>
<pre class='cython line score-0'>&#xA0;2224: </pre>
<pre class='cython line score-0'>&#xA0;2225:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2226:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2227:     <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0'>&#xA0;2228: </pre>
<pre class='cython line score-0'>&#xA0;2229: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2230:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0)) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 1) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2231:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2232:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;2233: </pre>
<pre class='cython line score-0'>&#xA0;2234: </pre>
<pre class='cython line score-0'>&#xA0;2235: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2236:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2237: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2238:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2239:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2240:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2241:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L18;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2242:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2243:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2244:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2245:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2246:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L16_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2247:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L18:;
</pre><pre class='cython line score-0'>&#xA0;2248: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2249:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;2250:         <span class="c"># f = &lt;REAL_t&gt;dsdot(&amp;size, neu1, &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2251:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;2252:             <span class="c"># continue</span></pre>
<pre class='cython line score-0'>&#xA0;2253:         <span class="c"># f = EXP_TABLE[&lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]</span></pre>
<pre class='cython line score-0'>&#xA0;2254: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2255:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2256:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;2257: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2258:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2259:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2260:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2261: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2262:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2263:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L23_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L23_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2264:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L20_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2265:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2266:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L20_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2267: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2268:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2269: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2270:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2271: </pre>
<pre class='cython line score-0'>&#xA0;2272: </pre>
<pre class='cython line score-0'>&#xA0;2273: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2274: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_cbow_average_simple_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_simple_neg(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random, int __pyx_v_average_flag) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;2275:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2276:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2277:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2278:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2279: </pre>
<pre class='cython line score-0'>&#xA0;2280:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;2281:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2282:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;2283:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;2284:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;2285:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;2286: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2287:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;2288: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2289:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2290:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2291:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2292:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2293:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2294:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2295:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2296: </pre>
<pre class='cython line score-0'>&#xA0;2297: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2298:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span>  <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2299:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2300:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2301: </pre>
<pre class='cython line score-0'>&#xA0;2302:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2303:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2304:     <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0'>&#xA0;2305: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2306:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L12_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 1) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L12_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2307:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2308:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;2309: </pre>
<pre class='cython line score-0'>&#xA0;2310: </pre>
<pre class='cython line score-0'>&#xA0;2311: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2312:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2313:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2314:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2315:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L16;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2316:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2317:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2318:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2319:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2320:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L14_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2321:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L16:;
</pre><pre class='cython line score-0'>&#xA0;2322: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2323:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;2324:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, l1, &amp;ONE, &amp;syn1neg[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2325:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;2326:             <span class="c"># continue</span></pre>
<pre class='cython line score-0'>&#xA0;2327:         <span class="c"># f = EXP_TABLE[&lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]</span></pre>
<pre class='cython line score-0'>&#xA0;2328: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2329:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2330:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;2331: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2332:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2333:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2334:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L14_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2335: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2336:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2337:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2338:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2339:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2340:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2341: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2342:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2343: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2344:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2345: </pre>
<pre class='cython line score-0'>&#xA0;2346: </pre>
<pre class='cython line score-0'>&#xA0;2347: </pre>
<pre class='cython line score-0'>&#xA0;2348: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2349: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_cbow_average_simple_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_simple_hs(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_l1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, int __pyx_v_average_flag) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;2350:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2351:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">l1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2352:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2353:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2354: </pre>
<pre class='cython line score-0'>&#xA0;2355:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;2356:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;2357:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;2358:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;2359: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2360:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2361:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2362:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2363:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2364:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2365:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2366:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2367: </pre>
<pre class='cython line score-0'>&#xA0;2368: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2369:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2370:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2371:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2372: </pre>
<pre class='cython line score-0'>&#xA0;2373:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2374:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2375:     <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0'>&#xA0;2376: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2377:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L12_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 1) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L12_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2378:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2379:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L11;
  }
  __pyx_L11:;
</pre><pre class='cython line score-0'>&#xA0;2380: </pre>
<pre class='cython line score-0'>&#xA0;2381: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2382:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2383:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;2384:         <span class="c"># f = &lt;REAL_t&gt;sdot(&amp;size, l1, &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2385:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;2386:             <span class="c"># continue</span></pre>
<pre class='cython line score-0'>&#xA0;2387:         <span class="c"># f = EXP_TABLE[&lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]</span></pre>
<pre class='cython line score-0'>&#xA0;2388: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2389:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2390:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;2391: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2392:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2393:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2394:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">l1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_l1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
  }
</pre><pre class='cython line score-0'>&#xA0;2395: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2396:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2397:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2398:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L16_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2399:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2400:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2401:     <span class="c"># add doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2402:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2403: </pre>
<pre class='cython line score-0'>&#xA0;2404: </pre>
<pre class='cython line score-0'>&#xA0;2405: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2406: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_cbow_average_simple_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_simple_hs(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, int __pyx_v_average_flag) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;2407:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2408:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2409:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2410:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="nb">int</span> <span class="n">average_flag</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2411: </pre>
<pre class='cython line score-0'>&#xA0;2412:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;2413:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;2414:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;2415:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0'>&#xA0;2416: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2417:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2418:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2419:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2420:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2421:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2422:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2423:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2424:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2425: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2426:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0)) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 0) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2427:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2428:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2429: </pre>
<pre class='cython line score-0'>&#xA0;2430:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2431:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2432:     <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0'>&#xA0;2433: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2434:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="o">==</span> <span class="mf">1</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span><span class="p">)</span> <span class="ow">and</span> <span class="n">average_flag</span> <span class="o">==</span> <span class="mf">1</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((__pyx_v_cbow_mean == 1) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0)) != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L13_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_average_flag == 1) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L13_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2435:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2436:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L12;
  }
  __pyx_L12:;
</pre><pre class='cython line score-0'>&#xA0;2437: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2438:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2439:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2440:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_size);
</pre><pre class='cython line score-0'>&#xA0;2441:         <span class="c"># f = &lt;REAL_t&gt;dsdot(&amp;size, neu1, &amp;ONE, &amp;syn1[row2], &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2442:         <span class="c"># if f &lt;= -MAX_EXP or f &gt;= MAX_EXP:</span></pre>
<pre class='cython line score-0'>&#xA0;2443:             <span class="c"># continue</span></pre>
<pre class='cython line score-0'>&#xA0;2444:         <span class="c"># f = EXP_TABLE[&lt;int&gt;((f + MAX_EXP) * (EXP_TABLE_SIZE / MAX_EXP / 2))]</span></pre>
<pre class='cython line score-0'>&#xA0;2445: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2446:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2447:         <span class="n">f</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="p">(</span><span class="mf">1.0</span> <span class="o">+</span> <span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">f</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (1.0 / (1.0 + exp((-__pyx_v_f))));
</pre><pre class='cython line score-0'>&#xA0;2448: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2449:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2450:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2451:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
  }
</pre><pre class='cython line score-0'>&#xA0;2452: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2453:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2454:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2455:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2456:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2457:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2458:     <span class="c"># add doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2459:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2460: </pre>
<pre class='cython line score-0'>&#xA0;2461: </pre>
<pre class='cython line score-0'>&#xA0;2462: </pre>
<pre class='cython line score-0'>&#xA0;2463: </pre>
<pre class='cython line score-0'>&#xA0;2464: </pre>
<pre class='cython line score-0'>&#xA0;2465: <span class="sd">&#39;&#39;&#39; cbow average plus doc&#39;&#39;&#39;</span></pre>
<pre class='cython line score-96' onclick='toggleDiv(this)'>+2466: <span class="k">def</span> <span class="nf">train_sentence_cbow_average_plus_doc</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">sentence_id</span><span class="p">,</span> <span class="n">sentence</span><span class="p">,</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">_work</span><span class="p">,</span> <span class="n">_neu1</span><span class="p">,</span> <span class="n">alpha_doc</span><span class="p">):</span></pre>
<pre class='cython code score-96'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_15train_sentence_cbow_average_plus_doc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds); /*proto*/
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_15train_sentence_cbow_average_plus_doc = {"train_sentence_cbow_average_plus_doc", (PyCFunction)__pyx_pw_22inner_paragraph_vector_15train_sentence_cbow_average_plus_doc, METH_VARARGS|METH_KEYWORDS, 0};
static PyObject *__pyx_pw_22inner_paragraph_vector_15train_sentence_cbow_average_plus_doc(PyObject *__pyx_self, PyObject *__pyx_args, PyObject *__pyx_kwds) {
  PyObject *__pyx_v_model = 0;
  PyObject *__pyx_v_sentence_id = 0;
  PyObject *__pyx_v_sentence = 0;
  PyObject *__pyx_v_alpha = 0;
  PyObject *__pyx_v__work = 0;
  PyObject *__pyx_v__neu1 = 0;
  PyObject *__pyx_v_alpha_doc = 0;
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_average_plus_doc (wrapper)", 0);
  {
    static PyObject **__pyx_pyargnames[] = {&amp;__pyx_n_s_model,&amp;__pyx_n_s_sentence_id,&amp;__pyx_n_s_sentence,&amp;__pyx_n_s_alpha,&amp;__pyx_n_s_work,&amp;__pyx_n_s_neu1,&amp;__pyx_n_s_alpha_doc,0};
    PyObject* values[7] = {0,0,0,0,0,0,0};
    if (unlikely(__pyx_kwds)) {
      Py_ssize_t kw_args;
      const Py_ssize_t pos_args = <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args);
      switch (pos_args) {
        case  7: values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
        case  6: values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
        case  5: values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
        case  4: values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
        case  3: values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
        case  2: values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
        case  1: values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
        case  0: break;
        default: goto __pyx_L5_argtuple_error;
      }
      kw_args = <span class='py_c_api'>PyDict_Size</span>(__pyx_kwds);
      switch (pos_args) {
        case  0:
        if (likely((values[0] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_model)) != 0)) kw_args--;
        else goto __pyx_L5_argtuple_error;
        case  1:
        if (likely((values[1] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence_id)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 1); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  2:
        if (likely((values[2] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_sentence)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 2); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  3:
        if (likely((values[3] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 3); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  4:
        if (likely((values[4] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_work)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 4); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  5:
        if (likely((values[5] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_neu1)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 5); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
        case  6:
        if (likely((values[6] = <span class='py_c_api'>PyDict_GetItem</span>(__pyx_kwds, __pyx_n_s_alpha_doc)) != 0)) kw_args--;
        else {
          <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, 6); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
        }
      }
      if (unlikely(kw_args &gt; 0)) {
        if (unlikely(<span class='pyx_c_api'>__Pyx_ParseOptionalKeywords</span>(__pyx_kwds, __pyx_pyargnames, 0, values, pos_args, "train_sentence_cbow_average_plus_doc") &lt; 0)) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
      }
    } else if (<span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args) != 7) {
      goto __pyx_L5_argtuple_error;
    } else {
      values[0] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 0);
      values[1] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 1);
      values[2] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 2);
      values[3] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 3);
      values[4] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 4);
      values[5] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 5);
      values[6] = <span class='py_macro_api'>PyTuple_GET_ITEM</span>(__pyx_args, 6);
    }
    __pyx_v_model = values[0];
    __pyx_v_sentence_id = values[1];
    __pyx_v_sentence = values[2];
    __pyx_v_alpha = values[3];
    __pyx_v__work = values[4];
    __pyx_v__neu1 = values[5];
    __pyx_v_alpha_doc = values[6];
  }
  goto __pyx_L4_argument_unpacking_done;
  __pyx_L5_argtuple_error:;
  <span class='pyx_c_api'>__Pyx_RaiseArgtupleInvalid</span>("train_sentence_cbow_average_plus_doc", 1, 7, 7, <span class='py_macro_api'>PyTuple_GET_SIZE</span>(__pyx_args)); <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L3_error;}</span>
  __pyx_L3_error:;
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_average_plus_doc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return NULL;
  __pyx_L4_argument_unpacking_done:;
  __pyx_r = __pyx_pf_22inner_paragraph_vector_14train_sentence_cbow_average_plus_doc(__pyx_self, __pyx_v_model, __pyx_v_sentence_id, __pyx_v_sentence, __pyx_v_alpha, __pyx_v__work, __pyx_v__neu1, __pyx_v_alpha_doc);
  int __pyx_lineno = 0;
  const char *__pyx_filename = NULL;
  int __pyx_clineno = 0;

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_14train_sentence_cbow_average_plus_doc(CYTHON_UNUSED PyObject *__pyx_self, PyObject *__pyx_v_model, PyObject *__pyx_v_sentence_id, PyObject *__pyx_v_sentence, PyObject *__pyx_v_alpha, PyObject *__pyx_v__work, PyObject *__pyx_v__neu1, PyObject *__pyx_v_alpha_doc) {
  int __pyx_v_hs;
  int __pyx_v_negative;
  int __pyx_v_cbow_mean;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha;
  CYTHON_UNUSED __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v__alpha_doc;
  int __pyx_v_size;
  int __pyx_v_doc_size;
  long __pyx_v__sentence_id;
  int __pyx_v_codelens[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_indexes[10000];
  __pyx_t_5numpy_uint32_t __pyx_v_reduced_windows[10000];
  int __pyx_v_sentence_len;
  int __pyx_v_window;
  int __pyx_v_i;
  int __pyx_v_j;
  int __pyx_v_k;
  long __pyx_v_result;
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1;
  __pyx_t_5numpy_uint32_t *__pyx_v_points[10000];
  __pyx_t_5numpy_uint8_t *__pyx_v_codes[10000];
  __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg;
  __pyx_t_5numpy_uint32_t *__pyx_v_table;
  unsigned PY_LONG_LONG __pyx_v_table_len;
  unsigned PY_LONG_LONG __pyx_v_next_random;
  PyObject *__pyx_v_word = NULL;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("train_sentence_cbow_average_plus_doc", 0);
/*  */
  /* function exit code */
  __pyx_L1_error:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_8);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_14);
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_t_15);
  <span class='pyx_c_api'>__Pyx_AddTraceback</span>("inner_paragraph_vector.train_sentence_cbow_average_plus_doc", __pyx_clineno, __pyx_lineno, __pyx_filename);
  __pyx_r = NULL;
  __pyx_L0:;
  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_v_word);
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__37 = <span class='py_c_api'>PyTuple_Pack</span>(36, __pyx_n_s_model, __pyx_n_s_sentence_id, __pyx_n_s_sentence, __pyx_n_s_alpha, __pyx_n_s_work, __pyx_n_s_neu1, __pyx_n_s_alpha_doc, __pyx_n_s_hs, __pyx_n_s_negative, __pyx_n_s_cbow_mean, __pyx_n_s_syn0, __pyx_n_s_doc, __pyx_n_s_work_2, __pyx_n_s_neu1_2, __pyx_n_s_alpha_2, __pyx_n_s_alpha_doc_2, __pyx_n_s_size, __pyx_n_s_doc_size, __pyx_n_s_sentence_id_2, __pyx_n_s_codelens, __pyx_n_s_indexes, __pyx_n_s_reduced_windows, __pyx_n_s_sentence_len, __pyx_n_s_window, __pyx_n_s_i, __pyx_n_s_j, __pyx_n_s_k, __pyx_n_s_result, __pyx_n_s_syn1, __pyx_n_s_points, __pyx_n_s_codes, __pyx_n_s_syn1neg, __pyx_n_s_table, __pyx_n_s_table_len, __pyx_n_s_next_random, __pyx_n_s_word);<span class='error_goto'> if (unlikely(!__pyx_tuple__37)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__37);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__37);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_15train_sentence_cbow_average_plus_doc, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_train_sentence_cbow_average_plus, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_codeobj__38 = (PyObject*)<span class='pyx_c_api'>__Pyx_PyCode_New</span>(7, 0, 36, 0, 0, __pyx_empty_bytes, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_tuple__37, __pyx_empty_tuple, __pyx_empty_tuple, __pyx_kp_s_Users_satomotoki_research_NACTE, __pyx_n_s_train_sentence_cbow_average_plus, 2466, __pyx_empty_bytes);<span class='error_goto'> if (unlikely(!__pyx_codeobj__38)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2466; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2467:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">hs</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">hs</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_hs);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2467; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_hs = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2468:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">negative</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">negative</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_negative);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2468; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_negative = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2469:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">cbow_mean</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">cbow_mean</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_cbow_mean);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2469; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_cbow_mean = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2470: </pre>
<pre class='cython line score-0'>&#xA0;2471: </pre>
<pre class='cython line score-6' onclick='toggleDiv(this)'>+2472:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn0</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn0</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn0);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2472; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_syn0 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2473:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">doc</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">doc</span><span class="p">))</span></pre>
<pre class='cython code score-6'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2473; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_doc = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;2474:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">work</span></pre>
<pre class='cython line score-0'>&#xA0;2475:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">neu1</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+2476:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha</span> <span class="o">=</span> <span class="n">alpha</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2476; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2477:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">_alpha_doc</span> <span class="o">=</span> <span class="n">alpha_doc</span></pre>
<pre class='cython code score-5'>  __pyx_t_3 = __pyx_<span class='py_c_api'>PyFloat_AsFloat</span>(__pyx_v_alpha_doc);<span class='error_goto'> if (unlikely((__pyx_t_3 == (npy_float32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2477; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v__alpha_doc = __pyx_t_3;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2478:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">layer1_size</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_layer1_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2478; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_size = __pyx_t_2;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2479:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">doc_size</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">doc_vec_size</span> <span class="c"># add</span></pre>
<pre class='cython code score-5'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_doc_vec_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2479; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_v_doc_size = __pyx_t_2;
</pre><pre class='cython line score-11' onclick='toggleDiv(this)'>+2480:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">_sentence_id</span> <span class="o">=</span> <span class="n">sentence_id</span><span class="o">*</span><span class="n">doc_size</span><span class="c"># add</span></pre>
<pre class='cython code score-11'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_doc_size);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_v_sentence_id, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
  __pyx_t_5 = <span class='pyx_c_api'>__Pyx_PyInt_As_long</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_5 == (long)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2480; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v__sentence_id = __pyx_t_5;
</pre><pre class='cython line score-0'>&#xA0;2481: </pre>
<pre class='cython line score-0'>&#xA0;2482:     <span class="k">cdef</span> <span class="kt">int</span> <span class="kt">codelens</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2483:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">indexes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2484:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="kt">reduced_windows</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2485:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">sentence_len</span></pre>
<pre class='cython line score-5' onclick='toggleDiv(this)'>+2486:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">window</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">window</span></pre>
<pre class='cython code score-5'>  __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_window);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_PyInt_As_int</span>(__pyx_t_4);<span class='error_goto'> if (unlikely((__pyx_t_2 == (int)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2486; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
  __pyx_v_window = __pyx_t_2;
</pre><pre class='cython line score-0'>&#xA0;2487: </pre>
<pre class='cython line score-0'>&#xA0;2488:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span><span class="p">,</span> <span class="nf">j</span><span class="p">,</span> <span class="nf">k</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2489:     <span class="k">cdef</span> <span class="kt">long</span> <span class="nf">result</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>  __pyx_v_result = 0;
</pre><pre class='cython line score-0'>&#xA0;2490: </pre>
<pre class='cython line score-0'>&#xA0;2491:     <span class="c"># For hierarchical softmax</span></pre>
<pre class='cython line score-0'>&#xA0;2492:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1</span></pre>
<pre class='cython line score-0'>&#xA0;2493:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="kt">points</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2494:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint8_t</span> *<span class="kt">codes</span>[<span class="kt">MAX_SENTENCE_LEN</span>]</pre>
<pre class='cython line score-0'>&#xA0;2495: </pre>
<pre class='cython line score-0'>&#xA0;2496:     <span class="c"># For negative sampling</span></pre>
<pre class='cython line score-0'>&#xA0;2497:     <span class="k">cdef</span> <span class="kt">REAL_t</span> *<span class="nf">syn1neg</span></pre>
<pre class='cython line score-0'>&#xA0;2498:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> *<span class="nf">table</span></pre>
<pre class='cython line score-0'>&#xA0;2499:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">table_len</span></pre>
<pre class='cython line score-0'>&#xA0;2500:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">next_random</span></pre>
<pre class='cython line score-0'>&#xA0;2501: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2502:     <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_hs != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2503:         <span class="n">syn1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2503; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    goto __pyx_L3;
  }
  __pyx_L3:;
</pre><pre class='cython line score-0'>&#xA0;2504: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2505:     <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  __pyx_t_6 = (__pyx_v_negative != 0);
  if (__pyx_t_6) {
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2506:         <span class="n">syn1neg</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">syn1neg</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_syn1neg);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2506; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_syn1neg = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2507:         <span class="n">table</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">))</span></pre>
<pre class='cython code score-6'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    if (!(likely(((__pyx_t_4) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_4, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2507; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    __pyx_v_table = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_4)));
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+2508:         <span class="n">table_len</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">table</span><span class="p">)</span></pre>
<pre class='cython code score-8'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_model, __pyx_n_s_table);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_4);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2508; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_v_table_len = __pyx_t_7;
</pre><pre class='cython line score-48' onclick='toggleDiv(this)'>+2509:         <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mf">0</span><span class="p">,</span> <span class="mf">2</span><span class="o">**</span><span class="mf">24</span><span class="p">)</span></pre>
<pre class='cython code score-48'>    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_4, __pyx_tuple__15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    __pyx_t_4 = <span class='py_c_api'>PyNumber_Multiply</span>(__pyx_int_16777216, __pyx_t_1);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_1, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
/*  */
  __pyx_tuple__15 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__15);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__15);
    __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_1, __pyx_tuple__16, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_t_1 = <span class='py_c_api'>PyNumber_Add</span>(__pyx_t_4, __pyx_t_8);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
    __pyx_t_9 = <span class='pyx_c_api'>__Pyx_PyInt_As_unsigned_PY_LONG_LONG</span>(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_9 == (unsigned PY_LONG_LONG)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
    __pyx_v_next_random = __pyx_t_9;
    goto __pyx_L4;
  }
  __pyx_L4:;
  __pyx_tuple__16 = <span class='py_c_api'>PyTuple_Pack</span>(2, __pyx_int_0, __pyx_int_16777216);<span class='error_goto'> if (unlikely(!__pyx_tuple__16)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2509; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__16);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__16);
</pre><pre class='cython line score-0'>&#xA0;2510: </pre>
<pre class='cython line score-0'>&#xA0;2511:     <span class="c"># convert Python structures to primitive types, so we can release the GIL</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2512:     <span class="n">work</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_work</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__work) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__work, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2512; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_work = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__work)));
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+2513:     <span class="n">neu1</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">_neu1</span><span class="p">)</span></pre>
<pre class='cython code score-3'>  if (!(likely(((__pyx_v__neu1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_v__neu1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2513; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_v_neu1 = ((__pyx_t_22inner_paragraph_vector_REAL_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_v__neu1)));
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2514:     <span class="n">sentence_len</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">min</span><span class="p">(</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">sentence</span><span class="p">))</span></pre>
<pre class='cython code score-5'>  __pyx_t_7 = <span class='py_c_api'>PyObject_Length</span>(__pyx_v_sentence);<span class='error_goto'> if (unlikely(__pyx_t_7 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2514; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  __pyx_t_5 = 10000;
  if (((__pyx_t_7 &lt; __pyx_t_5) != 0)) {
    __pyx_t_10 = __pyx_t_7;
  } else {
    __pyx_t_10 = __pyx_t_5;
  }
  __pyx_v_sentence_len = ((int)__pyx_t_10);
</pre><pre class='cython line score-0'>&#xA0;2515: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2516:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_2 = __pyx_v_sentence_len;
  for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
    __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-3' onclick='toggleDiv(this)'>+2517:         <span class="n">word</span> <span class="o">=</span> <span class="n">sentence</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-3'>    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetItemInt</span>(__pyx_v_sentence, __pyx_v_i, int, 1, __Pyx_PyInt_From_int, 0, 0, 0);<span class='error_goto'> if (unlikely(__pyx_t_1 == NULL)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2517; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>;
    <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
    <span class='pyx_macro_api'>__Pyx_XDECREF_SET</span>(__pyx_v_word, __pyx_t_1);
    __pyx_t_1 = 0;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2518:         <span class="k">if</span> <span class="n">word</span> <span class="ow">is</span> <span class="bp">None</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_6 = (__pyx_v_word == Py_None);
    __pyx_t_12 = (__pyx_t_6 != 0);
    if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2519:             <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>      (__pyx_v_codelens[__pyx_v_i]) = 0;
      goto __pyx_L7;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2520:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2521:             <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">word</span><span class="o">.</span><span class="n">index</span></pre>
<pre class='cython code score-3'>      __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_index);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2521; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_indexes[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-35' onclick='toggleDiv(this)'>+2522:             <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="n">window</span><span class="p">)</span></pre>
<pre class='cython code score-35'>      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_np);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_8, __pyx_n_s_random);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_8 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_t_4, __pyx_n_s_randint);<span class='error_goto'> if (unlikely(!__pyx_t_8)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_8);
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
      __pyx_t_4 = <span class='pyx_c_api'>__Pyx_PyInt_From_int</span>(__pyx_v_window);<span class='error_goto'> if (unlikely(!__pyx_t_4)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_4);
      __pyx_t_14 = NULL;
      if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; likely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_8))) {
        __pyx_t_14 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_8);
        if (likely(__pyx_t_14)) {
          PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_8);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_14);
          <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
          <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_8, function);
        }
      }
      if (!__pyx_t_14) {
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_8, __pyx_t_4);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_4); __pyx_t_4 = 0;
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
      } else {
        __pyx_t_15 = <span class='py_c_api'>PyTuple_New</span>(1+1);<span class='error_goto'> if (unlikely(!__pyx_t_15)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_15);
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0, __pyx_t_14); <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_14); __pyx_t_14 = NULL;
        <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_15, 0+1, __pyx_t_4);
        <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_4);
        __pyx_t_4 = 0;
        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_Call</span>(__pyx_t_8, __pyx_t_15, NULL);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_15); __pyx_t_15 = 0;
      }
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_8); __pyx_t_8 = 0;
      __pyx_t_13 = __Pyx_PyInt_As_npy_uint32(__pyx_t_1);<span class='error_goto'> if (unlikely((__pyx_t_13 == (npy_uint32)-1) &amp;&amp; PyErr_Occurred())) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2522; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
      <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
      (__pyx_v_reduced_windows[__pyx_v_i]) = __pyx_t_13;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2523:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_12 = (__pyx_v_hs != 0);
      if (__pyx_t_12) {
</pre><pre class='cython line score-8' onclick='toggleDiv(this)'>+2524:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">int</span><span class="p">&gt;</span><span class="nb">len</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-8'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        __pyx_t_10 = <span class='py_c_api'>PyObject_Length</span>(__pyx_t_1);<span class='error_goto'> if (unlikely(__pyx_t_10 == -1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2524; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        (__pyx_v_codelens[__pyx_v_i]) = ((int)__pyx_t_10);
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2525:                 <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">code</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_code);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2525; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_codes[__pyx_v_i]) = ((__pyx_t_5numpy_uint8_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-6' onclick='toggleDiv(this)'>+2526:                 <span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*&gt;</span><span class="n">np</span><span class="o">.</span><span class="n">PyArray_DATA</span><span class="p">(</span><span class="n">word</span><span class="o">.</span><span class="n">point</span><span class="p">)</span></pre>
<pre class='cython code score-6'>        __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_GetAttrStr</span>(__pyx_v_word, __pyx_n_s_point);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
        if (!(likely(((__pyx_t_1) == Py_None) || likely(<span class='pyx_c_api'>__Pyx_TypeTest</span>(__pyx_t_1, __pyx_ptype_5numpy_ndarray))))) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2526; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
        (__pyx_v_points[__pyx_v_i]) = ((__pyx_t_5numpy_uint32_t *)<span class='py_macro_api'>PyArray_DATA</span>(((PyArrayObject *)__pyx_t_1)));
        <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
        goto __pyx_L8;
      }
      /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2527:             <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2528:                 <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>        (__pyx_v_codelens[__pyx_v_i]) = 1;
      }
      __pyx_L8:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2529:             <span class="n">result</span> <span class="o">+=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>      __pyx_v_result = (__pyx_v_result + 1);
    }
    __pyx_L7:;
  }
</pre><pre class='cython line score-0'>&#xA0;2530: </pre>
<pre class='cython line score-0'>&#xA0;2531:     <span class="c"># release GIL &amp; train on the sentence</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2532:     <span class="k">with</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython code score-0'>  {
      #ifdef WITH_THREAD
      PyThreadState *_save;
      Py_UNBLOCK_THREADS
      #endif
      /*try:*/ {
/*  */
      /*finally:*/ {
        /*normal exit:*/{
          #ifdef WITH_THREAD
          Py_BLOCK_THREADS
          #endif
          goto __pyx_L11;
        }
        __pyx_L11:;
      }
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2533:         <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">sentence_len</span><span class="p">):</span></pre>
<pre class='cython code score-0'>        __pyx_t_2 = __pyx_v_sentence_len;
        for (__pyx_t_11 = 0; __pyx_t_11 &lt; __pyx_t_2; __pyx_t_11+=1) {
          __pyx_v_i = __pyx_t_11;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2534:             <span class="k">if</span> <span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (((__pyx_v_codelens[__pyx_v_i]) == 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2535:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>            goto __pyx_L12_continue;
          }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2536:             <span class="n">j</span> <span class="o">=</span> <span class="n">i</span> <span class="o">-</span> <span class="n">window</span> <span class="o">+</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_j = ((__pyx_v_i - __pyx_v_window) + (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2537:             <span class="k">if</span> <span class="n">j</span> <span class="o">&lt;</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_j &lt; 0) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2538:                 <span class="n">j</span> <span class="o">=</span> <span class="mf">0</span></pre>
<pre class='cython code score-0'>            __pyx_v_j = 0;
            goto __pyx_L15;
          }
          __pyx_L15:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2539:             <span class="n">k</span> <span class="o">=</span> <span class="n">i</span> <span class="o">+</span> <span class="n">window</span> <span class="o">+</span> <span class="mf">1</span> <span class="o">-</span> <span class="n">reduced_windows</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>          __pyx_v_k = (((__pyx_v_i + __pyx_v_window) + 1) - (__pyx_v_reduced_windows[__pyx_v_i]));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2540:             <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="n">sentence_len</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = ((__pyx_v_k &gt; __pyx_v_sentence_len) != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2541:                 <span class="n">k</span> <span class="o">=</span> <span class="n">sentence_len</span></pre>
<pre class='cython code score-0'>            __pyx_v_k = __pyx_v_sentence_len;
            goto __pyx_L16;
          }
          __pyx_L16:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2542:             <span class="k">if</span> <span class="n">hs</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_hs != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2543:                 <span class="n">fast_sentence_cbow_average_plus_doc_hs</span><span class="p">(</span><span class="n">_sentence_id</span> <span class="p">,</span><span class="n">points</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codes</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span> <span class="n">doc_size</span><span class="p">,</span><span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_hs(__pyx_v__sentence_id, (__pyx_v_points[__pyx_v_i]), (__pyx_v_codes[__pyx_v_i]), __pyx_v_codelens, __pyx_v_neu1, __pyx_v_syn0, __pyx_v_syn1, __pyx_v_doc, __pyx_v_size, __pyx_v_doc_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean);
            goto __pyx_L17;
          }
          __pyx_L17:;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2544:             <span class="k">if</span> <span class="n">negative</span><span class="p">:</span></pre>
<pre class='cython code score-0'>          __pyx_t_12 = (__pyx_v_negative != 0);
          if (__pyx_t_12) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2545:                 <span class="n">next_random</span> <span class="o">=</span> <span class="n">fast_sentence_cbow_average_plus_doc_neg</span><span class="p">(</span><span class="n">_sentence_id</span><span class="p">,</span><span class="n">negative</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="n">table_len</span><span class="p">,</span> <span class="n">codelens</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="n">syn0</span><span class="p">,</span> <span class="n">syn1neg</span><span class="p">,</span> <span class="n">doc</span><span class="p">,</span> <span class="n">size</span><span class="p">,</span><span class="n">doc_size</span><span class="p">,</span> <span class="n">indexes</span><span class="p">,</span> <span class="n">_alpha</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">,</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">next_random</span><span class="p">)</span></pre>
<pre class='cython code score-0'>            __pyx_v_next_random = __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_neg(__pyx_v__sentence_id, __pyx_v_negative, __pyx_v_table, __pyx_v_table_len, __pyx_v_codelens, __pyx_v_neu1, __pyx_v_syn0, __pyx_v_syn1neg, __pyx_v_doc, __pyx_v_size, __pyx_v_doc_size, __pyx_v_indexes, __pyx_v__alpha, __pyx_v_work, __pyx_v_i, __pyx_v_j, __pyx_v_k, __pyx_v_cbow_mean, __pyx_v_next_random);
            goto __pyx_L18;
          }
          __pyx_L18:;
          __pyx_L12_continue:;
        }
      }
</pre><pre class='cython line score-0'>&#xA0;2546: </pre>
<pre class='cython line score-3' onclick='toggleDiv(this)'>+2547:     <span class="k">return</span> <span class="n">result</span></pre>
<pre class='cython code score-3'>  <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyInt_From_long</span>(__pyx_v_result);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2547; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_r = __pyx_t_1;
  __pyx_t_1 = 0;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2548: </pre>
<pre class='cython line score-0'>&#xA0;2549: </pre>
<pre class='cython line score-0'>&#xA0;2550: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2551: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence0_cbow_average_plus_doc_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_plus_doc_hs(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
  int __pyx_v_neu1_size;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;2552:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2553:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2554:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2555:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span><span class="c">#nogil</span></pre>
<pre class='cython line score-0'>&#xA0;2556: </pre>
<pre class='cython line score-0'>&#xA0;2557:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;2558:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;2559:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;2560:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2561:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">neu1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_neu1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;2562:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">iii</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2563:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2564: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2565:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2566:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2567:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2568:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2569:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2570:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2571:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2572: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2573:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2574:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2575:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2576:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2577:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">neu1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_neu1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2578:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2579: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2580:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2581:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">neu1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_neu1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2582:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2583:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2584:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2585:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2586:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2587:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2588:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2589: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2590:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2591:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2592:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L16_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2593:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2594:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2595:     <span class="c"># add doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2596:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2597: </pre>
<pre class='cython line score-0'>&#xA0;2598: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2599: <span class="k">cdef</span> <span class="kt">void</span> <span class="nf">fast_sentence1_cbow_average_plus_doc_hs</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static void __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_plus_doc_hs(long const __pyx_v_sentence_id, __pyx_t_5numpy_uint32_t const *__pyx_v_word_point, __pyx_t_5numpy_uint8_t const *__pyx_v_word_code, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean) {
  PY_LONG_LONG __pyx_v_b;
  PY_LONG_LONG __pyx_v_row2;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  int __pyx_v_m;
  int __pyx_v_neu1_size;
/*  */
  /* function exit code */
}
</pre><pre class='cython line score-0'>&#xA0;2600:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">word_point</span><span class="p">,</span> <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8_t</span> <span class="o">*</span><span class="n">word_code</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2601:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2602:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2603:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span><span class="c">#nogil</span></pre>
<pre class='cython line score-0'>&#xA0;2604: </pre>
<pre class='cython line score-0'>&#xA0;2605:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span><span class="p">,</span> <span class="nf">b</span></pre>
<pre class='cython line score-0'>&#xA0;2606:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0'>&#xA0;2607:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span></pre>
<pre class='cython line score-0'>&#xA0;2608:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2609:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">neu1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_neu1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;2610:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">iii</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2611:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2612: </pre>
<pre class='cython line score-0'>&#xA0;2613:     <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2614: </pre>
<pre class='cython line score-0'>&#xA0;2615:     <span class="c"># for iii in range(neu1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;2616:     <span class="c">#     print neu1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;2617: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2618:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2619:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2620:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2621:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2622:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2623:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2624:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2625: </pre>
<pre class='cython line score-0'>&#xA0;2626: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2627:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2628:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2629:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2630: </pre>
<pre class='cython line score-0'>&#xA0;2631:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0'>&#xA0;2632:     <span class="c"># saxpy(&amp;size, &amp;ONEF, &amp;doc[sentence_id], &amp;ONE, neu1, &amp;ONE)</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2633:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">neu1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_neu1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2634:     <span class="c"># count += ONEF</span></pre>
<pre class='cython line score-0'>&#xA0;2635:     <span class="c"># print &quot;\nNEW\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2636:     <span class="c"># for iii in range(neu1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;2637:     <span class="c">#     print neu1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;2638:     <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2639: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2640:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2641: </pre>
<pre class='cython line score-0'>&#xA0;2642:     <span class="c"># print &quot;\nNEW\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2643:     <span class="c"># for iii in range(neu1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;2644:     <span class="c">#     print neu1[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;2645:     <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2646: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2647:     <span class="k">for</span> <span class="n">b</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">codelens</span><span class="p">[</span><span class="n">i</span><span class="p">]):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = (__pyx_v_codelens[__pyx_v_i]);
  for (__pyx_t_5 = 0; __pyx_t_5 &lt; __pyx_t_1; __pyx_t_5+=1) {
    __pyx_v_b = __pyx_t_5;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2648:         <span class="n">row2</span> <span class="o">=</span> <span class="n">word_point</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">*</span> <span class="n">neu1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = ((__pyx_v_word_point[__pyx_v_b]) * __pyx_v_neu1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2649:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2650:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L14_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L14_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2651:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2652:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2653:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="mf">1</span> <span class="o">-</span> <span class="n">word_code</span><span class="p">[</span><span class="n">b</span><span class="p">]</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = (((1 - (__pyx_v_word_code[__pyx_v_b])) - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2654:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2655:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2656: </pre>
<pre class='cython line score-0'>&#xA0;2657: </pre>
<pre class='cython line score-0'>&#xA0;2658:     <span class="c"># print &quot;\n work \n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2659:     <span class="c"># for iii in range(neu1_size):</span></pre>
<pre class='cython line score-0'>&#xA0;2660:     <span class="c">#     print work[iii],</span></pre>
<pre class='cython line score-0'>&#xA0;2661:     <span class="c"># print &quot;\n&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2662: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2663:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2664:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L19_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L19_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2665:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L16_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2666:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2667:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L16_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2668:     <span class="c"># add doc</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2669:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2670: </pre>
<pre class='cython line score-0'>&#xA0;2671: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2672: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence0_cbow_average_plus_doc_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_plus_doc_neg(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  int __pyx_v_neu1_size;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;2673:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2674:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2675:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2676:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2677: </pre>
<pre class='cython line score-0'>&#xA0;2678:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;2679:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2680:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;2681:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;2682:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;2683:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2684:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">neu1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_neu1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;2685: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2686:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;2687: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2688:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2689:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2690:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2691:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2692:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2693:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2694:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2695:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2696: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2697:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2698:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2699:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2700: </pre>
<pre class='cython line score-0'>&#xA0;2701:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2702:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">neu1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_neu1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2703:     <span class="c"># saxpy(&amp;size, &amp;ONEF, &amp;doc[sentence_id], &amp;ONE, neu1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2704:     <span class="c"># count += ONEF</span></pre>
<pre class='cython line score-0'>&#xA0;2705: </pre>
<pre class='cython line score-0'>&#xA0;2706: </pre>
<pre class='cython line score-0'>&#xA0;2707: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2708:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2709: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2710:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2711:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2712:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2713:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2714:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2715:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2716:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2717:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2718:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L11_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2719:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;2720: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2721:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">neu1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_neu1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2722:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_neu1_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2723:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2724:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2725:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2726:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2727:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2728:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2729: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2730:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2731:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2732:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2733:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2734:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2735: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2736:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2737: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2738:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2739: </pre>
<pre class='cython line score-0'>&#xA0;2740: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2741: <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">fast_sentence1_cbow_average_plus_doc_neg</span><span class="p">(</span></pre>
<pre class='cython code score-0'>static unsigned PY_LONG_LONG __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_plus_doc_neg(long const __pyx_v_sentence_id, int const __pyx_v_negative, __pyx_t_5numpy_uint32_t *__pyx_v_table, unsigned PY_LONG_LONG __pyx_v_table_len, int *__pyx_v_codelens, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_neu1, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn0, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_syn1neg, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_doc, int const __pyx_v_size, int const __pyx_v_doc_size, __pyx_t_5numpy_uint32_t const *__pyx_v_indexes, __pyx_t_22inner_paragraph_vector_REAL_t const __pyx_v_alpha, __pyx_t_22inner_paragraph_vector_REAL_t *__pyx_v_work, int __pyx_v_i, int __pyx_v_j, int __pyx_v_k, int __pyx_v_cbow_mean, unsigned PY_LONG_LONG __pyx_v_next_random) {
  PY_LONG_LONG __pyx_v_row2;
  unsigned PY_LONG_LONG __pyx_v_modulo;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_f;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_g;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_inv_count;
  __pyx_t_22inner_paragraph_vector_REAL_t __pyx_v_label;
  __pyx_t_5numpy_uint32_t __pyx_v_target_index;
  __pyx_t_5numpy_uint32_t __pyx_v_word_index;
  int __pyx_v_d;
  int __pyx_v_m;
  int __pyx_v_neu1_size;
  unsigned PY_LONG_LONG __pyx_r;
/*  */
  /* function exit code */
  __pyx_L0:;
  return __pyx_r;
}
</pre><pre class='cython line score-0'>&#xA0;2742:     <span class="n">const</span> <span class="nb">long</span> <span class="n">sentence_id</span><span class="p">,</span><span class="n">const</span> <span class="nb">int</span> <span class="n">negative</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="o">*</span><span class="n">table</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">table_len</span><span class="p">,</span> <span class="nb">int</span> <span class="n">codelens</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span></pre>
<pre class='cython line score-0'>&#xA0;2743:     <span class="n">REAL_t</span> <span class="o">*</span><span class="n">neu1</span><span class="p">,</span>  <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn0</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">syn1neg</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">doc</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">size</span><span class="p">,</span> <span class="n">const</span> <span class="nb">int</span> <span class="n">doc_size</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2744:     <span class="n">const</span> <span class="n">np</span><span class="o">.</span><span class="n">uint32_t</span> <span class="n">indexes</span><span class="p">[</span><span class="n">MAX_SENTENCE_LEN</span><span class="p">],</span> <span class="n">const</span> <span class="n">REAL_t</span> <span class="n">alpha</span><span class="p">,</span> <span class="n">REAL_t</span> <span class="o">*</span><span class="n">work</span><span class="p">,</span></pre>
<pre class='cython line score-0'>&#xA0;2745:     <span class="nb">int</span> <span class="n">i</span><span class="p">,</span> <span class="nb">int</span> <span class="n">j</span><span class="p">,</span> <span class="nb">int</span> <span class="n">k</span><span class="p">,</span> <span class="nb">int</span> <span class="n">cbow_mean</span><span class="p">,</span> <span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span> <span class="n">next_random</span><span class="p">)</span> <span class="k">nogil</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2746:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">a</span></pre>
<pre class='cython line score-0'>&#xA0;2747:     <span class="k">cdef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">row2</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2748:     <span class="k">cdef</span> <span class="kt">unsigned</span> <span class="kt">long</span> <span class="kt">long</span> <span class="nf">modulo</span> <span class="o">=</span> <span class="mf">281474976710655</span><span class="n">ULL</span></pre>
<pre class='cython code score-0'>  __pyx_v_modulo = 281474976710655ULL;
</pre><pre class='cython line score-0'>&#xA0;2749:     <span class="k">cdef</span> <span class="kt">REAL_t</span> <span class="nf">f</span><span class="p">,</span> <span class="nf">g</span><span class="p">,</span> <span class="nf">count</span><span class="p">,</span> <span class="nf">inv_count</span><span class="p">,</span> <span class="nf">label</span></pre>
<pre class='cython line score-0'>&#xA0;2750:     <span class="k">cdef</span> <span class="kt">np</span>.<span class="kt">uint32_t</span> <span class="nf">target_index</span><span class="p">,</span> <span class="nf">word_index</span></pre>
<pre class='cython line score-0'>&#xA0;2751:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">d</span><span class="p">,</span> <span class="nf">m</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2752:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">neu1_size</span> <span class="o">=</span> <span class="n">size</span><span class="o">+</span><span class="n">doc_size</span></pre>
<pre class='cython code score-0'>  __pyx_v_neu1_size = (__pyx_v_size + __pyx_v_doc_size);
</pre><pre class='cython line score-0'>&#xA0;2753: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2754:     <span class="n">word_index</span> <span class="o">=</span> <span class="n">indexes</span><span class="p">[</span><span class="n">i</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_v_word_index = (__pyx_v_indexes[__pyx_v_i]);
</pre><pre class='cython line score-0'>&#xA0;2755: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2756:     <span class="n">memset</span><span class="p">(</span><span class="n">neu1</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_neu1, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2757:     <span class="n">count</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>  __pyx_v_count = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2758:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span> <span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2759:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L6_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L6_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2760:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L3_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2761:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2762:             <span class="n">count</span> <span class="o">+=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_count = (__pyx_v_count + __pyx_v_22inner_paragraph_vector_ONEF);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2763:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">*</span> <span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L3_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2764: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2765:     <span class="k">if</span> <span class="n">cbow_mean</span> <span class="ow">and</span> <span class="n">count</span> <span class="o">&gt;</span> <span class="p">(</span><span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.5</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = (__pyx_v_cbow_mean != 0);
  if (__pyx_t_4) {
  } else {
    __pyx_t_3 = __pyx_t_4;
    goto __pyx_L9_bool_binop_done;
  }
  __pyx_t_4 = ((__pyx_v_count &gt; ((__pyx_t_22inner_paragraph_vector_REAL_t)0.5)) != 0);
  __pyx_t_3 = __pyx_t_4;
  __pyx_L9_bool_binop_done:;
  if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2766:         <span class="n">inv_count</span> <span class="o">=</span> <span class="n">ONEF</span><span class="o">/</span><span class="n">count</span></pre>
<pre class='cython code score-0'>    __pyx_v_inv_count = (__pyx_v_22inner_paragraph_vector_ONEF / __pyx_v_count);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2767:         <span class="n">sscal</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">inv_count</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_sscal((&amp;__pyx_v_size), (&amp;__pyx_v_inv_count), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    goto __pyx_L8;
  }
  __pyx_L8:;
</pre><pre class='cython line score-0'>&#xA0;2768: </pre>
<pre class='cython line score-0'>&#xA0;2769:     <span class="c"># doc add</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2770:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">neu1</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_neu1[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2771:     <span class="c"># saxpy(&amp;size, &amp;ONEF, &amp;doc[sentence_id], &amp;ONE, neu1, &amp;ONE)</span></pre>
<pre class='cython line score-0'>&#xA0;2772:     <span class="c"># count += ONEF</span></pre>
<pre class='cython line score-0'>&#xA0;2773: </pre>
<pre class='cython line score-0'>&#xA0;2774: </pre>
<pre class='cython line score-0'>&#xA0;2775: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2776:     <span class="n">memset</span><span class="p">(</span><span class="n">work</span><span class="p">,</span> <span class="mf">0</span><span class="p">,</span> <span class="n">neu1_size</span> <span class="o">*</span> <span class="n">cython</span><span class="o">.</span><span class="n">sizeof</span><span class="p">(</span><span class="n">REAL_t</span><span class="p">))</span></pre>
<pre class='cython code score-0'>  memset(__pyx_v_work, 0, (__pyx_v_neu1_size * (sizeof(__pyx_t_22inner_paragraph_vector_REAL_t))));
</pre><pre class='cython line score-0'>&#xA0;2777: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2778:     <span class="k">for</span> <span class="n">d</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">negative</span><span class="o">+</span><span class="mf">1</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_5 = (__pyx_v_negative + 1);
  for (__pyx_t_1 = 0; __pyx_t_1 &lt; __pyx_t_5; __pyx_t_1+=1) {
    __pyx_v_d = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2779:         <span class="k">if</span> <span class="n">d</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_3 = ((__pyx_v_d == 0) != 0);
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2780:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">word_index</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = __pyx_v_word_index;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2781:             <span class="n">label</span> <span class="o">=</span> <span class="n">ONEF</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = __pyx_v_22inner_paragraph_vector_ONEF;
      goto __pyx_L13;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2782:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2783:             <span class="n">target_index</span> <span class="o">=</span> <span class="n">table</span><span class="p">[(</span><span class="n">next_random</span> <span class="o">&gt;&gt;</span> <span class="mf">16</span><span class="p">)</span> <span class="o">%</span> <span class="n">table_len</span><span class="p">]</span></pre>
<pre class='cython code score-0'>      __pyx_v_target_index = (__pyx_v_table[((__pyx_v_next_random &gt;&gt; 16) % __pyx_v_table_len)]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2784:             <span class="n">next_random</span> <span class="o">=</span> <span class="p">(</span><span class="n">next_random</span> <span class="o">*</span> <span class="o">&lt;</span><span class="n">unsigned</span> <span class="nb">long</span> <span class="nb">long</span><span class="o">&gt;</span><span class="mf">25214903917</span><span class="n">ULL</span> <span class="o">+</span> <span class="mf">11</span><span class="p">)</span> <span class="o">&amp;</span> <span class="n">modulo</span></pre>
<pre class='cython code score-0'>      __pyx_v_next_random = (((__pyx_v_next_random * ((unsigned PY_LONG_LONG)25214903917ULL)) + 11) &amp; __pyx_v_modulo);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2785:             <span class="k">if</span> <span class="n">target_index</span> <span class="o">==</span> <span class="n">word_index</span><span class="p">:</span></pre>
<pre class='cython code score-0'>      __pyx_t_3 = ((__pyx_v_target_index == __pyx_v_word_index) != 0);
      if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2786:                 <span class="k">continue</span></pre>
<pre class='cython code score-0'>        goto __pyx_L11_continue;
      }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2787:             <span class="n">label</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="mf">0.0</span></pre>
<pre class='cython code score-0'>      __pyx_v_label = ((__pyx_t_22inner_paragraph_vector_REAL_t)0.0);
    }
    __pyx_L13:;
</pre><pre class='cython line score-0'>&#xA0;2788: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2789:         <span class="n">row2</span> <span class="o">=</span> <span class="n">target_index</span> <span class="o">*</span> <span class="n">neu1_size</span></pre>
<pre class='cython code score-0'>    __pyx_v_row2 = (__pyx_v_target_index * __pyx_v_neu1_size);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2790:         <span class="n">f</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">sdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = ((__pyx_t_22inner_paragraph_vector_REAL_t)__pyx_v_22inner_paragraph_vector_sdot((&amp;__pyx_v_neu1_size), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2791:         <span class="k">if</span> <span class="n">f</span> <span class="o">&lt;=</span> <span class="o">-</span><span class="n">MAX_EXP</span> <span class="ow">or</span> <span class="n">f</span> <span class="o">&gt;=</span> <span class="n">MAX_EXP</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_f &lt;= -12.0) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L16_bool_binop_done;
    }
    __pyx_t_4 = ((__pyx_v_f &gt;= 12.0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L16_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2792:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L11_continue;
    }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2793:         <span class="n">f</span> <span class="o">=</span> <span class="n">EXP_TABLE</span><span class="p">[&lt;</span><span class="kt">int</span><span class="p">&gt;((</span><span class="n">f</span> <span class="o">+</span> <span class="n">MAX_EXP</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">/</span> <span class="n">MAX_EXP</span> <span class="o">/</span> <span class="mf">2</span><span class="p">))]</span></pre>
<pre class='cython code score-0'>    __pyx_v_f = (__pyx_v_22inner_paragraph_vector_EXP_TABLE[((int)((__pyx_v_f + 12.0) * 416.0))]);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2794:         <span class="n">g</span> <span class="o">=</span> <span class="p">(</span><span class="n">label</span> <span class="o">-</span> <span class="n">f</span><span class="p">)</span> <span class="o">*</span> <span class="n">alpha</span></pre>
<pre class='cython code score-0'>    __pyx_v_g = ((__pyx_v_label - __pyx_v_f) * __pyx_v_alpha);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2795:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2796:         <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">neu1_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">g</span><span class="p">,</span> <span class="n">neu1</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn1neg</span><span class="p">[</span><span class="n">row2</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_neu1_size), (&amp;__pyx_v_g), __pyx_v_neu1, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn1neg[__pyx_v_row2])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    __pyx_L11_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2797: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2798:     <span class="k">for</span> <span class="n">m</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_1 = __pyx_v_k;
  for (__pyx_t_2 = __pyx_v_j; __pyx_t_2 &lt; __pyx_t_1; __pyx_t_2+=1) {
    __pyx_v_m = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2799:         <span class="k">if</span> <span class="n">m</span> <span class="o">==</span> <span class="n">i</span> <span class="ow">or</span> <span class="n">codelens</span><span class="p">[</span><span class="n">m</span><span class="p">]</span> <span class="o">==</span> <span class="mf">0</span><span class="p">:</span></pre>
<pre class='cython code score-0'>    __pyx_t_4 = ((__pyx_v_m == __pyx_v_i) != 0);
    if (!__pyx_t_4) {
    } else {
      __pyx_t_3 = __pyx_t_4;
      goto __pyx_L21_bool_binop_done;
    }
    __pyx_t_4 = (((__pyx_v_codelens[__pyx_v_m]) == 0) != 0);
    __pyx_t_3 = __pyx_t_4;
    __pyx_L21_bool_binop_done:;
    if (__pyx_t_3) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2800:             <span class="k">continue</span></pre>
<pre class='cython code score-0'>      goto __pyx_L18_continue;
    }
    /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2801:         <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2802:             <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="n">work</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">syn0</span><span class="p">[</span><span class="n">indexes</span><span class="p">[</span><span class="n">m</span><span class="p">]</span><span class="o">*</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>      __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), __pyx_v_work, (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_syn0[((__pyx_v_indexes[__pyx_v_m]) * __pyx_v_size)])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
    }
    __pyx_L18_continue:;
  }
</pre><pre class='cython line score-0'>&#xA0;2803: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2804:     <span class="n">saxpy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">doc_size</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONEF</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">work</span><span class="p">[</span><span class="n">size</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">doc</span><span class="p">[</span><span class="n">sentence_id</span><span class="p">],</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_22inner_paragraph_vector_saxpy((&amp;__pyx_v_doc_size), (&amp;__pyx_v_22inner_paragraph_vector_ONEF), (&amp;(__pyx_v_work[__pyx_v_size])), (&amp;__pyx_v_22inner_paragraph_vector_ONE), (&amp;(__pyx_v_doc[__pyx_v_sentence_id])), (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0'>&#xA0;2805: </pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2806:     <span class="k">return</span> <span class="n">next_random</span></pre>
<pre class='cython code score-0'>  __pyx_r = __pyx_v_next_random;
  goto __pyx_L0;
</pre><pre class='cython line score-0'>&#xA0;2807: </pre>
<pre class='cython line score-11' onclick='toggleDiv(this)'>+2808: <span class="k">def</span> <span class="nf">init</span><span class="p">():</span></pre>
<pre class='cython code score-11'>/* Python wrapper */
static PyObject *__pyx_pw_22inner_paragraph_vector_17init(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused); /*proto*/
static char __pyx_doc_22inner_paragraph_vector_16init[] = "\n    Precompute function `sigmoid(x) = 1 / (1 + exp(-x))`, for x values discretized\n    into table EXP_TABLE.\n\n    ";
static PyMethodDef __pyx_mdef_22inner_paragraph_vector_17init = {"init", (PyCFunction)__pyx_pw_22inner_paragraph_vector_17init, METH_NOARGS, __pyx_doc_22inner_paragraph_vector_16init};
static PyObject *__pyx_pw_22inner_paragraph_vector_17init(PyObject *__pyx_self, CYTHON_UNUSED PyObject *unused) {
  PyObject *__pyx_r = 0;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init (wrapper)", 0);
  __pyx_r = __pyx_pf_22inner_paragraph_vector_16init(__pyx_self);

  /* function exit code */
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}

static PyObject *__pyx_pf_22inner_paragraph_vector_16init(CYTHON_UNUSED PyObject *__pyx_self) {
  int __pyx_v_i;
  float *__pyx_v_x;
  float *__pyx_v_y;
  float __pyx_v_expected;
  int __pyx_v_size;
  double __pyx_v_d_res;
  float *__pyx_v_p_res;
  PyObject *__pyx_r = NULL;
  <span class='refnanny'>__Pyx_RefNannyDeclarations</span>
  <span class='refnanny'>__Pyx_RefNannySetupContext</span>("init", 0);
/*  */
  /* function exit code */
  __pyx_L0:;
  <span class='refnanny'>__Pyx_XGIVEREF</span>(__pyx_r);
  <span class='refnanny'>__Pyx_RefNannyFinishContext</span>();
  return __pyx_r;
}
/*  */
  __pyx_tuple__39 = <span class='py_c_api'>PyTuple_Pack</span>(7, __pyx_n_s_i, __pyx_n_s_x, __pyx_n_s_y, __pyx_n_s_expected, __pyx_n_s_size, __pyx_n_s_d_res, __pyx_n_s_p_res);<span class='error_goto'> if (unlikely(!__pyx_tuple__39)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_tuple__39);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_tuple__39);
/*  */
  __pyx_t_1 = PyCFunction_NewEx(&amp;__pyx_mdef_22inner_paragraph_vector_17init, NULL, __pyx_n_s_inner_paragraph_vector);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_init, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2808; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-0'>&#xA0;2809:     <span class="sd">&quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2810: <span class="sd">    Precompute function `sigmoid(x) = 1 / (1 + exp(-x))`, for x values discretized</span></pre>
<pre class='cython line score-0'>&#xA0;2811: <span class="sd">    into table EXP_TABLE.</span></pre>
<pre class='cython line score-0'>&#xA0;2812: </pre>
<pre class='cython line score-0'>&#xA0;2813: <span class="sd">    &quot;&quot;&quot;</span></pre>
<pre class='cython line score-0'>&#xA0;2814: </pre>
<pre class='cython line score-0'>&#xA0;2815:     <span class="k">global</span> <span class="n">fast_sentence_sg_hs</span></pre>
<pre class='cython line score-0'>&#xA0;2816:     <span class="k">global</span> <span class="n">fast_sentence_sg_neg</span></pre>
<pre class='cython line score-0'>&#xA0;2817:     <span class="k">global</span> <span class="n">fast_sentence_cbow_hs</span></pre>
<pre class='cython line score-0'>&#xA0;2818:     <span class="k">global</span> <span class="n">fast_sentence_cbow_neg</span></pre>
<pre class='cython line score-0'>&#xA0;2819:     <span class="k">global</span> <span class="n">fast_sentence_sg_hs_simple</span></pre>
<pre class='cython line score-0'>&#xA0;2820:     <span class="k">global</span> <span class="n">fast_sentence_sg_neg_simple</span></pre>
<pre class='cython line score-0'>&#xA0;2821:     <span class="k">global</span> <span class="n">fast_sentence_cbow_hs_concat</span></pre>
<pre class='cython line score-0'>&#xA0;2822:     <span class="k">global</span> <span class="n">fast_sentence_cbow_neg_concat</span></pre>
<pre class='cython line score-0'>&#xA0;2823:     <span class="k">global</span> <span class="n">fast_sentence_cbow_average_simple_hs</span></pre>
<pre class='cython line score-0'>&#xA0;2824:     <span class="k">global</span> <span class="n">fast_sentence_cbow_average_simple_neg</span></pre>
<pre class='cython line score-0'>&#xA0;2825:     <span class="k">global</span> <span class="n">fast_sentence_cbow_average_plus_doc_hs</span></pre>
<pre class='cython line score-0'>&#xA0;2826:     <span class="k">global</span> <span class="n">fast_sentence_cbow_average_plus_doc_neg</span></pre>
<pre class='cython line score-0'>&#xA0;2827: </pre>
<pre class='cython line score-0'>&#xA0;2828:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">i</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2829:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">x</span> <span class="o">=</span> <span class="p">[&lt;</span><span class="kt">float</span><span class="p">&gt;</span><span class="mf">10.0</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_1[0] = ((float)10.0);
  __pyx_v_x = __pyx_t_1;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2830:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">y</span> <span class="o">=</span> <span class="p">[&lt;</span><span class="kt">float</span><span class="p">&gt;</span><span class="mf">0.01</span><span class="p">]</span></pre>
<pre class='cython code score-0'>  __pyx_t_2[0] = ((float)0.01);
  __pyx_v_y = __pyx_t_2;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2831:     <span class="k">cdef</span> <span class="kt">float</span> <span class="nf">expected</span> <span class="o">=</span> <span class="p">&lt;</span><span class="kt">float</span><span class="p">&gt;</span><span class="mf">0.1</span></pre>
<pre class='cython code score-0'>  __pyx_v_expected = ((float)0.1);
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2832:     <span class="k">cdef</span> <span class="kt">int</span> <span class="nf">size</span> <span class="o">=</span> <span class="mf">1</span></pre>
<pre class='cython code score-0'>  __pyx_v_size = 1;
</pre><pre class='cython line score-0'>&#xA0;2833:     <span class="k">cdef</span> <span class="kt">double</span> <span class="nf">d_res</span></pre>
<pre class='cython line score-0'>&#xA0;2834:     <span class="k">cdef</span> <span class="kt">float</span> *<span class="nf">p_res</span></pre>
<pre class='cython line score-0'>&#xA0;2835: </pre>
<pre class='cython line score-0'>&#xA0;2836:     <span class="c"># build the sigmoid table</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2837:     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">EXP_TABLE_SIZE</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  for (__pyx_t_3 = 0; __pyx_t_3 &lt; 10000; __pyx_t_3+=1) {
    __pyx_v_i = __pyx_t_3;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2838:         <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">exp</span><span class="p">((</span><span class="n">i</span> <span class="o">/</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="n">EXP_TABLE_SIZE</span> <span class="o">*</span> <span class="mf">2</span> <span class="o">-</span> <span class="mf">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">MAX_EXP</span><span class="p">)</span></pre>
<pre class='cython code score-0'>    (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_i]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)exp(((((__pyx_v_i / ((__pyx_t_22inner_paragraph_vector_REAL_t)10000)) * 2.0) - 1.0) * 12.0)));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2839:         <span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">&lt;</span><span class="n">REAL_t</span><span class="o">&gt;</span><span class="p">(</span><span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="p">(</span><span class="n">EXP_TABLE</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="mf">1</span><span class="p">))</span></pre>
<pre class='cython code score-0'>    (__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_i]) = ((__pyx_t_22inner_paragraph_vector_REAL_t)((__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_i]) / ((__pyx_v_22inner_paragraph_vector_EXP_TABLE[__pyx_v_i]) + 1.0)));
  }
</pre><pre class='cython line score-0'>&#xA0;2840: </pre>
<pre class='cython line score-0'>&#xA0;2841:     <span class="c"># check whether sdot returns double or float</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2842:     <span class="n">d_res</span> <span class="o">=</span> <span class="n">dsdot</span><span class="p">(</span><span class="o">&amp;</span><span class="n">size</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="o">&amp;</span><span class="n">ONE</span><span class="p">)</span></pre>
<pre class='cython code score-0'>  __pyx_v_d_res = __pyx_v_22inner_paragraph_vector_dsdot((&amp;__pyx_v_size), __pyx_v_x, (&amp;__pyx_v_22inner_paragraph_vector_ONE), __pyx_v_y, (&amp;__pyx_v_22inner_paragraph_vector_ONE));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2843:     <span class="n">p_res</span> <span class="o">=</span> <span class="o">&lt;</span><span class="nb">float</span> <span class="o">*&gt;&amp;</span><span class="n">d_res</span></pre>
<pre class='cython code score-0'>  __pyx_v_p_res = ((float *)(&amp;__pyx_v_d_res));
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2844:     <span class="k">if</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">d_res</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((fabs((__pyx_v_d_res - __pyx_v_expected)) &lt; 0.0001) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2845:         <span class="n">fast_sentence_sg_hs</span> <span class="o">=</span> <span class="n">fast_sentence0_sg_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs = __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2846:         <span class="n">fast_sentence_sg_neg</span> <span class="o">=</span> <span class="n">fast_sentence0_sg_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg = __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_neg;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2847:         <span class="n">fast_sentence_cbow_hs</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2848:         <span class="n">fast_sentence_cbow_neg</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_neg;
</pre><pre class='cython line score-0'>&#xA0;2849: </pre>
<pre class='cython line score-0'>&#xA0;2850: </pre>
<pre class='cython line score-0'>&#xA0;2851:         <span class="sd">&#39;&#39;&#39;sg simple&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2852:         <span class="n">fast_sentence_sg_hs_simple</span> <span class="o">=</span> <span class="n">fast_sentence0_sg_hs_simple</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs_simple = __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_hs_simple;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2853:         <span class="n">fast_sentence_sg_neg_simple</span> <span class="o">=</span> <span class="n">fast_sentence0_sg_neg_simple</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg_simple = __pyx_f_22inner_paragraph_vector_fast_sentence0_sg_neg_simple;
</pre><pre class='cython line score-0'>&#xA0;2854: </pre>
<pre class='cython line score-0'>&#xA0;2855:         <span class="sd">&#39;&#39;&#39; cbow average&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2856:         <span class="n">fast_sentence_cbow_average_simple_hs</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_average_simple_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_hs = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_simple_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2857:         <span class="n">fast_sentence_cbow_average_simple_neg</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_average_simple_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_neg = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_simple_neg;
</pre><pre class='cython line score-0'>&#xA0;2858: </pre>
<pre class='cython line score-0'>&#xA0;2859:         <span class="sd">&#39;&#39;&#39; cbow average plus doc&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2860:         <span class="n">fast_sentence_cbow_average_plus_doc_hs</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_average_plus_doc_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_hs = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_plus_doc_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2861:         <span class="n">fast_sentence_cbow_average_plus_doc_neg</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_average_plus_doc_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_neg = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_average_plus_doc_neg;
</pre><pre class='cython line score-0'>&#xA0;2862: </pre>
<pre class='cython line score-0'>&#xA0;2863:         <span class="sd">&#39;&#39;&#39; cbow concat&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2864:         <span class="n">fast_sentence_cbow_hs_concat</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_hs_concat</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs_concat = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_hs_concat;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2865:         <span class="n">fast_sentence_cbow_neg_concat</span> <span class="o">=</span> <span class="n">fast_sentence0_cbow_neg_concat</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg_concat = __pyx_f_22inner_paragraph_vector_fast_sentence0_cbow_neg_concat;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+2866:         <span class="k">return</span> <span class="mf">0</span>  <span class="c"># double</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_0);
    __pyx_r = __pyx_int_0;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2867:     <span class="k">elif</span> <span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">p_res</span><span class="p">[</span><span class="mf">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">expected</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">0.0001</span><span class="p">):</span></pre>
<pre class='cython code score-0'>  __pyx_t_4 = ((fabsf(((__pyx_v_p_res[0]) - __pyx_v_expected)) &lt; 0.0001) != 0);
  if (__pyx_t_4) {
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2868:         <span class="n">fast_sentence_sg_hs</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2869:         <span class="n">fast_sentence_sg_neg</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2870:         <span class="n">fast_sentence_cbow_hs</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2871:         <span class="n">fast_sentence_cbow_neg</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_neg;
</pre><pre class='cython line score-0'>&#xA0;2872: </pre>
<pre class='cython line score-0'>&#xA0;2873:         <span class="sd">&#39;&#39;&#39;sg simple&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2874:         <span class="n">fast_sentence_sg_hs_simple</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_hs_simple</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs_simple = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_hs_simple;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2875:         <span class="n">fast_sentence_sg_neg_simple</span> <span class="o">=</span> <span class="n">fast_sentence1_sg_neg_simple</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg_simple = __pyx_f_22inner_paragraph_vector_fast_sentence1_sg_neg_simple;
</pre><pre class='cython line score-0'>&#xA0;2876: </pre>
<pre class='cython line score-0'>&#xA0;2877:         <span class="sd">&#39;&#39;&#39; cbow average&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2878:         <span class="n">fast_sentence_cbow_average_simple_hs</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_average_simple_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_hs = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_simple_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2879:         <span class="n">fast_sentence_cbow_average_simple_neg</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_average_simple_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_simple_neg = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_simple_neg;
</pre><pre class='cython line score-0'>&#xA0;2880: </pre>
<pre class='cython line score-0'>&#xA0;2881:         <span class="sd">&#39;&#39;&#39; cbow average plus doc&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2882:         <span class="n">fast_sentence_cbow_average_plus_doc_hs</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_average_plus_doc_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_hs = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_plus_doc_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2883:         <span class="n">fast_sentence_cbow_average_plus_doc_neg</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_average_plus_doc_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_average_plus_doc_neg = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_average_plus_doc_neg;
</pre><pre class='cython line score-0'>&#xA0;2884: </pre>
<pre class='cython line score-0'>&#xA0;2885:         <span class="sd">&#39;&#39;&#39; cbow concat&#39;&#39;&#39;</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2886:         <span class="n">fast_sentence_cbow_hs_concat</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_hs_concat</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs_concat = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_hs_concat;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2887:         <span class="n">fast_sentence_cbow_neg_concat</span> <span class="o">=</span> <span class="n">fast_sentence1_cbow_neg_concat</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg_concat = __pyx_f_22inner_paragraph_vector_fast_sentence1_cbow_neg_concat;
</pre><pre class='cython line score-0'>&#xA0;2888: </pre>
<pre class='cython line score-2' onclick='toggleDiv(this)'>+2889:         <span class="k">return</span> <span class="mf">1</span>  <span class="c"># float</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_1);
    __pyx_r = __pyx_int_1;
    goto __pyx_L0;
  }
  /*else*/ {
</pre><pre class='cython line score-0'>&#xA0;2890:     <span class="k">else</span><span class="p">:</span></pre>
<pre class='cython line score-0'>&#xA0;2891:         <span class="c"># neither =&gt; use cython loops, no BLAS</span></pre>
<pre class='cython line score-0'>&#xA0;2892:         <span class="c"># actually, the BLAS is so messed up we&#39;ll probably have segfaulted above and never even reach here</span></pre>
<pre class='cython line score-0' onclick='toggleDiv(this)'>+2893:         <span class="n">fast_sentence_sg_hs</span> <span class="o">=</span> <span class="n">fast_sentence2_sg_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_hs = __pyx_f_22inner_paragraph_vector_fast_sentence2_sg_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2894:         <span class="n">fast_sentence_sg_neg</span> <span class="o">=</span> <span class="n">fast_sentence2_sg_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_sg_neg = __pyx_f_22inner_paragraph_vector_fast_sentence2_sg_neg;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2895:         <span class="n">fast_sentence_cbow_hs</span> <span class="o">=</span> <span class="n">fast_sentence2_cbow_hs</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_hs = __pyx_f_22inner_paragraph_vector_fast_sentence2_cbow_hs;
</pre><pre class='cython line score-0' onclick='toggleDiv(this)'>+2896:         <span class="n">fast_sentence_cbow_neg</span> <span class="o">=</span> <span class="n">fast_sentence2_cbow_neg</span></pre>
<pre class='cython code score-0'>    __pyx_v_22inner_paragraph_vector_fast_sentence_cbow_neg = __pyx_f_22inner_paragraph_vector_fast_sentence2_cbow_neg;
</pre><pre class='cython line score-2' onclick='toggleDiv(this)'>+2897:         <span class="k">return</span> <span class="mf">2</span></pre>
<pre class='cython code score-2'>    <span class='pyx_macro_api'>__Pyx_XDECREF</span>(__pyx_r);
    <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_int_2);
    __pyx_r = __pyx_int_2;
    goto __pyx_L0;
  }
</pre><pre class='cython line score-0'>&#xA0;2898: </pre>
<pre class='cython line score-24' onclick='toggleDiv(this)'>+2899: <span class="n">FAST_VERSION</span> <span class="o">=</span> <span class="n">init</span><span class="p">()</span>  <span class="c"># initialize the module</span></pre>
<pre class='cython code score-24'>  __pyx_t_2 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_init);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  __pyx_t_3 = NULL;
  if (CYTHON_COMPILING_IN_CPYTHON &amp;&amp; unlikely(<span class='py_c_api'>PyMethod_Check</span>(__pyx_t_2))) {
    __pyx_t_3 = <span class='py_macro_api'>PyMethod_GET_SELF</span>(__pyx_t_2);
    if (likely(__pyx_t_3)) {
      PyObject* function = <span class='py_macro_api'>PyMethod_GET_FUNCTION</span>(__pyx_t_2);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_t_3);
      <span class='pyx_macro_api'>__Pyx_INCREF</span>(function);
      <span class='pyx_macro_api'>__Pyx_DECREF_SET</span>(__pyx_t_2, function);
    }
  }
  if (__pyx_t_3) {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallOneArg</span>(__pyx_t_2, __pyx_t_3);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
    <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_3); __pyx_t_3 = 0;
  } else {
    __pyx_t_1 = <span class='pyx_c_api'>__Pyx_PyObject_CallNoArg</span>(__pyx_t_2);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  }
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_FAST_VERSION, __pyx_t_1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2899; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_1); __pyx_t_1 = 0;
</pre><pre class='cython line score-13' onclick='toggleDiv(this)'>+2900: <span class="k">print</span> <span class="s">&quot;FAST_VERSION : &quot;</span><span class="p">,</span><span class="n">FAST_VERSION</span></pre>
<pre class='cython code score-13'>  __pyx_t_1 = <span class='pyx_c_api'>__Pyx_GetModuleGlobalName</span>(__pyx_n_s_FAST_VERSION);<span class='error_goto'> if (unlikely(!__pyx_t_1)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_1);
  __pyx_t_2 = <span class='py_c_api'>PyTuple_New</span>(2);<span class='error_goto'> if (unlikely(!__pyx_t_2)) {__pyx_filename = __pyx_f[0]; __pyx_lineno = 2900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='refnanny'>__Pyx_GOTREF</span>(__pyx_t_2);
  <span class='pyx_macro_api'>__Pyx_INCREF</span>(__pyx_kp_s_FAST_VERSION_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 0, __pyx_kp_s_FAST_VERSION_2);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_kp_s_FAST_VERSION_2);
  <span class='py_macro_api'>PyTuple_SET_ITEM</span>(__pyx_t_2, 1, __pyx_t_1);
  <span class='refnanny'>__Pyx_GIVEREF</span>(__pyx_t_1);
  __pyx_t_1 = 0;
  if (<span class='pyx_c_api'>__Pyx_Print</span>(0, __pyx_t_2, 1) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2900; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
  <span class='pyx_macro_api'>__Pyx_DECREF</span>(__pyx_t_2); __pyx_t_2 = 0;
</pre><pre class='cython line score-5' onclick='toggleDiv(this)'>+2901: <span class="n">test_flag</span> <span class="o">=</span> <span class="s">&quot;test is is&quot;</span></pre>
<pre class='cython code score-5'>  if (<span class='py_c_api'>PyDict_SetItem</span>(__pyx_d, __pyx_n_s_test_flag, __pyx_kp_s_test_is_is) &lt; 0) <span class='error_goto'>{__pyx_filename = __pyx_f[0]; __pyx_lineno = 2901; __pyx_clineno = __LINE__; goto __pyx_L1_error;}</span>
</pre></div></body></html>
